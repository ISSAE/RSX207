<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>tmpfs - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="index.html"/>
<link rel="contents" href="tmpfs?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="feed.php?mode=list&amp;ns="/>
<link rel="alternate" type="text/html" title="HTML brut" href="_export/xhtml/tmpfs"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="_export/raw/tmpfs"/>
<link rel="stylesheet" type="text/css" href="lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"id":"tmpfs","namespace":""};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="tmpfs?do=edit&amp;rev=0#main" tabindex="1">Contenu</a> | <a href="tmpfs?do=edit&amp;rev=0#qsearch__in" tabindex="2">Rechercher</a> | <a href="tmpfs?do=edit&amp;rev=0#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="tmpfs?do=edit&amp;rev=0" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="tmpfs" >tmpfs</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                
<p>
<strong>Quelques recommandations avant de créer ou de modifier cette page :</strong>
</p>
<ol>
<li class="level1"><div class="li"> Lisez le <a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">guide du contributeur</a> et la <a href="wiki/ligne_editoriale" class="wikilink1" title="wiki:ligne_editoriale">ligne éditoriale</a>.</div>
</li>
<li class="level1"><div class="li"> Découvrez la <a href="http://doc.ubuntu-fr.org/wiki/syntaxe" class="wikilink1" title="wiki:syntaxe">syntaxe</a> et entraînez-vous dans le <a href="playground/playground" class="wikilink1" title="playground:playground">bac à sable</a>.</div>
</li>
<li class="level1"><div class="li"> Utilisez les modèles (<a href="wiki/modeles/application" class="wikilink1" title="wiki:modeles:application">application</a>, <a href="wiki/modeles/materiel" class="wikilink1" title="wiki:modeles:materiel">matériel</a>, <a href="wiki/modeles/portable" class="wikilink1" title="wiki:modeles:portable">ordinateur portable</a>, <a href="wiki/modeles/tutoriel" class="wikilink1" title="wiki:modeles:tutoriel">tutoriel</a>, <a href="wiki/modeles/utilisateur" class="wikilink1" title="wiki:modeles:utilisateur">utilisateur</a>, <a href="wiki/modeles/portail" class="wikilink1" title="wiki:modeles:portail">portail</a>) et les <a href="wiki/mini-tutoriels" class="wikilink1" title="wiki:mini-tutoriels">mini-tutoriels</a>.</div>
</li>
<li class="level1"><div class="li"> Rapportez toutes créations ou modifications importantes sur <a href="wiki/liste_discussion#coordination_de_la_documentation" class="wikilink1" title="wiki:liste_discussion">la liste de discussion</a>.</div>
</li>
</ol>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/f/fcdb5fe1d67011f56447459483d05597.xhtml used -->
<script type="text/javascript">/*<![CDATA[*/
textChanged = false/*!]]>*/</script>
    <div class="editBox" role="application">

    <div class="toolbar group">
        <div id="draft__status"></div>
        <div id="tool__bar"><a href="http://doc.ubuntu-fr.org/lib/exe/mediamanager.php?ns="
            target="_blank">Sélection de fichiers</a></div>
    </div>
    <form id="dw__editform" method="post" action="tmpfs?do=edit&amp;rev=0" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="3bbdeeb4168d06af7a8bbdbdb8925be6" /><input type="hidden" name="id" value="tmpfs" /><input type="hidden" name="rev" value="0" /><input type="hidden" name="date" value="1401429280" /><input type="hidden" name="prefix" value="." /><input type="hidden" name="suffix" value="" /><input type="hidden" name="changecheck" value="664fea53ab69086a68fb2775bd8ebb94" /><input type="hidden" name="target" value="section" /><textarea name="wikitext" id="wiki__text" dir="auto" class="edit" cols="80" rows="10" tabindex="1">
{{tag&gt;système optimisation}}

====== tmpfs ======

&lt;note warning&gt;L'utilisation de la commande tmpfs peut aboutir à des pertes de données en cas de mauvaise manipulation, prenez le temps de bien comprendre ce système et ses implications !&lt;/note&gt;

===== Présentation de tmpfs =====

Tmpfs est implémenté directement dans le noyau Linux depuis la version 2.6
(c'est à dire qu'il est disponible dans toutes les versions d'ubuntu supportés officiellement).

Il remplace les commandes de création de ramdisk, et offre l'avantage de redonner la mémoire vive aux systèmes d'exploitations en cas de non utilisation de celle-ci.

Un RAMDisk ou un volume Tmpfs dans ce cas présent est un espace dans la mémoire vive qui est utilisé pour stocker des fichiers temporairement (en effet le volume est vidé à chaque arrêt du système).

Un tmpfs est donc idéal pour stocker les fichiers temporaires de votre ordinateur. Ces fichiers temporaires sont des fichiers qui sont, par exemple, créé puis effacés lors de l'extraction d'un fichier compressé, lors d'une mise à jour, etc ...

===== Avantages et Inconvénients =====

Tmpfs permet de créer un espace de stockage dans la mémoire vive, Il y a plusieurs conséquences:
  * __**Tous les fichiers seront effacés dès le prochain redémarrage ou après une coupure de courant !**__ (En utilisation pour des fichiers temporaires l'inconvénient devient ici un avantage, car les fichiers seront purgés même si le programme oubli de le faire !)
  * Vitesse d'accès aux fichiers accrue.
  * Économie de consommation électrique.
  * Baisse de l'usure des disques (surtout pour les SSD).
  * Baisse des coûts d'accès aux disques lors ceux-ci sont payants (par exemple pour les disques réseaux EBS d'Amazon)
  * tmpfs, si la RAM est pleine, vient automatiquement s'écrire sur le disque dur dans la partition &quot;swap&quot; ce qui permet de ne pas impacter les performances si le PC a besoin de toute votre RAM
  * un tmpfs de 1 GO ne prendra 1 GO de place dans la RAM que s'il est plein, en effet il ne prendra que la place des fichiers qu'il contient.

===== Mise en place =====

==== Mettre /tmp en tmpfs ====

C'est le but même de tmpfs à l'origine !

pour ce faire il suffit [[:tutoriel:comment_modifier_un_fichier|d'ajouter au fichier texte]] **/etc/fstab** la ligne:

  tmpfs /tmp tmpfs defaults,size=32M 0 0
  
Cette modification est effective au prochain démarrage.

&lt;note important&gt;N'hésitez pas à changer l'espace en Mo associé au tmpfs (ici 32 Mo) par l'espace voulu si besoin. En effet certains programmes demanderont peut être plus d'espace (rare).&lt;/note&gt;

==== Créer un tmpfs personnalisé ====

=== Créer votre répertoire ===

  sudo mkdir /media/virtuelram

Tout ce qui sera dans ce répertoire sera stocké en mémoire vive.

=== Définir les droits ===

Et oui, pour pouvoir écrire dedans depuis n'importe quel utilisateur :
  sudo chmod 777 /media/virtuelram

=== Monter l'accès ===

Si vous voulez le monter ponctuellement : 
  sudo mount -t tmpfs -o size=512M tmpfs /media/virtuelram
l'option size permet de définir la quantité de mémoire allouée.

Si elle n'est pas définie, le système attribuera la moitié de la quantité de la mémoire physique.
&lt;note tip&gt;Vous pouvez mettre ce code pour faire un raccourci (créer un lancer, rubrique commande).&lt;/note&gt;


Pour le monter à chaque démarrage, il faut [[:tutoriel:comment_modifier_un_fichier|éditer le fichier]] **fstab**. Pour cela, il suffit d'entrer cette commande dans un terminal

Et ajouter une de ces lignes de commande dans le ficher et enregistrer les modifications

  tmpfs /media/virtuelram tmpfs defaults,size=512M 0 0
pour 512 Mo

  tmpfs /media/virtuelram tmpfs defaults,size=1g 0 0
pour 1 Go

Etc...

===== Quelques exemples d'utilisation =====

==== Le dossier /tmp ====
contient des fichiers temporaires qui de toutes façons s'effacent au redémarrage, donc c'est sans risque de perte de données.

==== /var/tmp ou /var/lock ====
Classiquement ces dossiers contiennent des fichiers temporaires mais qui ne s'effacent pas automatiquement.
Globalement cela ralenti un peu le lancement des programmes (qui doivent réécrire ces fichiers à chaque fois).

http://refspecs.linuxfoundation.org/FHS_2.3/fhs-2.3.html#VARTMPTEMPORARYFILESPRESERVEDBETWEE

==== Accélérer Firefox ====
Sous ce titre un peu racoleur, il s'agit de placer le cache en tmpfs.

Pour cela dans la barre d'adresse de firefox taper ''about:config''

Rechercher la l'entrée ''browser.cache.disk.enable'' et passez la valeur à ''false'' (double click sur la ligne)

Vérifiez que ''browser.cache.memory.enable'' soit &quot;true&quot; (valeur par défaut)

Optionnel : Vous pouvez configurer la taille du cache en ajoutant une entrée (click droit -&gt; nouveau -&gt; entier) ''browser.cache.memory.capacity'' puis renseignez la capacité du cache (valeur en Kilo-octet)  ou -1 pour une gestion automatique du cache. (Passer cette étape aura le même effet que de mettre la valeur à -1.)


&lt;note help&gt;
**Note :** ''browser.cache.disk.parent_directory'' est obsolète

Source : https://wiki.archlinux.org/index.php/Firefox_Ramdisk
&lt;/note&gt;

==== Copier des fichiers ====

L'autonomie des portables en mode lecture vidéo par exemple, est plus grande avec un fichier en mémoire vive.
La conversion des fichiers en divx, le rippage des CD, DVD etc ... sont nettement plus rapides en mémoire vive.
Etc...

===== L'utilité des fichiers rc.local et rc.local.shutdown =====

Et oui ! Ce sont des fichiers qui permettent d'exécuter des commandes au démarrage et à l'extinction
utile pour améliorer l'utilisation de tmpfs (Vous pouvez par exemple copier des fichiers au démarrage dans votre tmpfs, ou les copier en dehors avant l'extinction automatiquement via ces deux scripts).

</textarea>
<div id="wiki__editbar" class="editBar">
<div id="size__ctl">
</div>
<div class="editButtons">
<div id="plugin__captcha_wrapper"><input type="hidden" name="eb6894ad9f5a7d68d68eb330da9aa7f2" value="/sS+4trwbFbIPxs4BQPmRMqoOMBf8QpuMDKpkNeXrSE=" /><label for="plugin__captcha">Merci de recopier le code ci-contre pour prouver que vous êtes humain :</label> <span id="plugin__captcha_code">N﻿
P᠎
P D L</span> <input type="text" size="5" name="d352b258d0b116285629952b36f62d32" class="edit" /> <label class="no">Merci de laisser ce champ vide : <input type="text" name="0ae2df50ec40bf853e439067e1e4cf8a" /></label></div><input name="do[save]" type="submit" value="Enregistrer" class="button" id="edbtn__save" accesskey="s" tabindex="4" title="Enregistrer [S]" />
<input name="do[preview]" type="submit" value="Aperçu" class="button" id="edbtn__preview" accesskey="p" tabindex="5" title="Aperçu [P]" />
<input name="do[draftdel]" type="submit" value="Annuler" class="button" tabindex="6" />
</div>
<div class="summary">
<label class="nowrap" for="edit__summary"><span>Résumé</span> <input type="text" id="edit__summary" name="summary" class="edit" size="50" tabindex="2" /></label>
</div>
</div>
<div class="license">
Note : En modifiant cette page, vous acceptez que le contenu soit placé sous les termes de la licence suivante : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" class="urlextern">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a></div>
</div></form>
</div>
<script type="text/javascript">
   var saveBtn = document.getElementById('edbtn__save');
   saveBtn.disabled = true;
   saveBtn.style.color = 'gray';
   saveBtn.style.backgroundColor = '#EEEEEE';
   saveBtn.value = 'Enregistrer (Click \'Aperçu\' first)';
</script>
        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="tmpfs?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/tmpfs?do="  class="action show" accesskey="v" rel="nofollow" title="Afficher la page [V]">Afficher la page</a></li>
                  <li><a href="tmpfs?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="tmpfs?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="tmpfs?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
