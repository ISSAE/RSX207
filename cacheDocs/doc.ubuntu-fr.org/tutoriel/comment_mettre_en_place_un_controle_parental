<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>tutoriel:comment_mettre_en_place_un_controle_parental - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2015-05-15T15:05:32+0200"/>
<meta name="keywords" content="education,securite,internet,tutoriel,controle parental"/>
<link rel="search" type="application/opensearchdescription+xml" href="../lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="../index.html"/>
<link rel="contents" href="comment_mettre_en_place_un_controle_parental?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="../feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="comment_mettre_en_place_un_controle_parental?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="../_export/xhtml/tutoriel/comment_mettre_en_place_un_controle_parental"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="../_export/raw/tutoriel/comment_mettre_en_place_un_controle_parental"/>
<link rel="canonical" href="comment_mettre_en_place_un_controle_parental"/>
<link rel="stylesheet" type="text/css" href="../lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"id":"tutoriel:comment_mettre_en_place_un_controle_parental","namespace":"tutoriel"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="comment_mettre_en_place_un_controle_parental#main" tabindex="1">Contenu</a> | <a href="comment_mettre_en_place_un_controle_parental#qsearch__in" tabindex="2">Rechercher</a> | <a href="comment_mettre_en_place_un_controle_parental#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="../index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="comment_mettre_en_place_un_controle_parental" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="comment_mettre_en_place_un_controle_parental" >tutoriel:comment_mettre_en_place_un_controle_parental</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table des matières</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#session_et_internet">Session et internet</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#la_session_invite">La Session Invité</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#dnsmasq_et_blacklist_de_l_universite_de_toulouse">dnsmasq et blacklist de l&#039;université de Toulouse</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#gnome_nanny">Gnome Nanny</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#session_seulement">Session seulement</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#timekpr">Timekpr</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#configuration_manuelle">Configuration manuelle</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#internet_seulement">Internet seulement</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#solution_radicale">Solution radicale</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#opendns_familyshield">OpenDNS FamilyShield</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#procon_latte">Procon latte</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#squidguard">Squidguard</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#dansguardian">DansGuardian</a></div></li>
<li class="level2"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#opendns">OpenDNS</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comment_mettre_en_place_un_controle_parental#voir_aussi">Voir aussi</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->
<div class="tags"><span>
	<a href="../education" class="wikilink1" title="education" rel="tag">éducation</a>,
	<a href="http://doc.ubuntu-fr.org/securite" class="wikilink1" title="securite" rel="tag">sécurité</a>,
	<a href="../internet" class="wikilink1" title="internet" rel="tag">internet</a>,
	<a href="http://doc.ubuntu-fr.org/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>,
	<a href="../controle_parental?do=showtag&amp;tag=contr%25C3%25B4le_parental" class="wikilink1" title="controle_parental" rel="tag">contrôle parental</a>
</span></div>
<hr />

<h1 class="sectionedit1" id="controle_parental">Contrôle parental</h1>
<div class="level1">

<p>
Cette page recense les solutions de contrôle parental sur Ubuntu.
</p>

<p>
<p><div class="noteimportant">Attention : si le besoin (mettre en place un contrôle parental) est simple, les méthodes proposées ici sont particulièrement techniques et s&#039;adressent à un public expert.
</div></p>
</p>

<p>
Le contrôle parental comporte au moins deux aspects :
</p>
<ol>
<li class="level1"><div class="li"> accès aux sessions et temps d&#039;utilisation ;</div>
</li>
<li class="level1"><div class="li"> accès à l&#039;internet.</div>
</li>
</ol>

<p>
Les solutions évoquées ci-après peuvent concerner ces deux aspects ou seulement l&#039;un des deux. 
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Contrôle parental] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="76-609" /><input type="submit" value="Modifier" class="button" title="Contrôle parental" /></div></form></div>
<h2 class="sectionedit2" id="session_et_internet">Session et internet</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Session et internet] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="610-640" /><input type="submit" value="Modifier" class="button" title="Session et internet" /></div></form></div>
<h3 class="sectionedit3" id="la_session_invite">La Session Invité</h3>
<div class="level3">

<p>
La session invité a des droits limité mais permet de passer au dessus de contrôles parentaux appliqués sur votre navigateur comme par exemple ProCon Latte qui sera étudié ci-dessous.
En effet à chaque redémarrage du système la session invité efface tout ce qui a pu être installé lors de la session précédente, y compris les contrôles parentaux pourtant paramétrés avec votre compte administrateur.
</p>

<p>
Pour désactiver la session Invité sous Ubuntu 14.04, il faut ouvrir un terminal et taper :
</p>
<pre class="code bash"><span class="kw2">sudo</span> gedit <span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>lightdm<span class="sy0">/</span>lightdm.conf.d<span class="sy0">/</span><span class="nu0">50</span>-ubuntu.conf</pre>

<p>
Cette ligne de commande va vous ouvrir le fichier de configuration 50-ubuntu.conf.
Dans ce fichier, placez-vous à la fin, et ajoutez cette ligne puis enregistrez
</p>
<pre class="file">allow-guest=false</pre>

<p>
Le fichier 50-ubuntu.conf devrait ressembler à ceci :
</p>
<pre class="file">[SeatDefaults]
user-session=ubuntu
allow-guest=false</pre>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[La Session Invité] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="641-1583" /><input type="submit" value="Modifier" class="button" title="La Session Invité" /></div></form></div>
<h3 class="sectionedit4" id="dnsmasq_et_blacklist_de_l_universite_de_toulouse">dnsmasq et blacklist de l&#039;université de Toulouse</h3>
<div class="level3">

<p>
CTparental.sh est un script permettant à des utilisateurs ayant juste assimilé les bases des lignes de commandes de mettre en place un filtrage <abbr title="Domain Name System">DNS</abbr> (contrôle parental) .
</p>

<p>
Bien sûr il faut créer des comptes sans droit d&#039;administration pour vos enfants.
</p>

<p>
Si vos enfants ont passé les 10 ans il est conseillé de mettre un mot de passe bios et de désactiver le boot sur support <abbr title="Universal Serial Bus">USB</abbr> ou  CDROM et un mots de passe sur grub aussi.
</p>

<p>
Mais ne comptez pas les arrêter au-delà de 16 ans, ils sauront comment passer outre tout ça, bien que ça les ennuiera un petit moment donc autant les faire réfléchir un peu .
</p>

<p>
Dans tous les cas ce n&#039;est qu&#039;une sécurité pour éviter qu&#039;ils ne grandissent trop vite, mais elle ne remplace pas l’accompagnement des parents, et le petit coup d’œil de temps en temps.
</p>

<p>
Il est maintenant disponible sous forme de fichier deb,  pour <a href="https://www.debian-fr.org/ressources/v-3-94-1/3581" class="urlextern" title="https://www.debian-fr.org/ressources/v-3-94-1/3581"  rel="nofollow">ubuntu 14.04 et plus</a>  qu&#039;il faut préalablement <strong>extraire</strong> puis <strong>installer</strong> avec la <a href="../software-center" class="wikilink1" title="software-center">logithèque</a> ou <a href="../gdebi" class="wikilink1" title="gdebi">gdebi</a> .
</p>

<p>
les identifiants et mots de passe seront définis pendant cette procédure, il faut donc <strong>penser à ouvrir la fenêtre du terminal durant l’installation avec gdebi</strong>.
<a href="../_detail/ctparental..000.png?id=tutoriel%253Acomment_mettre_en_place_un_controle_parental" class="media" title="ctparental..000.png"><img src="../_media/ctparental..000.png?w=720&amp;tok=1cbcf8" class="media" alt="" width="720" /></a>
</p>

<p>
<p><div class="noteclassic">Par la suite on pourra les redéfinir en lançant la commande<strong> sudo CTparental.sh -uhtml</strong> dans un terminal.
</div></p>
</p>

<p>
Il possède  une interface web <a href="http://127.0.0.1/CTadmin/" class="urlextern" title="http://127.0.0.1/CTadmin/"  rel="nofollow">http://127.0.0.1/CTadmin/</a> , qui facilite sont paramétrage.
</p>

<p>
<a href="../_detail/ctparental..001.png?id=tutoriel%253Acomment_mettre_en_place_un_controle_parental" class="media" title="ctparental..001.png"><img src="../_media/ctparental..001.png?w=714&amp;tok=1758fd" class="media" alt="" width="714" /></a>
<a href="../_detail/tutoriel/ctparental..002.png?id=tutoriel%253Acomment_mettre_en_place_un_controle_parental" class="media" title="tutoriel:ctparental..002.png"><img src="../_media/tutoriel/ctparental..002.png?w=714&amp;tok=936300" class="media" alt="" width="714" /></a>
<a href="../_detail/ctparental..003.png?id=tutoriel%253Acomment_mettre_en_place_un_controle_parental" class="media" title="ctparental..003.png"><img src="../_media/ctparental..003.png?w=720&amp;tok=37c5b2" class="media" alt="" width="720" /></a>
</p>

<p>
Principales fonctions:
</p>
<ol>
<li class="level1"><div class="li"> Filtrage par Blackliste ou par Whiteliste .</div>
</li>
<li class="level1"><div class="li"> Filtre par Catégorie .</div>
</li>
<li class="level1"><div class="li"> Filtre personnalisé  de site .</div>
</li>
<li class="level1"><div class="li"> Filtre Personnalisé de sites à laisser accessibles même s&#039;il sont présents dans une  des catégories que l&#039;on veut bloquer. </div>
</li>
<li class="level1"><div class="li"> Réglages des heures de connexions autorisées par utilisateur.</div>
</li>
<li class="level1"><div class="li"> Nombres de minutes de connexions max par jours autorisées.</div>
</li>
<li class="level1"><div class="li"> Groupe de personnes privilégiées ne subissant pas de filtrage web.</div>
</li>
<li class="level1"><div class="li"> Notifications des Utilisateurs toutes les minutes durant les 5 dernières minutes avant déconnexion.</div>
</li>
<li class="level1"><div class="li"> Dansguardian + Privoxy (paramètre non disponible via l&#039;interface.)</div>
</li>
<li class="level1"><div class="li"> Force SafeSearch google</div>
</li>
<li class="level1"><div class="li"> Force SafeSearch duckduckgo</div>
</li>
<li class="level1"><div class="li"> Force SafeSearch bing (en http seulement)</div>
</li>
<li class="level1"><div class="li"> Blocage de moteurs de recherches jugés non sûr comme bing en https et search.yahoo.com.</div>
</li>
<li class="level1"><div class="li"> Gestion de règle personnalisées pour iptables .activer avec CTparental.sh -ipton</div>
</li>
<li class="level1"><div class="li"> Fonctionne avec firefox,midori,chromium … </div>
</li>
</ol>

<p>
les services suivant sont automatiquement accepter pour avoir une navigation corecte sur internet,http,https,dns,ntp,dhcp,
ping (sortant uniquement),ftp (client ftp seulement pas serveur)
pour le reste on peut ajouter ces propre règle dans le fichier /usr/local/etc/CTparental/iptables qui en possèdes  certaine mais qui sont commentées.
et relancer la commandes CTparental.sh -ipton pour les activés.
</p>

<p>
Pour l&#039;installer manuellement et les dernières infos c&#039;est par <a href="http://www.debian-fr.org/controle-parental-pour-le-pc-debian-de-vos-enfants-t42009.html" class="urlextern" title="http://www.debian-fr.org/controle-parental-pour-le-pc-debian-de-vos-enfants-t42009.html"  rel="nofollow">ici</a>
</p>

<p>
<strong>explication des différents paramètres pour une utilisation en ligne de commandes :</strong>
une fois installé, lancer cette commande :
</p>
<pre class="code"> sudo CTparental.sh</pre>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[dnsmasq et blacklist de l'université de Toulouse] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="1584-5036" /><input type="submit" value="Modifier" class="button" title="dnsmasq et blacklist de l'université de Toulouse" /></div></form></div>
<h3 class="sectionedit5" id="gnome_nanny">Gnome Nanny</h3>
<div class="level3">

<p>
<a href="../gnome_nanny" class="wikilink1" title="gnome_nanny">Gnome Nanny</a> est un logiciel de contrôle parental complet, installé par défaut dans Edubuntu depuis <a href="../maverick" class="wikilink1" title="maverick">Edubuntu 10.10</a>.
</p>

<p>
<p><div class="noteimportant">Nota: il semble que Nanny ne soit pas encore au point et pose certains problèmes, au moins lorsque l&#039;on est sous Lucid Lynx et Natty. Voir <a href="http://forum.ubuntu-fr.org/viewtopic.php?id=416280" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?id=416280"  rel="nofollow">cette discussion sur le forum</a>
</div></p>
</p>

<p>
Nanny n&#039;est plus disponible dans les dépôts (Ubuntu 13.04)
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Gnome Nanny] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="5037-5508" /><input type="submit" value="Modifier" class="button" title="Gnome Nanny" /></div></form></div>
<h2 class="sectionedit6" id="session_seulement">Session seulement</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Session seulement] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="5509-5540" /><input type="submit" value="Modifier" class="button" title="Session seulement" /></div></form></div>
<h3 class="sectionedit7" id="timekpr">Timekpr</h3>
<div class="level3">

<p>
<a href="../timekpr" class="wikilink1" title="timekpr">Timekpr</a> (une contraction de « time keeper » en anglais) est un logiciel pour contrôler l&#039;usage de l&#039;ordinateur par les différents comptes d&#039;utilisateurs d&#039;un ordinateur. Vous pouvez limiter l&#039;usage quotidien à partir de la durée d&#039;usage et les périodes de la journée où ils peuvent ou non se connecter.
</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Timekpr] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="5541-5874" /><input type="submit" value="Modifier" class="button" title="Timekpr" /></div></form></div>
<h3 class="sectionedit8" id="configuration_manuelle">Configuration manuelle</h3>
<div class="level3">

<p>
Des <a href="restrictions_horaires" class="wikilink1" title="tutoriel:restrictions_horaires">restrictions horaires</a> peuvent être mises en place par configuration manuelle.
</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Configuration manuelle] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="5875-6026" /><input type="submit" value="Modifier" class="button" title="Configuration manuelle" /></div></form></div>
<h2 class="sectionedit9" id="internet_seulement">Internet seulement</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Internet seulement] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="6027-6058" /><input type="submit" value="Modifier" class="button" title="Internet seulement" /></div></form></div>
<h3 class="sectionedit10" id="solution_radicale">Solution radicale</h3>
<div class="level3">

<p>
Soit une machine sur laquelle sont existants un compte disposant des droits d&#039;administration, d&#039;autres comptes sans droits d&#039;administration et parmi ceux-ci au moins un pour lequel l&#039;accès à internet n&#039;a pas lieu d&#039;être contrôlé. Pour fixer les idées, mettons Adulte00, Adulte01, Progeniture00 et Progeniture01. Mettons que Adulte00 et 01 décident d&#039;un commun accord que le contrôle le plus simple et le plus efficace tout en étant le moins demandeur en ressource humaine consiste en la solution radicale d&#039;absence d&#039;accès au net tout court pour Progéniture00 et 01. Dans ce cas, l&#039;administrateur peut aller dans les propriétés de la connexion, qu&#039;elle soit filaire ou wifi, et décocher la case en bas à gauche &quot;Disponible pour tous les utilisateurs&quot;. Problème : le compte non-admin pour lequel l&#039;accès à internet n&#039;a pas lieu d&#039;être contrôlé (<em>i.e.</em> Adulte00 ou (<em>i.e.</em> xor) 01) se retrouve lui aussi sans connexion. Il faut alors se connecter avec ce compte et activer la connexion, ce qui devrait demander le mot de passe admin. A partir de ce moment, ce compte devrait avoir accès au réseau à chaque login. Mais là encore, tous les autres comptes auront accès à la connexion … Comme précédemment, il suffit de modifier les propriétés de la connexion en décochant la case en bas à gauche &quot;Disponible pour tous les utilisateurs&quot;. 
</p>

<p>
<strong>En résumé</strong> : activation de la connexion pour chacun des adultes et modification en décochant la case &quot;Disponible pour tous les utilisateurs&quot;. Rien du tout pour la progéniture.
</p>

</div>
<div class='secedit editbutton_section editbutton_10'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Solution radicale] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="6059-7642" /><input type="submit" value="Modifier" class="button" title="Solution radicale" /></div></form></div>
<h3 class="sectionedit11" id="opendns_familyshield">OpenDNS FamilyShield</h3>
<div class="level3">

<p>
Cette méthode est la plus simple de toutes ! 
</p>

<p>
Avec OpenDNS FamilyShield, les filtres appliqués sont les mêmes pour tous (pas de paramétrage possible). Il suffit d&#039;utiliser comme serveurs <abbr title="Domain Name System">DNS</abbr> 208.67.222.123 et 208.67.220.123 et le tour est joué. Ces <abbr title="Domain Name System">DNS</abbr> filtrent automatiquement les sites adultes. Il suffit donc de mettre cette connexion par défaut pour tout le monde, et rajouter éventuellement des connexions avec d&#039;autres serveurs <abbr title="Domain Name System">DNS</abbr> pour chacun des utilisateurs qui n&#039;ont pas besoin de filtrage;
</p>

<p>
Une petite note rapide pour dire que cette solution est pour le moins ambiguë, elle filtre effectivement les sites pour adultes, mais en renvoyant à une page appartenant à Opendns, qui fait de la pub… pour d&#039;autres sites pour adultes - sites de rencontre en l&#039;occurrence - comme edarling… Donc à éviter pour les enfants.
</p>

<p>
Pour plus de détails :
</p>

<p>
<a href="http://www.opendns.com/home-solutions/parental-controls" class="urlextern" title="http://www.opendns.com/home-solutions/parental-controls"  rel="nofollow">Site officiel de OpenDNS</a> - (en français)
</p>

<p>
<a href="http://store.opendns.com/familyshield/setup/operatingsystem/ubuntu" class="urlextern" title="http://store.opendns.com/familyshield/setup/operatingsystem/ubuntu"  rel="nofollow">Installation pour Ubuntu</a> - (en anglais)
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[OpenDNS FamilyShield] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="7643-8759" /><input type="submit" value="Modifier" class="button" title="OpenDNS FamilyShield" /></div></form></div>
<h3 class="sectionedit12" id="procon_latte">Procon latte</h3>
<div class="level3">

<p>
Cette extension du navigateur Firefox est plutôt efficace et surtout très simple d&#039;installation. Bien sûr, elle ne convient qu&#039;aux utilisateurs de Firefox !
</p>

</div>

<h5 id="installation">Installation</h5>
<div class="level5">

<p>
Rien de plus simple, il suffit de se rendre à <a href="https://addons.mozilla.org/fr/firefox/addon/1803" class="urlextern" title="https://addons.mozilla.org/fr/firefox/addon/1803"  rel="nofollow">cette adresse avec Firefox</a> et de cliquer sur <em>Installer</em>.
</p>

<p>
Afin d&#039;empêcher la désactivation facile de Procon latte via le menu des modules complémentaires :
</p>
<ol>
<li class="level1"><div class="li"> cliquer sur le bouton &quot;Choisir un mot de passe&quot; pour protéger l&#039;accès à la modification des Préférences</div>
</li>
<li class="level1"><div class="li"> cocher toutes les options des paramètres principaux, et notamment l&#039;option &quot;empêcher la désactivation ou la désinstallation&quot;</div>
</li>
</ol>

<p>
<em class="u">Deux remarques :</em>
</p>

<p>
Le blocage d&#039;accès via la liste blanche ne marche pas pour certains sites, par ex. fr.youtube.com. Dans ce cas, ajouter le nom du site (youtube) à la liste des données explicites du Filtre principal dans la colonne &quot;sites bloqués&quot;.
</p>

<p>
L&#039;extension Public Fox  disponible <a href="https://addons.mozilla.org/fr/firefox/addon/3911" class="urlextern" title="https://addons.mozilla.org/fr/firefox/addon/3911"  rel="nofollow">cette adresse</a> permet d&#039;aller plus loin en bloquant l&#039;accès aux modules complémentaires, mais elle ne fonctionne pas avec l&#039;occurrence &quot;Modules complémentaires&quot; du menu Options de Firefox 3.0, ce qui oblige à installer un autre module de paramétrage du menu Options, comme par ex. Tools Menu Organiser disponible à <a href="https://addons.mozilla.org/fr/firefox/addon/1911" class="urlextern" title="https://addons.mozilla.org/fr/firefox/addon/1911"  rel="nofollow">cette adresse</a>
</p>

</div>

<h5 id="inconvenients">Inconvénients</h5>
<div class="level5">
<ul>
<li class="level1"><div class="li"> Simple à contourner.</div>
</li>
<li class="level1"><div class="li"> Ne protège que Firefox.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Procon latte] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="8760-10296" /><input type="submit" value="Modifier" class="button" title="Procon latte" /></div></form></div>
<h3 class="sectionedit13" id="squidguard">Squidguard</h3>
<div class="level3">

</div>

<h4 id="pre-requis">Pré-requis</h4>
<div class="level4">

<p>
Les logiciels utilisés pour mettre en œuvre ce contrôle parental sont :
</p>
<ul>
<li class="level1"><div class="li"> <a href="../squid" class="wikilink1" title="squid">squid</a> :  </div>
</li>
<li class="level1"><div class="li"> Squidguard (Il faut activer le dépôt universe) (Voir Squidguard  dans la page Squid)</div>
</li>
</ul>

<p>
<p><div class="noteimportant">Ceci explique la mise en place d&#039;un contrôle parental sur un PC Ubuntu directement raccordé sur le net sans réseau local.
</div></p>
</p>

</div>

<h4 id="configuration_de_squid">Configuration de Squid</h4>
<div class="level4">

<p>
Le fichier de configuration est : <strong>/etc/squid3/squid.conf</strong>
</p>

<p>
Tout d&#039;abord, sauvegardez ce fichier avec la commande :
</p>
<pre class="code">sudo cp /etc/squid3/squid.conf /etc/squid3/squid.conf.orig</pre>

<p>
Maintenant, <a href="comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditez ce fichier</a> avec l&#039;éditeur de votre choix en ayant les droits administrateur. Remplacez-en le contenu par les lignes suivantes :
</p>
<pre class="file"># -----------------------------------------------------------
cache_effective_user proxy
cache_effective_group proxy
# -----------------------------------------------------------
visible_hostname none
# -----------------------------------------------------------

# -----------------------------------------------------------
acl all src 0.0.0.0/0.0.0.0
acl localhost src 127.0.0.1/255.255.255.255
acl manager proto cache_object
acl serveur src 192.168.0.1
acl poste src 192.168.0.50
acl multipostes src 192.168.0.100-192.168.0.125
acl SSL_ports port 443 563
acl Safe_ports port 80 # http
acl Safe_ports port 20 # ftp-data
acl Safe_ports port 21 # ftp
acl Safe_ports port 443 563 # ssl
acl Safe_ports port 70 # gopher
acl Safe_ports port 210 # wais
acl Safe_ports port 1025-65535 # unregistered ports
acl Safe_ports port 280 # http-mgmt
acl Safe_ports port 488 # gss-http
acl Safe_ports port 591 # filemaker
acl Safe_ports port 777 # multiling http
acl Safe_ports port 631 # cups
acl Safe_ports port 873 # rsync
acl Safe_ports port 901 # SWAT
acl purge method PURGE
acl CONNECT method CONNECT

http_access allow all

url_rewrite_program /usr/bin/squidGuard -c /etc/squidguard/squidGuard.conf
url_rewrite_children 10

http_port 3128 transparent</pre>

<p>
<p><div class="noteimportant">Avant la version squid 2.6, la directive url_rewrite_program était remplacée par redirect_program et url_rewrite_children  était de même remplacée par redirect_children
</div></p>
</p>

</div>

<h4 id="configuration_d_un_filtre_uniquement_par_squid">Configuration d&#039;un filtre uniquement par Squid</h4>
<div class="level4">

<p>
Squid permet, à lui seul, de mettre en place toute une série de filtres.
</p>

<p>
Dans le cas qui nous intéresse, le contrôle parental, on peut utiliser les filtres suivants :
</p>
<ul>
<li class="level1"><div class="li"> Autoriser l&#039;accès uniquement à une liste de sites (liste blanche).  </div>
</li>
<li class="level1"><div class="li"> Bloquer l&#039;accès à une série de domaines (liste noire).</div>
</li>
<li class="level1"><div class="li"> Bloquer les pages dont l&#039;<abbr title="Uniform Resource Locator">URL</abbr> contient un mot interdit.</div>
</li>
</ul>

<p>
La configuration a lieu en deux temps. On crée d&#039;abord les <abbr title="Access Control List">ACL</abbr> correspondants : 
</p>
<pre class="code">acl whitelist dstdomain &quot;/etc/squid3/whitelist&quot;
acl blacklist dstdomain &quot;/etc/squid3/blacklist&quot;
acl filtre_reg url_regex -i ^.*sex.*$ ^.*porn.*$ ^.*hack.*$ ^.*crack.*$ ^.*drug.*$ ^.*felation.*$</pre>

<p>
Puis on lui applique les filtres :
</p>
<pre class="code">http_access allow whitelist
http_access deny blacklist
http_access deny filtre_reg</pre>

<p>
Squid applique les filtres dans l&#039;ordre. Le premier filtre vérifié s&#039;applique et pas les suivants. 
Il faut donc prendre garde à l&#039;ordre dans lequel on les écrit.
</p>

<p>
Ici, le filtrage pour la whitelist est placé avant celui de la blacklist.
Ainsi, si un domaine se trouve dans les deux listes, le site ne sera pas bloqué 
car Squid appliquera le premier filtre.
</p>

<p>
Pour finir, si aucune des règles n&#039;est vérifiée on autorise l&#039;accès : 
</p>
<pre class="code">http_access allow localhost</pre>

<p>
(avec localhost un <abbr title="Access Control List">ACL</abbr> du type acl localhost src 127.0.0.1/32)
</p>

<p>
Pour une référence plus complète des règles que l&#039;on peut mettre en place dans Squid,
on peut se référer au document :
[<a href="http://www.visolve.com/squid/squid30/squid30.pdf]" class="urlextern" title="http://www.visolve.com/squid/squid30/squid30.pdf]"  rel="nofollow">www.visolve.com/squid/squid30/squid30.pdf]</a>
</p>

</div>

<h4 id="configuration_de_squidguard">Configuration de SquidGuard</h4>
<div class="level4">

<p>
SquidGuard est une sorte de greffon à Squid qui joue le rôle de redirecteur. En fait si une requête du navigateur n&#039;est pas conforme à ce qui a été défini dans sa configuration il affiche une autre page web que celle demandée.
</p>

</div>

<h5 id="les_listes_noires">Les listes noires</h5>
<div class="level5">

<p>
Pour ce qui est du filtrage des sites, on ne va bien sûr pas entrer les adresses à la main, des listes noires existent sur le net. Voici une adresse de blacklist : <a href="ftp://ftp.univ-tlse1.fr/pub/reseau/cache/squidguard_contrib/blacklists.tar.gz" class="urlextern" title="ftp://ftp.univ-tlse1.fr/pub/reseau/cache/squidguard_contrib/blacklists.tar.gz"  rel="nofollow">ftp://ftp.univ-tlse1.fr/pub/reseau/cache/squidguard_contrib/blacklists.tar.gz</a>
</p>

<p>
Voici les commandes à faire pour les installer :
</p>
<pre class="code">wget ftp://ftp.univ-tlse1.fr/pub/reseau/cache/squidguard_contrib/blacklists.tar.gz
sudo tar zxvf blacklists.tar.gz -C /var/lib/squidguard/db/
sudo su
cd /var/lib/squidguard/db
mv blacklists/* .
rm -rf blacklists</pre>

<p>
C&#039;est à partir de cette liste noire que la base de données va être créée pour SquidGuard. Si vous regardez le répertoire /var/lib/squidguard/db, vous verrez pleins de sous-répertoires de thèmes pour les listes noires (gambling, radio, webmail, porn, adult, etc.). Ce sont ces thèmes qu&#039;il faudra définir dans le fichier de configuration de Squidguard.
</p>

</div>

<h4 id="mise_a_jour_hebdomadaire_automatique_des_listes_noires">Mise à jour hebdomadaire automatique des listes noires</h4>
<div class="level4">

<p>
Pour mettre automatiquement à jour, chaque semaine, les listes noires de SquidGuard, il suffit de créer une tâche cron. Créez le fichier /etc/cron.weekly/squidguard_blacklists :
</p>
<pre class="code">sudo gedit /etc/cron.weekly/squidguard_blacklists</pre>

<p>
et inscrivez-y les lignes suivantes :
</p>
<pre class="code">#!/bin/sh
#
# Fichier /etc/cron.weekly/squidguard_blacklists
#
# Télécharge chaque semaine les listes noires pour SquidGuard
# et met à jour les bases de ce dernier.

if [ -d /var/lib/squidguard ]; then
	wget ftp://ftp.univ-tlse1.fr/pub/reseau/cache/squidguard_contrib/blacklists.tar.gz -O /var/lib/squidguard/blacklists.tar.gz
	tar zxvf /var/lib/squidguard/blacklists.tar.gz -C /var/lib/squidguard/
	rm -rf /var/lib/squidguard/db
	mkdir /var/lib/squidguard/db || true
	mv -f /var/lib/squidguard/blacklists/* /var/lib/squidguard/db/
	chmod 2770 /var/lib/squidguard/db
	rm -rf /var/lib/squidguard/blacklists /var/lib/squidguard/blacklists.tar.gz
	/usr/bin/squidGuard -C all
	chown -R proxy:proxy /etc/squid3 /var/log/squid3 /var/spool/squid3 /usr/lib/squid3 /usr/sbin/squid3 /var/lib/squidguard
	service squid3 restart
fi</pre>

<p>
Rendez ce fichier exécutable :
</p>
<pre class="code">sudo chmod +x /etc/cron.weekly/squidguard_blacklists</pre>

<p>
Si vous le désirez, vous pouvez le tester (attention, il est long à rendre la main, à cause de la mise à jour des bases de SquidGuard) :
</p>
<pre class="code">sudo /etc/cron.weekly/squidguard_blacklists</pre>

</div>

<h5 id="le_fichier_de_configuration">Le fichier de configuration</h5>
<div class="level5">

<p>
Le fichier de configuration est : <strong>/etc/squidguard/squidGuard.conf</strong>
</p>

<p>
De même sauvegardez ce fichier avec la commande :
</p>
<pre class="code">sudo cp /etc/squidguard/squidGuard.conf /etc/squidguard/squidGuard.conf.orig</pre>

<p>
Maintenant, <a href="comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditez ce fichier</a> avec l&#039;éditeur de votre choix en ayant les droits administrateur.
</p>

<p>
remplacer le ficher avec les lignes suivantes :
</p>
<pre class="file">#
# CONFIG FILE FOR SQUIDGUARD
#

dbhome /var/lib/squidguard/db
logdir /var/log/squid3

# ------------------------------------------------------------
# Définition de la base de données de filtrage utilisée
# ------------------------------------------------------------
dest adult {
        domainlist adult/domains
        urllist adult/urls
}

dest publicite {
        domainlist publicite/domains
        urllist publicite/urls
}

dest warez {
        domainlist warez/domains
        urllist warez/urls
}

dest porn {
        domainlist porn/domains
        urllist porn/urls
}

dest violence {
        domainlist violence/domains
        urllist violence/urls
}

# ajoutez ici les thèmes supplémentaires de votre choix présents dans la blacklist de la façon suivante :
# dest &lt;nom du thème&gt; {
#        domainlist &lt;nom du thème&gt;/domains
#        urllist &lt;nom du thème&gt;/urls
# }

# ------------------------------------------------------------
# Définition des ACL
# ------------------------------------------------------------

acl {
  default {
# les thèmes supplémentaires sont à ajouter avant le mot-clé all par !&lt;nom du thème&gt;
        pass !porn !adult !publicite !warez !violence all
        redirect  http://www.ovh.com/fr/images/hosting/astuce_htaccess/interdit.jpg
  }
}
# ------------------------------------------------------------</pre>

<p>
<p><div class="noteimportant">Si Squid ne démarre pas, et que /var/log/squid3/cache.log signale le problème &quot;The url_rewriter helpers are crashing too rapidly&quot;, c&#039;est que SquidGuard ne répond pas assez vite. Ceci est probablement dû à un thème contenant des expressions régulières (par exemple la base redirectors). Dans ce cas, essayer de mettre moins de thèmes dans l&#039;<abbr title="Access Control List">ACL</abbr>
</div></p>
</p>

<p>
Maintenant il faut générer la base de données avec la commande suivante : 
</p>
<pre class="code">sudo squidGuard -C all</pre>

<p>
Patientez un peu car ça peut être long.
</p>

<p>
Vous aurez compris ici que SquidGuard va rediriger toutes les pages qui sont non conformes à la règle <strong>pass</strong> vers la page web :  <a href="http://www.ovh.com/fr/images/hosting/astuce_htaccess/interdit.jpg" class="urlextern" title="http://www.ovh.com/fr/images/hosting/astuce_htaccess/interdit.jpg"  rel="nofollow">http://www.ovh.com/fr/images/hosting/astuce_htaccess/interdit.jpg</a> (la page <a href="http://roozeec.free.fr/interdiction.html" class="urlextern" title="http://roozeec.free.fr/interdiction.html"  rel="nofollow">http://roozeec.free.fr/interdiction.html</a> n&#039;est plus accessible, toute autre page affichant un logo d&#039;interdiction peut aussi bien faire l&#039;affaire)
</p>

</div>

<h4 id="configuration_de_iptables">Configuration de IPTABLES</h4>
<div class="level4">

<p>
Maintenant que tout est fait pour ce qui est du proxy, il faut aussi que les requêtes du navigateur soit redirigées vers le proxy Squid que nous venons de configurer. Pour cela, il faut d&#039;abord trouver l&#039;identifiant de l&#039;utilisateur proxy (UID) avec la commande :
</p>
<pre class="code">grep proxy  /etc/passwd
proxy:x:13:13:proxy:/bin:/bin/sh</pre>

<p>
Ici la réponse est 13, donc nous allons créer la règle iptables suivante (13 est ici la valeur donnée précédemment) :
</p>
<pre class="code">sudo iptables -t nat -A OUTPUT -m owner ! --uid-owner 13 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 3128</pre>

<p>
De façon à lancer cette commande au démarrage du PC, il suffit de la mettre dans le fichier <strong>/etc/rc.local</strong>, juste avant la commande exit 0 (13 est ici la valeur donnée précédemment) :
</p>
<pre class="file">#!/bin/sh -e
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will &quot;exit 0&quot; on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

iptables -t nat -A OUTPUT -m owner ! --uid-owner 13 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 3128

exit 0</pre>

</div>

<h4 id="demarrage_de_squid">Démarrage de Squid</h4>
<div class="level4">

<p>
Maintenant que tout est prêt, il suffit de lancer Squid, mais avant tout il va falloir lancer quelques commandes pour bien définir les droits des fichiers : 
</p>
<pre class="code">sudo chown -R proxy:proxy /etc/squid /var/log/squid /var/spool/squid /usr/lib/squid /usr/sbin/squid /var/lib/squidguard</pre>

<p>
Lancer maintenant la commande :
</p>
<pre class="code">sudo squid -z</pre>

<p>
Maintenant le démarrage proprement dit :
</p>
<pre class="code">sudo /etc/init.d/squid start</pre>

<p>
Et la réponse doit être : <em>Starting Squid HTTP proxy squid [ok]</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Squidguard] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="10297-21200" /><input type="submit" value="Modifier" class="button" title="Squidguard" /></div></form></div>
<h3 class="sectionedit14" id="dansguardian">DansGuardian</h3>
<div class="level3">

<p>
Deux autres solutions sont d&#039;utiliser <a href="../dansguardian" class="wikilink1" title="dansguardian">DansGuardian via une passerelle tel qu&#039;expliqué sur cette page</a> ou d&#039;utiliser <a href="../dansguardian_sans_serveur" class="wikilink1" title="dansguardian_sans_serveur">DansGuardian directement sur le pc naviguant sur le net</a> (solution plus simple à mettre en place).
</p>

</div>
<div class='secedit editbutton_section editbutton_14'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[DansGuardian] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="21201-21489" /><input type="submit" value="Modifier" class="button" title="DansGuardian" /></div></form></div>
<h3 class="sectionedit15" id="opendns">OpenDNS</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="http://www.opendns.com" class="urlextern" title="http://www.opendns.com"  rel="nofollow">www.opendns.com</a> - (en anglais)</div>
</li>
</ul>

<p>
La technique est différente, il s&#039;agit ici d&#039;utiliser le service <abbr title="Domain Name System">DNS</abbr> qui transforme une adresse ( ex &quot;<a href="http://ubuntu-fr.org" class="urlextern" title="http://ubuntu-fr.org"  rel="nofollow">http://ubuntu-fr.org</a>&quot; en adresse machine : &quot;80.125.12.55&quot; ).
Du coup PAS DE LOGICIEL à installer sur l&#039;ordi, aucune baisse de performances. La démarche est simplement de rajouter ce <abbr title="Domain Name System">DNS</abbr> à votre configuration réseau. Il faut bien sûr que le compte de l&#039;enfant ne lui permette pas d&#039;aller modifier ce réglage.
</p>

<p>
<a href="https://www.opendns.com/start?device=ubuntu" class="urlextern" title="https://www.opendns.com/start?device=ubuntu"  rel="nofollow">Tutoriel en anglais</a>
</p>

<p>
Ci-dessous la traduction en français
</p>

<p>
Ubuntu
</p>
<ol>
<li class="level1"><div class="li"> Faites un clic-droit sur l&#039; &quot;icône réseau&quot;(situé en haut à droite, par défaut) et cliquez sur &quot;Modification des Connexions&quot; pour ouvrir le Gestionnaire des connexions réseau.</div>
</li>
<li class="level1"><div class="li"> Choisissez le type de connexion dont vous disposez. Pour cet exemple, nous allons utiliser &quot;Filaire&quot;.</div>
</li>
<li class="level1"><div class="li"> Sous &quot;Filaire&quot;, sélectionnez &quot;Auto Etho &#039;et cliquez sur &quot; Modifier &quot;.</div>
</li>
<li class="level1"><div class="li"> Dans la fenêtre &#039;Modification Auto Etho&#039;, cliquez sur l&#039;onglet «Paramètres IPv4&quot;.</div>
</li>
<li class="level1"><div class="li"> Sous &quot;Paramètres IPv4&quot;, changer la méthode &#039;Adresses automatiques uniquement (<abbr title="Dynamic Host Configuration Protocol">DHCP</abbr>)&quot;.</div>
</li>
<li class="level1"><div class="li"> Mettez ces adresses comme Serveurs <abbr title="Domain Name System">DNS</abbr> : 208.67.222.222, 208.67.220.220</div>
</li>
<li class="level1"><div class="li"> Cliquez sur &quot;OK&quot; et redémarrez votre machine. Vous pouvez ensuite visiter <a href="http://welcome.opendns.com" class="urlextern" title="http://welcome.opendns.com"  rel="nofollow">http://welcome.opendns.com</a> pour confirmer que vous utilisez OpenDNS.</div>
</li>
</ol>

<p>
Pour éviter que vos réglages soient révoqués après redémarrage, ou après
des périodes d&#039;inactivité, il peut être nécessaire de faire les
modifications suivantes par l&#039;intermédiaire de la ligne de commande :
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> <span class="kw2">cp</span> <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.conf <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.conf.auto
$ gksudo gedit <span class="sy0">/</span>etc<span class="sy0">/</span>dhcp3<span class="sy0">/</span>dhclient.conf
<span class="co0"># Ajoutez la ligne suivante au document</span>
prepend domain-name-servers 208.67.222.222,208.67.220.220;
<span class="co0"># enregistrez et quittez</span>
$ <span class="kw2">sudo</span> <span class="kw2">ifdown</span> eth0 <span class="sy0">&amp;&amp;</span> <span class="kw2">sudo</span> <span class="kw2">ifup</span> eth0</pre>

<p>
Il peut être nécessaire de changer eth0 pour votre propre interface
réseau si elle utilise un nom non-standard.
</p>

</div>

<h4 id="opendns_et_adresse_ip_dynamique">OpenDNS et adresse IP dynamique</h4>
<div class="level4">

<p>
Une fois que vous avez créé un compte sur OpenDNS, il faut associer à ce compte votre adresse IP. Si vous avez une adresse IP dynamique la mise à jour automatique de cette association peut se faire :
</p>

</div>

<h5 id="via_une_simple_requete_web_lancee_automatiquement_toutes_les_10_minutes">via une simple requête WEB lancée automatiquement toutes les 10 minutes</h5>
<div class="level5">
<pre class="code bash">$ <span class="kw2">sudo</span> crontab <span class="re5">-e</span>
<span class="co0"># Ajoutez la ligne suivante au document (voir doc vi ou nano)</span>
<span class="sy0">*/</span><span class="nu0">10</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="kw2">wget</span> <span class="re5">-O</span> - <span class="re5">-q</span> <span class="re5">--http-user</span>=opendnslogin <span class="re5">--http-passwd</span>=opendnspassword https:<span class="sy0">//</span>updates.opendns.com<span class="sy0">/</span>nic<span class="sy0">/</span>update
<span class="co0"># enregistrez et quittez (voir doc vi ou nano)</span></pre>

<p>
« opendnslogin » est à remplacer par le login de votre compte OpenDNS
</p>

<p>
« opendnspassword » est à remplacer par le mot de passe de votre compte OpenDNS 
</p>

</div>

<h5 id="avec_ddclient">avec ddclient</h5>
<div class="level5">

<p>
<a href="http://www.opendns.com/support/article/192" class="urlextern" title="http://www.opendns.com/support/article/192"  rel="nofollow">doc sur opendns</a>
</p>

<p>
<a href="comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Installez les paquets</a> <strong><a href="apt://ddclient" class="urlextern" title="apt://ddclient"  rel="nofollow">ddclient</a></strong>.
</p>

<p>
<a href="comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">éditez le fichier</a> <strong>/etc/ddclient.conf</strong>
</p>
<pre class="file"># /etc/ddclient.conf
ssl=yes # use ssl-support
use=web, web=whatismyip.org
protocol=dyndns2
server=updates.opendns.com
login=opendnslogin
password=&#039;opendnspassword&#039;
home</pre>

<p>
« opendnslogin » est à remplacer par le login de votre compte OpenDNS
« opendnspassword » est à remplacer par le mot de passe de votre compte OpenDNS 
</p>

<p>
<a href="comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditez le fichier</a> <strong>/etc/default/ddclient</strong>
</p>
<pre class="file"># Configuration for ddclient scripts
# generated from debconf on mardi 22 décembre 2009, 18:06:36 (UTC+0100)
#
# /etc/default/ddclient

# Set to &quot;true&quot; if ddclient should be run every time a new ppp connection is
# established. This might be useful, if you are using dial-on-demand
run_ipup=&quot;true&quot;

# Set to &quot;true&quot; if ddclient should run in daemon mode
run_daemon=&quot;true&quot;

# Set the time interval between the updates of the dynamic DNS name in seconds.
# This option only takes effect if the ddclient runs in daemon mode.
daemon_interval=&quot;600&quot;</pre>

<p>
Vérifiez que run_daemon est bien sur true
</p>

<p>
vous pouvez tester le client avec 
</p>
<pre class="code bash"><span class="kw2">sudo</span> ddclient <span class="re5">-v</span></pre>

<p>
et relancer le daemon 
</p>
<pre class="code bash"><span class="kw2">sudo</span> <span class="sy0">/</span>etc<span class="sy0">/</span>init.d<span class="sy0">/</span>ddclient restart</pre>

</div>

<h4 id="opendns_et_session_utilisateur">OpenDNS et session utilisateur</h4>
<div class="level4">

<p>
Il est possible de faire en sorte que le filtrage ne s&#039;applique que si la session d&#039;un utilisateur bien défini est ouverte. 
</p>

<p>
Pour cela il faut créer un script bash et deux fichiers <abbr title="Domain Name System">DNS</abbr> (resolv), un pour les utilisateurs non restreints et un pour l&#039;utilisateur à restreindre.
</p>

<p>
Dans l&#039;exemple ci-dessous le script s&#039;appelle « opendns », le fichier <abbr title="Domain Name System">DNS</abbr> non restreint « resolv.adult » et restreint « resolv.child »
</p>

<p>
Créer le fichier /etc/resolv.child :
</p>
<pre class="code bash"><span class="co4">$ </span><span class="kw2">sudo</span> gedit <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.child</pre>

<p>
avec les lignes suivantes :
</p>
<pre class="file"># generated by opendns - resolv.child

# /usr/sbin/opendns
# /etc/resolv.child
# /etc/resolv.adult
# link /etc/NetworkManager/dispatcher.d/opendns
# line opendns in crontab as root (sudo crontab -e)
# line ALL ALL=NOPASSWD:/usr/sbin/opendns in /etc/sudoers (sudo visudo)

nameserver 208.67.222.222
nameserver 208.67.220.220
</pre>

<p>
Propriétaire : root via chown ; Permissions : 644 via chmod
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> <span class="kw2">chown</span> root:root <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.child
$ <span class="kw2">sudo</span> <span class="kw2">chmod</span> <span class="nu0">644</span> <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.child</pre>

<p>
Créer le fichier /etc/resolv.adult :
</p>
<pre class="code bash"><span class="co4">$ </span><span class="kw2">sudo</span> gedit <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.adult</pre>

<p>
Avec les lignes suivantes :
</p>
<pre class="file"># generated by opendns - resolv.adult

# /usr/sbin/opendns
# /etc/resolv.child
# /etc/resolv.adult
# link /etc/NetworkManager/dispatcher.d/opendns
# line opendns in crontab as root (sudo crontab -e)
# line ALL ALL=NOPASSWD:/usr/sbin/opendns in /etc/sudoers (sudo visudo)

nameserver x.x.x.x
nameserver y.y.y.y
</pre>

<p>
x.x.x.x et y.y.y.y sont à remplacer par les <abbr title="Domain Name System">DNS</abbr> de votre <abbr title="Fournisseur d&#039;Accès à Internet">FAI</abbr>
</p>

<p>
Propriétaire : root via chown ; Permissions : 644 via chmod
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> <span class="kw2">chown</span> root:root <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.adult
$ <span class="kw2">sudo</span> <span class="kw2">chmod</span> <span class="nu0">644</span> <span class="sy0">/</span>etc<span class="sy0">/</span>resolv.adult</pre>

<p>
Créer le fichier /usr/sbin/opendns : 
</p>
<pre class="code bash"><span class="co4">$ </span><span class="kw2">sudo</span> gedit <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns</pre>

<p>
avec les lignes suivantes :
</p>
<pre class="file">#!/bin/bash

# /usr/sbin/opendns
# /etc/resolv.child
# /etc/resolv.adult
# link /etc/NetworkManager/dispatcher.d/opendns
# line opendns in crontab as root (sudo crontab -e)
# line ALL ALL=NOPASSWD:/usr/sbin/opendns in /etc/sudoers (sudo visudo)

if users | grep -c &quot;child&quot; &gt; /dev/null ; then
wget -O - -q --http-user=opendnslogin --http-passwd=opendnspassword https://updates.opendns.com/nic/update
cp /etc/resolv.child /etc/resolv.conf
else
cp /etc/resolv.adult /etc/resolv.conf
fi</pre>

<p>
A la ligne 
</p>

<p>
if users | grep -c &quot;child&quot; &gt; /dev/null ; then
</p>

<p>
&quot;child&quot; est a remplacer par le nom de l&#039;utilisateur que vous souhaitez restreindre (garder les guillemets)
</p>

<p>
« opendnslogin » est à remplacer par le login de votre compte OpenDNS
</p>

<p>
« opendnspassword » est à remplacer par le mot de passe de votre compte OpenDNS
</p>

<p>
Ce script remplacera les <abbr title="Domain Name System">DNS</abbr> normaux par les <abbr title="Domain Name System">DNS</abbr> de OpenDNS si la session « child » est ouverte et mettra à jour votre adresse IP (dynamique) sur OpenDNS. Si la session « child » est inactive les <abbr title="Domain Name System">DNS</abbr> seront ceux de votre <abbr title="Fournisseur d&#039;Accès à Internet">FAI</abbr> et il n&#039;y aura pas de mise à jour de votre adresse IP sur OpenDNS.
</p>

<p>
Propriétaire : root via chown ; Permissions : 755 via chmod
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> <span class="kw2">chown</span> root:root <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns
$ <span class="kw2">sudo</span> <span class="kw2">chmod</span> <span class="nu0">755</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns</pre>

<p>
Il faut ensuite permettre aux utilisateurs de lancer le script en tant que root sans avoir à taper le mot de passe :
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> visudo 
<span class="co0"># Ajoutez la ligne suivante au document (voir doc vi ou nano) :</span>
ALL <span class="re2">ALL</span>=NOPASSWD:<span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns
<span class="co0"># enregistrez et quittez (voir doc vi ou nano)</span></pre>

<p>
Ajouter un lien dans /etc/NetworkManager/dispatcher.d/ pour que le script s&#039;exécute à chaque changement d&#039;état du réseau avec la commande :
</p>
<pre class="code bash"><span class="co4">$ </span><span class="kw2">sudo</span> <span class="kw2">ln</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns <span class="sy0">/</span>etc<span class="sy0">/</span>NetworkManager<span class="sy0">/</span>dispatcher.d<span class="sy0">/</span>opendns</pre>

<p>
Ajouter la ligne dans le cron pour que le script s&#039;exécute toute les 10 minutes :
</p>
<pre class="code bash">$ <span class="kw2">sudo</span> crontab <span class="re5">-e</span>
<span class="co0"># Ajoutez la ligne suivante au document (voir doc vi ou nano)</span>
<span class="sy0">*/</span><span class="nu0">10</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="sy0">*</span> <span class="sy0">/</span>usr<span class="sy0">/</span>sbin<span class="sy0">/</span>opendns
<span class="co0"># enregistrez et quittez (voir doc vi ou nano)</span></pre>

<p>
Dans ce cas, le script opendns effectuant lui-même la mise à jour de l&#039;adresse IP sur OpenDNS,  il n&#039;est plus nécessaire de mettre la ligne d&#039;update automatique dans le crontab décrite plus haut (OpenDNS et adresse IP dynamique).
</p>

<p>
Vous pouvez aussi mettre &quot;sudo opendns&quot; dans les programmes de démarrage de la session « child » (que « child » pourrait quand même désactiver, c&#039;est pour cela que l&#039;on utilise aussi le crontab)
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[OpenDNS] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="21490-30027" /><input type="submit" value="Modifier" class="button" title="OpenDNS" /></div></form></div>
<h2 class="sectionedit16" id="voir_aussi">Voir aussi</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> <a href="http://kb.mozillazine.org/Parental_controls" class="urlextern" title="http://kb.mozillazine.org/Parental_controls"  rel="nofollow">Contrôle parental chez mozilla</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://addons.mozilla.org/fr/firefox/addon/11595" class="urlextern" title="https://addons.mozilla.org/fr/firefox/addon/11595"  rel="nofollow">eXtension broozi</a></div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <a href="http://forum.ubuntu-fr.org/viewtopic.php?id=167998" class="urlextern" title="http://forum.ubuntu-fr.org/viewtopic.php?id=167998"  rel="nofollow">Discussion &quot;Contròle parental et IPtables&quot; sur le forum ubuntu-fr</a></div>
</li>
<li class="level1"><div class="li"> <a href="restrictions_horaires" class="wikilink1" title="tutoriel:restrictions_horaires">Restreindre les plages horaires autorisées pour chaque utilisateur</a></div>
</li>
<li class="level1"><div class="li"> <a href="https://github.com/raf64flo/parental_control" class="urlextern" title="https://github.com/raf64flo/parental_control"  rel="nofollow">Scripts shell sur Github pour installer et supprimer le contrôle parental (à adapter, il n&#039;y a pas de paramètres à ce jour)</a></div>
</li>
</ul>
<hr />

<p>
<em>Contributeurs : <a href="../utilisateurs/roozeec" class="wikilink1" title="utilisateurs:roozeec">Roozeec</a>, Boris Le Hachoir, <a href="../utilisateurs/fabien26" class="wikilink1" title="utilisateurs:fabien26">Fabien26</a>, <a href="../utilisateurs/furious-therapy" class="wikilink1" title="utilisateurs:furious-therapy">Furious-therapy</a>, sensouci.</em>
</p>

</div>
<div class='secedit editbutton_section editbutton_16'><form class="button btn_secedit" method="post" action="comment_mettre_en_place_un_controle_parental"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1431695132" /><input type="hidden" name="summary" value="[Voir aussi] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="30028-" /><input type="submit" value="Modifier" class="button" title="Voir aussi" /></div></form></div>
<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/0/078c620bc34a50d0db7948efacf3d59b.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="../index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="comment_mettre_en_place_un_controle_parental?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="comment_mettre_en_place_un_controle_parental?do=edit&amp;rev=0"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li>
                  <li><a href="comment_mettre_en_place_un_controle_parental?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="comment_mettre_en_place_un_controle_parental?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="comment_mettre_en_place_un_controle_parental?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="../wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="../documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
