<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>tutoriel:comprendre_la_configuration_du_clavier - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2015-03-12T15:47:59+0100"/>
<meta name="keywords" content="natty,tutoriel,clavier,brouillon"/>
<link rel="search" type="application/opensearchdescription+xml" href="../lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="../index.html"/>
<link rel="contents" href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="../feed.php?mode=list&amp;ns=tutoriel"/>
<link rel="edit" title="Modifier cette page" href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="http://doc.ubuntu-fr.org/_export/xhtml/tutoriel/comprendre_la_configuration_du_clavier"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="http://doc.ubuntu-fr.org/_export/raw/tutoriel/comprendre_la_configuration_du_clavier"/>
<link rel="canonical" href="comprendre_la_configuration_du_clavier"/>
<link rel="stylesheet" type="text/css" href="../lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='tutoriel';var JSINFO = {"id":"tutoriel:comprendre_la_configuration_du_clavier","namespace":"tutoriel"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="comprendre_la_configuration_du_clavier#main" tabindex="1">Contenu</a> | <a href="comprendre_la_configuration_du_clavier#qsearch__in" tabindex="2">Rechercher</a> | <a href="comprendre_la_configuration_du_clavier#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="../index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="comprendre_la_configuration_du_clavier" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="comprendre_la_configuration_du_clavier" >tutoriel:comprendre_la_configuration_du_clavier</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <div class="notetag">Selon les <a href="../tags">tags</a> présents sur cette page, celle-ci est ancienne et ne contient plus d'informations sur une des  <a href="../versions">versions supportées d'Ubuntu</a>.<br />
Cette page est en cours de rédaction.<br />
<a href="../wiki/participer_wiki">Apportez votre aide…</a>
</div>
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table des matières</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="comprendre_la_configuration_du_clavier#le_clavier_et_sa_relation_avec_le_systeme">Le clavier et sa relation avec le système</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#codes_de_touches_keycodes">Codes de touches (keycodes)</a></div></li>
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#conversion_codes_de_touche_-_symboles_de_touche">Conversion codes de touche -&gt; symboles de touche</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comprendre_la_configuration_du_clavier#principe_de_gestion_du_clavier_par_xkb">Principe de gestion du clavier par XKB</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#schema_simplifie">Schéma  simplifié</a></div></li>
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#etat_du_claviermodificateurs_et_numero_de_groupe">État du clavier : modificateurs et numéro de groupe</a></div></li>
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#definition_des_touches">Définition des touches</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comprendre_la_configuration_du_clavier#regles_d_ecriture_des_fichiers_de_configuration">Règles d&#039;écriture des fichiers de configuration</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#syntaxe_structurelle_des_fichiers">Syntaxe structurelle des fichiers</a></div></li>
<li class="level2"><div class="li"><a href="comprendre_la_configuration_du_clavier#regles_de_fusionimbrication_des_fichiers">Règles de fusion / imbrication des fichiers</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="comprendre_la_configuration_du_clavier#demarche_d_ecriture_de_son_agencement_personnalise">Démarche d&#039;écriture de son agencement personnalisé</a></div></li>
<li class="level1"><div class="li"><a href="comprendre_la_configuration_du_clavier#references_bibliographiques">Références bibliographiques</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->
<div class="tags"><span>
	<a href="../natty" class="wikilink1" title="natty" rel="tag">Natty</a>,
	<a href="http://doc.ubuntu-fr.org/tutoriel" class="wikilink1" title="tutoriel" rel="tag">tutoriel</a>,
	<a href="../clavier" class="wikilink1" title="clavier" rel="tag">clavier</a>,
	<a href="../brouillon" class="wikilink1" title="brouillon" rel="tag">BROUILLON</a>
</span></div>
<hr />

<h1 class="sectionedit1" id="comprendre_la_configuration_du_clavier">Comprendre la configuration du clavier</h1>
<div class="level1">

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Comprendre la configuration du clavier] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="48-100" /><input type="submit" value="Modifier" class="button" title="Comprendre la configuration du clavier" /></div></form></div>
<h2 class="sectionedit2" id="le_clavier_et_sa_relation_avec_le_systeme">Le clavier et sa relation avec le système</h2>
<div class="level2">

<p>
Rappelons que les informations transmises par une touche du clavier au système (pilote clavier, <a href="http://doc.ubuntu-fr.org/noyau" class="wikilink1" title="noyau">noyau Linux</a> et <a href="../xorg" class="wikilink1" title="xorg">serveur X</a>) ne sont pas directement liées au symbole graphique ou à l’événement attaché à cette touche. Par exemple, l&#039;appui sur la touche <em>A</em> de votre clavier ne signifie pas que ce clavier adresse à l&#039;ordinateur quelque code que ce soit représentant le caractère <em>A</em>.<br/>

Ce qui est envoyé à l&#039;ordinateur est en réalité une suite de valeurs hexadécimales appelées <strong>« scan-codes »</strong> qui représentent la position physique de la touche sur le clavier et des informations précisant s&#039;il s&#039;agit de l&#039;actionnement ou du relâchement de la touche. C&#039;est le système d&#039;exploitation qui va interpréter ces codes plus ou moins directement et transmettre aux applications un <strong>symbole de touche</strong> <sup><a href="comprendre_la_configuration_du_clavier#fn__1" id="fnt__1" class="fn_top">1)</a></sup>.
</p>

<p>
Ces symboles de touche <sup><a href="comprendre_la_configuration_du_clavier#fn__2" id="fnt__2" class="fn_top">2)</a></sup> envoyés aux applications représentent :
</p>
<ul>
<li class="level1"><div class="li"> soit  des <strong>caractères directement affichables</strong>, parmi lesquels les lettres et les chiffres ou divers symboles graphiques, </div>
</li>
<li class="level1"><div class="li"> soit  des <strong>codes d’événement ou de fonction</strong> que chacune des applications doit interpréter à sa manière.</div>
</li>
</ul>

<p>
Dans le détail, les « <strong>scan-codes</strong> » sont d&#039;abord transformés en <strong>codes de touches</strong> <sup><a href="comprendre_la_configuration_du_clavier#fn__3" id="fnt__3" class="fn_top">3)</a></sup>   puis en <strong>symboles de touches</strong> <sup><a href="comprendre_la_configuration_du_clavier#fn__4" id="fnt__4" class="fn_top">4)</a></sup> .<br/>

</p>

<p>
La deuxième étape de l&#039;interprétation fait appel à une table de correspondance entre les <strong>codes de touches</strong> (qui sont invariants) et les <strong>symboles de touches</strong>. Cette table de correspondance qui représente la disposition des caractères sur les touches est appelée «<strong> agencement de clavier</strong><sup><a href="comprendre_la_configuration_du_clavier#fn__5" id="fnt__5" class="fn_top">5)</a></sup> »  .<br/>

Ainsi, si l&#039;agencement choisi est US, la touche marquée <em>A</em> sur votre clavier sera interprétée comme un <em>Q</em> ; si l&#039;agencement choisi est FR la touche sera interprétée comme un <em>A</em>.
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Le clavier et sa relation avec le système] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="101-2056" /><input type="submit" value="Modifier" class="button" title="Le clavier et sa relation avec le système" /></div></form></div>
<h3 class="sectionedit3" id="codes_de_touches_keycodes">Codes de touches (keycodes)</h3>
<div class="level3">

<p>
Il existe dans Ubuntu une table qui associe les codes de touche à des <strong>noms symboliques</strong> censés aider à repérer la touche sur le clavier. Un exemple de ce type de table de correspondance est <a href="comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">visible dans le fichier</a> /usr/share/X11/xkb/keycodes/evdev et dans lequel vous verrez différentes lignes de la forme :
</p>
<pre class="file">&lt;AE01&gt; = 10;</pre>

<p>
Ici cela signifie que la touche <strong>A</strong>lphanumérique marquée du chiffre <em>1</em> <sup><a href="comprendre_la_configuration_du_clavier#fn__6" id="fnt__6" class="fn_top">6)</a></sup> est en première position (<strong>01</strong>) de la ligne <strong>E</strong> (les lignes sont numérotées de A à E en partant du coté de l&#039;utilisateur et en allant vers l&#039;écran <sup><a href="comprendre_la_configuration_du_clavier#fn__7" id="fnt__7" class="fn_top">7)</a></sup>  ) et a le code <strong>10</strong>.<br/>

</p>

<p>
Une autre ligne de la forme :
</p>
<pre class="file">&lt;LFSH&gt; = 50;</pre>

<p>
signifie que la touche majuscule de gauche a le code <strong>50</strong>   (LF pour left = gauche et SH pour Shift =Maj) .
</p>

<p>
Pour faciliter l&#039;utilisation de certains codes de touche <sup><a href="comprendre_la_configuration_du_clavier#fn__8" id="fnt__8" class="fn_top">8)</a></sup>, il existe également un fichier  /usr/share/X11/xkb/keycodes/aliases  qui associe au nom symbolique des touches un nom plus intelligible appelé <strong>alias</strong>.<br/>

Voici par exemple un court extrait de la section &quot;qwerty&quot; :
</p>
<pre class="file">xkb_keycodes &quot;qwerty&quot; {

   alias &lt;LatQ&gt; = &lt;AD01&gt;;
   alias &lt;LatW&gt; = &lt;AD02&gt;;
   </pre>

<p>
Pour autant que la section &quot;qwerty&quot; de ce fichier soit expressément spécifiée dans la configuration, la touche &lt;AD01&gt; pourra être désignée également par &lt;LatQ&gt;.
<p><div class="notewarning">Il n&#039;y a normalement pas lieu de toucher aux fichiers contenus dans le dossier <strong>/usr/share/X11/xkb/keycodes</strong>. En effet, les codes émis par les touches ne sont pas modifiables. S&#039;il existe de nombreux  fichiers associant ces numéros de code aux noms symboliques&#039; c&#039;est parce que les constructeurs n&#039;utilisent pas tous le même code pour une touche placée au même endroit.  Il y a donc besoin d&#039;un tel fichier pour chacun des types de clavier. 
</div></p>
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Codes de touches (keycodes)] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="2057-4294" /><input type="submit" value="Modifier" class="button" title="Codes de touches (keycodes)" /></div></form></div>
<h3 class="sectionedit4" id="conversion_codes_de_touche_-_symboles_de_touche">Conversion codes de touche -&gt; symboles de touche</h3>
<div class="level3">

<p>
Il existe dans le dossier <strong>/usr/share/X11/xkb/symbols</strong>, des fichiers qui  définissent des <strong>tables de correspondance</strong> entre les <strong>codes de touches</strong> et les <strong>symboles de touches</strong> pour les différentes langues, et dont les sections traitent des différentes variantes de clavier connues, comme par exemple le fichier /usr/share/X11/xkb/symbols/fr pour la langue française.<br/>

Ces tables, découpées en sections, se combinent selon des règles d&#039;inclusion et d&#039;ajout bien précises afin que le système puisse ainsi faire face à une combinatoire importante entre types de clavier, langues, variantes.
</p>

<p>
Pour le cas précis de la redéfinition d&#039;une table de correspondance pour un clavier donné, une table linéaire <sup><a href="comprendre_la_configuration_du_clavier#fn__9" id="fnt__9" class="fn_top">9)</a></sup> reprenant l&#039;ensemble des touches peut suffire. 
</p>

<p>
Par ailleurs, parmi les différentes tables évoquées ci-dessus, celles sélectionnées par l&#039;utilisateur, dans le dialogue des préférences clavier, se combinent au démarrage du système pour former une table plus vaste dénommée <strong>carte du clavier</strong> <sup><a href="comprendre_la_configuration_du_clavier#fn__10" id="fnt__10" class="fn_top">10)</a></sup>.
</p>

<p>
Si vous n&#039;avez sélectionné qu&#039;une seule table, c&#039;est à dire un seul <a href="http://doc.ubuntu-fr.org/tutoriel/configurer_le_clavier" class="wikilink1" title="tutoriel:configurer_le_clavier">agencement de clavier</a>, la carte du clavier lui correspondra strictement bien entendu.
</p>

</div>

<h4 id="lire_la_carte_du_clavier">Lire la carte du clavier</h4>
<div class="level4">

<p>
<p><div class="noteimportant">Si vous avez actuellement plusieurs agencements de clavier, et pour pouvoir faire les manipulations proposées ici, n&#039;en conservez qu&#039;un pour le moment. <em>France Autre</em> pour cet exemple. Supprimez les autres dans le dialogue des préférences de clavier.
</div></p>
Si vous voulez, voir la <strong>carte du clavier active</strong> correspondant à votre seul <sup><a href="comprendre_la_configuration_du_clavier#fn__11" id="fnt__11" class="fn_top">11)</a></sup> agencement actuel, saisissez dans un <a href="../terminal" class="wikilink1" title="terminal">terminal</a>  la <a href="../commande_shell" class="wikilink1" title="commande_shell">commande</a> suivante :
</p>
<pre class="code">xmodmap -pke | less</pre>

<p>
Faites défilez les pages avec les flèches de changement de page.
</p>

<p>
Si vous désirez pouvoir examiner dans le détail cette carte, sauvegardez-là dans un fichier.<br/>

Par exemple, si vous souhaitez en disposer sur votre Bureau avec pour nom <em>carte_active</em> vous entrerez la commande :
</p>
<pre class="code">xmodmap -pke &gt; ~/Bureau/carte_active</pre>

<p>
.
</p>

</div>

<h4 id="touches_modificatrices_modifier_keys">Touches modificatrices (modifier keys)</h4>
<div class="level4">

<p>
Considérez la ligne suivante de la <strong>carte du clavier</strong>.
</p>
<pre class="file">keycode  24 = a A æ Æ </pre>

<p>
Mettez en regard la ligne correspondante issue de la <strong>table</strong> de correspondance correspondant à votre agencement actuel.<br/>

Par exemple pour le clavier français, il s&#039;agira du fichier <strong>/usr/share/X11/xkb/symbols/fr</strong> dans lequel vous trouverez, à la section &quot;Autre&quot;, la ligne suivante :
</p>
<pre class="file">    key &lt;AD01&gt;	{ [                a,                A,  æ,    Æ ] }; // a A æÆ</pre>

<p>
Elles sont très cohérentes entre elles et cela paraît normal.<br/>

Maintenant, dans un <a href="http://doc.ubuntu-fr.org/editeur_de_texte" class="wikilink1" title="editeur_de_texte">éditeur de texte</a> saisissez au clavier la combinaison de touches suivante, en vous basant sur la marquage du clavier, avec les espaces mais sans les parenthèses :
</p>
<pre class="code">(A) (⇧+A)  (Alt Gr+A)  (Alt Gr+⇧+A) </pre>

<p>
<p><div class="noteclassic">⇧représente la touche majuscule et + indique que les deux ou trois touches doivent être pressées une par une et maintenues jusqu&#039;à ce que la dernière soit frappée.
</div></p>
Vous obtenez le résultat suivant :
</p>
<pre class="file">a A æ Æ</pre>

<p>
Ceci correspond bien à la ligne de définition pour la lettre <em>A</em> du fichier <strong>fr</strong> et à celle de la carte de clavier active.
<p><div class="noteimportant">La &quot;carte du clavier&quot;, rangée dans le fichier <strong>carte_active</strong>, ne correspond à la table <strong>fr</strong> section &quot;Autre&quot; que si des réaffectations de touches n&#039;ont pas été faites par des commandes en ligne.<br/>
Notez que cette façon de réaffecter les touches par des commandes en ligne est perturbante dans la mesure où elle désynchronise la perception que vous avez de votre agencement par les outils graphiques et la réalité.
</div></p>
</p>

<p>
Vous observerez donc par cet exemple, et c&#039;est vrai pour d&#039; autres touches, qu&#039;un même code de touche peut être associé à plusieurs (ici quatre) symboles de touche et que ces symboles de touche sont obtenus en accompagnant l&#039;appui sur la touche par maintien préalable d&#039;autres touches, telles que ⇧, <em>Alt Gr</em> ou la combinaison des deux. 
</p>

<p>
Les touches ⇧ et Alt Gr, qui ne produisent pas d&#039;effet en elles-mêmes, mais qui modifient le symbole de touche envoyé par la touche qui les accompagne, sont appelées<strong> touches modificatrices</strong> <sup><a href="comprendre_la_configuration_du_clavier#fn__12" id="fnt__12" class="fn_top">12)</a></sup>.
</p>

<p>
<p><div class="noteimportant">En réalité, les touches ne sont pas modificatrices par elles-même. C&#039;est plutôt le symbole de touche qui leur est attaché qui l&#039;est. Aussi ces touches peuvent-elles être changées pour d&#039;autres. Vous verrez plus loin dans cette page, que pour être modificateur, ces symboles doivent être mis en relation avec certaines variables faisant partie de l&#039;<strong>état du clavier</strong> qui est transmis aux librairies chargées de la transformation des scan-codes en symboles de touche.
</div></p>
</p>

<p>
Ceci introduit la notion de niveau de touches avec ici :
</p>
<ul>
<li class="level1"><div class="li"> symbole de niveau 1 : <strong>a</strong>  →  accessible sans touche modificatrice</div>
</li>
<li class="level1"><div class="li"> symbole de niveau 2 : <strong>A</strong>  → accessible avec la touche modificatrice ⇧</div>
</li>
<li class="level1"><div class="li"> symbole de niveau 3 : <strong>æ</strong>  → accessible avec la touche modificatrice Alt Gr</div>
</li>
<li class="level1"><div class="li"> symbole de niveau 4 : <strong>Æ</strong>  → accessible avec les touches modificatrice Alt Gr+⇧</div>
</li>
</ul>

<p>
L&#039;image suivante illustre cet aspect des choses :
<a href="http://doc.ubuntu-fr.org/_detail/tutoriel/niveaux_de_touche.jpg?id=tutoriel%3Acomprendre_la_configuration_du_clavier" class="media" title="tutoriel:niveaux_de_touche.jpg"><img src="http://doc.ubuntu-fr.org/_media/tutoriel/niveaux_de_touche.jpg?w=200&amp;tok=710fd5" class="mediacenter" alt="" width="200" /></a>
</p>

</div>

<h4 id="groupes">Groupes</h4>
<div class="level4">

<p>
Pour comprendre la notion de groupe, allez maintenant dans le dialogue des préférences de clavier et ajoutez dans cet ordre :
</p>
<ol>
<li class="level1"><div class="li"> le clavier anglais US,</div>
</li>
<li class="level1"><div class="li"> le clavier US International</div>
</li>
<li class="level1"><div class="li"> le clavier Allemagne Macintosh.</div>
</li>
</ol>

<p>
L&#039;indicateur de clavier s&#039;affiche alors dans l&#039;applet de notification général pour vous indiquer le clavier en usage et pour vous permettre d&#039;en changer.
</p>

<p>
Fermez tous les fichiers précédemment ouverts (notamment le fichier <strong>/usr/share/X11/xkb/symbols/fr</strong> et votre fichier sauvegarde de carte de clavier <strong>~/Bureau/carte_active</strong> ) puis dans un <a href="../terminal" class="wikilink1" title="terminal">terminal</a> saisissez de nouveau la <a href="../commande_shell" class="wikilink1" title="commande_shell">commande</a> :
</p>
<pre class="code">xmodmap -pke &gt; ~/Bureau/carte_active</pre>

<p>
<a href="comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Ouvrez cette sauvegarde</a> de la nouvelle carte active et sélectionnez la ligne correspondant au <em>keycode</em> 24 pour visualiser ceci:
</p>
<pre class="file">keycode  24 = a A q Q ae AE q Q adiaeresis Adiaeresis q Q guillemotleft guillemotright</pre>

<p>
Ce qui en clair correspond à :
</p>
<div class="table sectionedit5"><table class="inline">
	<tr class="row0">
		<th class="col0">keycode 24 </th><td class="col1"> a </td><td class="col2"> A </td><td class="col3"> q </td><td class="col4"> Q </td><td class="col5"> æ </td><td class="col6"> Æ </td><td class="col7"> q </td><td class="col8"> Q </td><td class="col9"> ä </td><td class="col10"> Ä </td><td class="col11"> q </td><td class="col12"> Q </td><td class="col13"> « </td><td class="col14"> » </td>
	</tr>
</table></div>

<p>
Le principe de passage des tables de correspondance des différents agencements à la carte active dans le système est imagé ci-après:
</p>

<p>
<a href="http://doc.ubuntu-fr.org/_detail/tutoriel/groupes_et_niveaux.jpg?id=tutoriel%3Acomprendre_la_configuration_du_clavier" class="media" title="tutoriel:groupes_et_niveaux.jpg"><img src="http://doc.ubuntu-fr.org/_media/tutoriel/groupes_et_niveaux.jpg?w=400&amp;tok=5936f3" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
Dans la terminologie du <a href="../xorg" class="wikilink1" title="xorg">serveur X</a> et de son extension <strong>XKB</strong>, un groupe correspond à l&#039;ensemble des symboles d&#039;un agencement, que l&#039;on obtient par sélection avec l&#039;indicateur de clavier ou une séquence de touche modificatrices. <sup><a href="comprendre_la_configuration_du_clavier#fn__13" id="fnt__13" class="fn_top">13)</a></sup>
</p>

<p>
<p><div class="noteclassic">Notez au passage, que les niveaux 3 et 4 n&#039;étant pas présent dans la table du clavier US, ces niveaux sont aussi omis dans la carte active. Ceci rend la lecture de cette carte un peu plus difficile.
</div></p>
</p>

<p>
Mis à part, la particularité signalée dans la note ci-dessus, et en notant <em>GiNj</em>, <strong>i</strong> étant la valeur du <strong>G</strong>roupe et <strong>j</strong> celle du <strong>N</strong>iveau, la carte présente les données dans cet ordre:
</p>
<div class="table sectionedit6"><table class="inline">
	<tr class="row0">
		<td class="col0"> G1N1 </td><td class="col1"> G1N2 </td><td class="col2"> G2N1 </td><td class="col3"> G2N2 </td><td class="col4"> G1N3 </td><td class="col5"> G1N4 </td><td class="col6"> G2N3 </td><td class="col7"> G2N4 </td><td class="col8"> G3N1 </td><td class="col9"> G3N2 </td><td class="col10"> G4N1 </td><td class="col11"> G4N2 </td><td class="col12"> G3N3 </td><td class="col13"> G3N4 </td><td class="col14"> G4N3 </td><td class="col15"> G4N4 </td>
	</tr>
</table></div>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Conversion codes de touche -&gt; symboles de touche] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="4295-12205" /><input type="submit" value="Modifier" class="button" title="Conversion codes de touche -&gt; symboles de touche" /></div></form></div>
<h2 class="sectionedit7" id="principe_de_gestion_du_clavier_par_xkb">Principe de gestion du clavier par XKB</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Principe de gestion du clavier par XKB] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="12206-12256" /><input type="submit" value="Modifier" class="button" title="Principe de gestion du clavier par XKB" /></div></form></div>
<h3 class="sectionedit8" id="schema_simplifie">Schéma  simplifié</h3>
<div class="level3">

<p>
Le schéma simplifié de la gestion du clavier par le <a href="../xorg" class="wikilink1" title="xorg">serveur X</a> avec son module XKB est donné par la figure suivante :
</p>

<p>
<a href="http://doc.ubuntu-fr.org/_detail/tutoriel/serveurx-clavier2.jpg?id=tutoriel%3Acomprendre_la_configuration_du_clavier" class="media" title="tutoriel:serveurx-clavier2.jpg"><img src="http://doc.ubuntu-fr.org/_media/tutoriel/serveurx-clavier2.jpg?w=400&amp;tok=d5bd07" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
Sur ce schéma, vous remarquerez que :
</p>
<ul>
<li class="level1"><div class="li"> Le serveur X n&#039;adresse pas lui même les symboles de touche aux applications. Ce sont Xlib et les toolkits qui le font en utilisant la carte du clavier vue précédemment et en se basant sur les &quot;scancodes&quot; et l&#039;<strong>état du clavier</strong> contenus dans l’événement transmis par le serveur X.</div>
</li>
<li class="level1"><div class="li"> Le serveur X gère une variable appelée <em>état du clavier</em> et communique cette information aux librairies. En pratique, pour gérer cet <strong>état du clavier</strong>, il utilise le code de touche qui, rappelons le, ne représente pas que des caractères, mais aussi des fonctions à exécuter.</div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Schéma  simplifié] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="12257-13087" /><input type="submit" value="Modifier" class="button" title="Schéma  simplifié" /></div></form></div>
<h3 class="sectionedit9" id="etat_du_claviermodificateurs_et_numero_de_groupe">État du clavier : modificateurs et numéro de groupe</h3>
<div class="level3">

</div>

<h4 id="modificateurs">Modificateurs</h4>
<div class="level4">

<p>
Vous avez vu précédemment que certaines touches du clavier étaient à l&#039;origine du choix du symbole parmi ceux associés à un code de touche particulier. Pour que cela puisse se produire, il faut en réalité que deux conditions soient remplies :
</p>
<ol>
<li class="level1"><div class="li"> que le code de touche soit associé à un symbole bien précis,</div>
</li>
<li class="level1"><div class="li"> que ce symbole de touche soit mis en relation directe avec une des variables binaires de l&#039;état du clavier.</div>
</li>
</ol>

<p>
Ainsi, par exemple, pour que la touche <em>Alt gr</em> provoque la sélection du symbole de touche de niveau 3, il faut que soient écrites dans les tables de symboles les lignes suivantes :
 
</p>
<pre class="file"> key &lt;RALT&gt; { type[Group1]=&quot;ONE_LEVEL&quot;, symbols[Group1] = [ ISO_Level3_Shift ]
    };
  modifier_map Mod5  {ISO_Level3_Shift };</pre>

<p>
Le symbole de touche ISO_Level3_Shift est le symbole associé au niveau 3.
</p>

<p>
La variable <strong>Mod5</strong> est une des variables qui font partie de l&#039;état du clavier et qui sont prises en compte dans l&#039;interprétation du niveau par les librairies xlib. Ces variables sont appelées «<strong>Modificateurs</strong>».
</p>

</div>

<h4 id="voir_les_modificateurs">Voir les modificateurs</h4>
<div class="level4">

<p>
Les modificateurs présents dans l&#039;état du clavier transmis aux librairies sont les suivants :
</p>
<div class="table sectionedit10"><table class="inline">
	<tr class="row0">
		<td class="col0">Shift</td><td class="col1">Lock</td><td class="col2">Control</td><td class="col3">Mod1</td><td class="col4">Mod2</td><td class="col5">Mod3</td><td class="col6">Mod4</td>
	</tr>
</table></div>

<p>
Si vous voulez savoir à quelle fonction de modification sont associés ces modificateurs, saisissez dans un <a href="../terminal" class="wikilink1" title="terminal">terminal</a> la <a href="../commande_shell" class="wikilink1" title="commande_shell">commande</a> suivante:
</p>
<pre class="code">xmodmap -pm</pre>

<p>
Le résultat devraient ressembler à ceci :
</p>
<pre class="code">xmodmap:  up to 4 keys per modifier, (keycodes in parentheses):

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x42)
control     Control_L (0x25),  Control_R (0x69)
mod1        Alt_L (0x85),  Meta_L (0xcd)
mod2        Num_Lock (0x4d)
mod3      
mod4        Super_L (0x40),  Super_R (0x86),  Super_L (0xce),  Hyper_L (0xcf)
mod5        ISO_Level3_Shift (0x5c),  Mode_switch (0xcb)
</pre>

<p>
Vous pouvez voir ici entre autres, que le modificateur shift est associé aux touches qui sont elles mêmes associées aux symboles Shift_L <sup><a href="comprendre_la_configuration_du_clavier#fn__14" id="fnt__14" class="fn_top">14)</a></sup> et Shift_R  <sup><a href="comprendre_la_configuration_du_clavier#fn__15" id="fnt__15" class="fn_top">15)</a></sup> et que le passage en niveau 3 se fait par la touche qui est associée au symbole ISO_Level3_Shift.
</p>

<p>
Pour que les modificateurs Mod1 à Mod5 aient un effet déterminé sur le choix du symbole de touche, il faut qu&#039;ils soient mis en correspondance avec un symbole de touche modificateur, par une instruction du type :
</p>
<pre class="code">modifier_map Mod2   { Num_Lock };</pre>

<p>
 ou d&#039;une façon plus générique :
</p>
<pre class="code">modifier_map nomModficateur   { NomSymbole };</pre>

<p>
Des exemples de symboles de touche possédant une fonction modificatrice sont : ISO_Level3_Shift, Num_Lock, ISO_Level5_Shift, Caps_Lock…<br/>

Le fichier  /usr/include/X11/keysymdef.h présente tous les symboles de touche utilisés dans le système ; les symboles de touche à fonction modificatrice y apparaissent dans des sections repérées par le titre «modifiers».
</p>

</div>

<h4 id="numero_de_groupe">Numéro de groupe</h4>
<div class="level4">

<p>
La table de clavier étant divisée en <a href="comprendre_la_configuration_du_clavier#groupes" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">groupes</a>, il faut donc que l&#039;état du clavier comprenne une information sur le numéro de groupe pour le sélectionner. Cette information est bien présente dans l&#039;état du clavier, à coté des <a href="comprendre_la_configuration_du_clavier#modificateurs" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">modificateurs</a> qui, pour leur part,  permettent de sélectionner le bon niveau.
</p>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[État du clavier : modificateurs et numéro de groupe] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="13088-16494" /><input type="submit" value="Modifier" class="button" title="État du clavier : modificateurs et numéro de groupe" /></div></form></div>
<h3 class="sectionedit11" id="definition_des_touches">Définition des touches</h3>
<div class="level3">

</div>

<h4 id="types_de_touche">Types de touche</h4>
<div class="level4">

<p>
Le type de touche précise la manière dont sont pris en compte les modificateurs pour sélectionner le symbole de touche parmi tous ceux qui, classés par niveaux, font partie de sa définition.<br/>

Les différents types de touches sont définis dans les fichiers placés dans le dossier <strong>/usr/share/X11/xkb/types</strong> et sont de la forme 
</p>
<pre class="file">type &#039;NomDeType &#039;{&#039; Instructions &#039;};</pre>

<p>
.  Parmi les instructions, on peut rencontrer les instructions suivantes :
</p>
<ul>
<li class="level1"><div class="li"> modifiers = &lt;liste de modificateurs&gt; : il s&#039;agit de la liste des modificateurs qui sont repris dans la définition du type.</div>
</li>
<li class="level1"><div class="li"> map[&lt;combinaison de modificateurs&gt;] = &lt;nom du niveau&gt; : c&#039;est la combinaison de modificateurs correspondant au nom du niveau indiqué. <br/>
Les noms reconnus par le programme xmodmap vont de Level1 à Level8. Au delà il faut utiliser une valeur numérique, mais il y a peu de chances que vous en ayez besoin. </div>
</li>
<li class="level1"><div class="li"> level_name[&lt;nom normalisé&gt;] = &lt;nom symbolique libre&gt; : xkb ne fait aucun usage de ces noms symboliques, mais ils sont néanmoins requis. Ils servent dans l&#039;affichage des agencements.</div>
</li>
<li class="level1"><div class="li"> preserve[…] = … : Reportez vous aux documentations citées en référence <sup><a href="comprendre_la_configuration_du_clavier#fn__16" id="fnt__16" class="fn_top">16)</a></sup> pour des éclaircissements sur cette instruction dont la compréhension est difficile aux non programmeurs, et n&#039;est pas indispensable ici.<br/>
</div>
</li>
</ul>

<p>
Voici un exemple de définition de type :
</p>
<pre class="file">    type &quot;ALPHABETIC&quot; {
        modifiers = Shift+Lock;
        map[Shift] = Level2;
        map[Lock] = Level2;
        level_name[Level1] = &quot;Base&quot;;
        level_name[Level2] = &quot;Caps&quot;;
    };</pre>

<p>
S&#039;agissant ici de touches purement alphabétiques, il n&#039;y a besoin que de la définition des symboles de touche affectés aux différents niveaux standards, soit deux niveaux seulement.
</p>

<p>
Et pour terminer un type couramment rencontré :
</p>
<pre class="file">    type &quot;FOUR_LEVEL_ALPHABETIC&quot; {
	modifiers = Shift+Lock+LevelThree;
	map[None] = Level1;
	map[Shift] = Level2;
	map[Lock]  = Level2;
	map[LevelThree] = Level3;
	map[Shift+LevelThree] = Level4;
	map[Lock+LevelThree] =  Level4;
	map[Lock+Shift+LevelThree] =  Level3;
	level_name[Level1] = &quot;Base&quot;;
	level_name[Level2] = &quot;Shift&quot;;
	level_name[Level3] = &quot;Alt Base&quot;;
	level_name[Level4] = &quot;Shift Alt&quot;;
    };</pre>

<p>
<p><div class="noteclassic">  On observera que dans les modificateurs apparaissent des noms (comme LevelThree) qui ne font pas partie de la liste des modificateurs, cités plus haut, qui sont normalement transmis dans l&#039;état du clavier.  Ces modificateurs, à usage réservé de xkb, sont appelés<strong> modificateurs virtuels</strong>. xkb les utilise en réalité pour établir l&#039;état du clavier, en particulier l&#039;état des modificateurs qui en font partie. Ces modificateurs standards sont aussi  appelés : <strong>modificateurs réels</strong>. Cet aspect sera détaillé lorsque sera abordée la définition même des touches.
</div></p>
</p>

<p>
xkb attache aux touches, les types par défaut suivants  :
</p>
<ul>
<li class="level1"><div class="li"> ONE_LEVEL <sup><a href="comprendre_la_configuration_du_clavier#fn__17" id="fnt__17" class="fn_top">17)</a></sup> : pour les touches qui ne possèdent qu&#039;un seul symbole et qui est indépendant des modificateurs. Par exemple Enter, Escape, Space, etc…</div>
</li>
<li class="level1"><div class="li"> TWO_LEVEL <sup><a href="comprendre_la_configuration_du_clavier#fn__18" id="fnt__18" class="fn_top">18)</a></sup> : pour les touches à deux niveaux non alphabétiques. Le deuxième niveau est choisi par le modificateur <em>Shift</em> mais ne fait pas intervenir le modificateur <em>Lock</em>. Des exemples de telles touches sont sur un clavier AZERTY standard: <em>1/€€</em>,</div>
</li>
<li class="level1"><div class="li"> ALPHABETIC : pour les touches alphabétiques. Elles possèdent deux niveaux également mais sont dépendantes de <em>Shift</em> <strong>et</strong> de <em>Lock</em>.</div>
</li>
<li class="level1"><div class="li"> &quot;KEYPAD&quot; <sup><a href="comprendre_la_configuration_du_clavier#fn__19" id="fnt__19" class="fn_top">19)</a></sup>: Il s&#039;agit de touches supplémentaires, sur certains claviers, regroupées en carré comprenant le plus souvent les touches numériques et les touches de direction. Elles ont deux niveaux aussi, mais dépendent de <em>Shift</em> <strong>et</strong> de <em>NumLock</em>. <em>NumLock</em> est un symbole de touche qui, lorsqu&#039;il est attaché à un des modificateurs standards Mod1 à Mod5, lui confère une fonction de verrouillage de la fonction numérique des touches du pavé.</div>
</li>
</ul>

</div>

<h4 id="la_definition_proprement_dite_des_touches">La définition proprement dite des touches</h4>
<div class="level4">

<p>
Chacun des fichiers contenus dans le dossier <strong>/usr/share/X11/xkb/symbols</strong> a le contenu suivant
</p>
<pre class="file">key codeDeTouche	{description};</pre>

<p>
où <em>codeDeTouche</em> est le code de la touche tel qu&#039;<a href="comprendre_la_configuration_du_clavier#codes_de_touches_keycodes" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">expliqué plus haut</a>, de la forme <strong>&lt;xxxx&gt;</strong> et où la partie entre accolades comprend la définition proprement dite. Cette définition peut porter sur de nombreux paramètres qu&#039;il est difficile de présenter tous ici sans entrer dans des considérations complexes qui dépassent le besoin de ce tutoriel.<br/>

Pour une présentation exhaustive reportez-vous aux documents cités en référence en fin de page. 
</p>

<p>
<a href="comment_modifier_un_fichier" class="wikilink1" title="tutoriel:comment_modifier_un_fichier">Ouvrez</a> par exemple le fichier  <strong>/usr/share/X11/xkb/symbols/latin</strong> pour y trouver des définitions de touches sous la forme suivante :
</p>
<pre class="file">    key &lt;AD01&gt;	{ [         q,          Q,           at,  Greek_OMEGA ]	};
    key &lt;AD02&gt;	{ [         w,          W,      lstroke,      Lstroke ]	};
    key &lt;AD03&gt;	{ [         e,          E,            e,            E ]	};
    key &lt;AD04&gt;	{ [         r,          R,    paragraph,   registered ]	};
    key &lt;AD05&gt;	{ [         t,          T,       tslash,       Tslash ]	};
    key &lt;AD06&gt;	{ [         y,          Y,    leftarrow,          yen ]	};</pre>

<p>
Il s&#039;agit ici de la déclaration de simples touches alphabétiques pour laquelle sont indiqués les symboles de touche des quatre niveaux qu&#039;elle prévoit.
</p>

<p>
Vous pourrez également trouver dans certains fichiers des lignes attribuant à la touche un <a href="comprendre_la_configuration_du_clavier#type" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">type</a> qui aura été renseigné dans un des fichiers du dossier <strong>/usr/share/X11/xkb/types</strong> et qui auront la forme
</p>
<pre class="file">type = ..., or type[numéroGroupe] = ...</pre>

<p>
par exemple
</p>
<pre class="file">type[Group1]=&quot;ONE_LEVEL&quot;,type[Group2]=&quot;TWO_LEVEL&quot;,</pre>

<p>
 <p><div class="noteclassic">Si vous souhaitez inclure un type personnel dans une configuration particulière du clavier, prenez exemple sur les types décrits dans les fichiers du dossier <strong>/usr/share/X11/xkb/types</strong>. 
Vous noterez par ailleurs que les fichiers de symboles ne comprennent en général qu&#039;un seul groupe et que les différents groupes de la carte du clavier sont formés à partir de chacun de ces fichiers lors de la sélection des agencements dans l&#039;interface graphique. Néanmoins, plusieurs groupes peuvent être compris dans un seul fichier.
</div></p>
</p>

<p>
Il existe également des lignes qui attribuent les symboles de touche aux différents niveaux des différents groupes
</p>
<pre class="file">symbols[...] = ...</pre>

<p>
par exemple : 
</p>
<pre class="file">symbols[Group1] = [ ISO_Level3_Shift, ISO_Next_Group ],</pre>

<p>
 <p><div class="noteclassic">La remarque faite précédemment à propos des groupes vaut également dans ce cas.
</div></p>
</p>

<p>
Lorsque la description ne comprend que des symboles de touche, il est possible de se contenter simplement de la partie entre crochets, par exemple :
</p>
<pre class="file">key &lt;AE02&gt;	{ [         2,   quotedbl,           at,    oneeighth ]	};</pre>

<p>
<p><div class="noteclassic">Lorsque le type de paramètre décrit est le dernier dans la description de la touche, la virgule finale est supprimée.
</div></p>
</p>

</div>
<div class='secedit editbutton_section editbutton_11'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Définition des touches] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="16495-23677" /><input type="submit" value="Modifier" class="button" title="Définition des touches" /></div></form></div>
<h2 class="sectionedit12" id="regles_d_ecriture_des_fichiers_de_configuration">Règles d&#039;écriture des fichiers de configuration</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_12'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Règles d'écriture des fichiers de configuration] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="23678-23738" /><input type="submit" value="Modifier" class="button" title="Règles d'écriture des fichiers de configuration" /></div></form></div>
<h3 class="sectionedit13" id="syntaxe_structurelle_des_fichiers">Syntaxe structurelle des fichiers</h3>
<div class="level3">

<p>
D&#039;une façon assez générale, les fichiers de configuration se présentent comme  une suite de sections de la forme suivante :
</p>

<p>
[ <a href="comprendre_la_configuration_du_clavier#drapeaux" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">Drapeaux</a> ] <a href="comprendre_la_configuration_du_clavier#typedefichier" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">TypeDeFichier</a> [ <a href="comprendre_la_configuration_du_clavier#nomdesection" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">NomDeSection</a> ] &#039;{&#039; [ <a href="comprendre_la_configuration_du_clavier#instructions" title="tutoriel:comprendre_la_configuration_du_clavier ↵" class="wikilink1">Instructions</a> ] &#039;};:
</p>

</div>

<h4 id="drapeaux">Drapeaux</h4>
<div class="level4">

<p>
Un seul de ces drapeaux est utilisé par xkb : <strong>default</strong>. La section marquée <em>default</em> est celle qui est prise en compte lorsqu&#039;une référence au fichier est faite sans mentionner le nom de la section.
</p>

<p>
Les autres noms sont à destination de l&#039;utilisateur pour l&#039;aider à se repérer. Ces noms sont assez évocateurs pour qu&#039;on ne s&#039;attarde pas sur leur explication.
</p>

</div>

<h4 id="typedefichier">TypeDeFichier</h4>
<div class="level4">

<p>
Il représente le type du fichier parmi ceux énumérés ci-après :
</p>
<div class="table sectionedit14"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Type de fichier </th><th class="col1"> Définition </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"><strong>xkb_keycodes</strong></td><td class="col1"> Fichiers établissant la correspondance entre le code de chacune des touches et un nom symbolique de ce code. Les fichiers de ce type sont placés dans le dossier <strong>/usr/share/X11/xkb/keycodes</strong></td>
	</tr>
	<tr class="row2">
		<td class="col0"><strong>xkb_types</strong></td><td class="col1"> Fichiers décrivant les types de touche, en particulier leur nombre de niveaux et la relation entre ces niveaux et les modificateurs. Les fichiers de ce type sont placés dans le dossier <strong> /usr/share/X11/xkb/types</strong></td>
	</tr>
	<tr class="row3">
		<td class="col0"><strong>xkb_symbols</strong></td><td class="col1">Fichiers décrivant, entre autres, le type et les symboles de touche de cette touche. Les fichiers de ce type sont placés dans le dossier <strong>/usr/share/X11/xkb/symbols</strong></td>
	</tr>
	<tr class="row4">
		<td class="col0"><strong>xkb_compat</strong></td><td class="col1">Fichiers décrivant le comportement des modificateurs. Ceci renvoie à des notions complexes qui ne sont pas strictement nécessaires pour la compréhension de ce tutoriel. Pour une présentation exhaustive reportez-vous aux documents cités en référence en fin de page. Les fichiers de ce type sont placés dans le dossier <strong>/usr/share/X11/xkb/compat</strong></td>
	</tr>
	<tr class="row5">
		<td class="col0"><strong>xkb_geometry</strong></td><td class="col1">Fichiers décrivant le placement physique des touches sur le clavier. Les fichiers de ce type sont placés dans le dossier <strong>/usr/share/X11/xkb/geometry</strong></td>
	</tr>
</table></div>

<p>
<p><div class="noteclassic">Notez que toutes les sections d&#039;un même fichier doivent être du même type.
</div></p>
</p>

</div>

<h4 id="nomdesection">NomDeSection</h4>
<div class="level4">

<p>
Il attribue un nom à la section. Pour les instructions d&#039;inclusion de fichier, ou de partie de fichier, une  référence à une section particulière pourra être faite en utilisant ce nom.
</p>

</div>

<h4 id="instructions">Instructions</h4>
<div class="level4">

<p>
Les instructions dépendent du type de fichier et sont expliqués dans les différentes sections traitant de ces fichiers.
Par exemple, dans un fichier du dossier <em>symbols</em>, on peut trouver une instruction de définition des symboles attachés aux différents de cette touche telle que :
 
</p>
<pre class="file">key &lt;AC01&gt;	{ [                q,                Q,           adiaeresis,            Adiaeresis ] }; // q Q ä Ä</pre>

</div>
<div class='secedit editbutton_section editbutton_13'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Syntaxe structurelle des fichiers] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="23739-26450" /><input type="submit" value="Modifier" class="button" title="Syntaxe structurelle des fichiers" /></div></form></div>
<h3 class="sectionedit15" id="regles_de_fusionimbrication_des_fichiers">Règles de fusion / imbrication des fichiers</h3>
<div class="level3">

<p>
D&#039;une façon générale, les fichiers de configuration n&#039;ont pas une présentation où ceux-ci seraient indépendants les uns des autres. Au contraire, ils sont en général très imbriqués, faisant appel, par des instructions <em>include</em>, à des parties d&#039;autres fichier de même type. Ceci rend d&#039;ailleurs la lecture d&#039;une configuration donnée assez difficile.
</p>

</div>

<h4 id="l_instruction_include">L&#039;instruction include</h4>
<div class="level4">

<p>
Les programmeurs n&#039;ont pas besoin d&#039;explication sur cette instruction présente dans nombre de langages de programmation. Pour les autres disons qu&#039;elle permet d&#039;inclure, à l&#039;endroit où elle est placée, le contenu textuel de ce à quoi elle fait référence, comme si ce texte avait été placé directement à cet endroit.
</p>

</div>

<h4 id="modes_de_fusion">Modes de fusion</h4>
<div class="level4">

<p>
Le fait de procéder par inclusions, parfois en cascade, conduit à une possibilité accrue de voir un élément, tel qu&#039;une définition de touche par exemple, décrit ou défini plusieurs fois. Ceci conduit à se poser la question de ce qui se passe quand ces déclarations multiples sont en conflit. C&#039;est à ce stade que les modes de fusion interviennent.<br/>

Avant de voir comment faire appel à eux, en voici une courte description :
</p>
<div class="table sectionedit16"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Mode </th><th class="col1"> Description </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"><strong>augment</strong></td><td class="col1">Quand ce mode de fusion est utilisé et qu&#039;une nouvelle déclaration entre en conflit avec une précédente déclaration, la déclaration précédente est conservée. </td>
	</tr>
	<tr class="row2">
		<td class="col0"><strong>override</strong></td><td class="col1">Quand ce mode de fusion est utilisé et qu&#039;une nouvelle déclaration entre en conflit avec une précédente déclaration, la nouvelle déclaration est conservée</td>
	</tr>
	<tr class="row3">
		<td class="col0"><strong>replace</strong></td><td class="col1">En général, ce mode est équivalent au mode <em>override</em>.Cependant, l&#039;interprétation en est plus nuancée dans les fichiers de symboles de touches. Comme la description d&#039;une touche comporte une suite de symboles à associer aux différents niveaux, il se peut que plusieurs descriptions d&#039;une même touche, intéressent chacune une partie seulement de l&#039;ensemble des symboles. Dans un tel cas, si le mode est <em>override</em>, les symboles des <strong>niveaux décrits</strong> de la nouvelle déclaration écrasent ceux de l&#039;ancienne; par contre, si le mode est replace, <strong>tous les niveaux sont écrasés</strong>, ce qui signifie que les symboles absents de la nouvelle déclaration seront sans symbole affecté.</td>
	</tr>
	<tr class="row4">
		<td class="col0"><strong>alternate</strong></td><td class="col1">Ce mode n&#039;est utilisé que pour les codes de touche. La nouvelle définition est considérée comme un alias.</td>
	</tr>
</table></div>

</div>

<h4 id="mise_en_œuvre_des_modes_de_fusion">Mise en œuvre des modes de fusion</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Sans autre déclaration qui le contredise à l&#039;intérieur de l&#039;élément inclus, lors de l&#039;inclusion d&#039;un élément , le mode <em>override</em> est appliqué par défaut.</div>
</li>
<li class="level1"><div class="li"> Si l&#039;inclusion porte sur une suite d&#039;éléments reliés par le signe +, les éléments ajoutés sont fusionnés entre eux avec le mode <em>override</em>. Les déclarations internes peuvent néanmoins contredire ce principe.</div>
</li>
<li class="level1"><div class="li"> Si l&#039;inclusion porte sur une suite d&#039;éléments reliés par le signe |, les éléments ajoutés sont fusionnés entre eux avec le mode <em>augment</em>. Les déclarations internes peuvent néanmoins contredire ce principe.</div>
</li>
<li class="level1"><div class="li"> Le mode de fusion par défaut, override, peut être contredit en remplaçant le terme include par le nom d&#039;un mode d&#039;insertion. Par exemple, dans un fichier de symboles :</div>
</li>
</ul>
<pre class="file">replace «fr(oss_nodeadkeys)&quot;</pre>

<p>
signifie que les déclarations du fichier fr doivent être incluse en appliquant le mode <em>replace</em> et non pas le mode  par défaut <em>override</em>. Les déclarations internes peuvent néanmoins contredire ce principe.
</p>
<ul>
<li class="level1"><div class="li"> Pour finir, un appel interne à un mode de fusion, l&#039;emporte sur une déclaration antérieure, par exemple :</div>
</li>
</ul>
<pre class="file"> 
 replace key &lt;HYPR&gt; {
    vmods = NumLock,
    symbols[Group1] = [ NoSymbol ],
    actions[Group1] = [ SetMods(modifiers=NumLock) ]
  };</pre>

<p>
signifie que cette nouvelle définition de la touche &lt;HYPR&gt; annule et remplace toutes les définitions précédentes de cette touche.
</p>

</div>
<div class='secedit editbutton_section editbutton_15'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Règles de fusion / imbrication des fichiers] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="26451-30405" /><input type="submit" value="Modifier" class="button" title="Règles de fusion / imbrication des fichiers" /></div></form></div>
<h2 class="sectionedit17" id="demarche_d_ecriture_de_son_agencement_personnalise">Démarche d&#039;écriture de son agencement personnalisé</h2>
<div class="level2">

<p>
Les pages <a href="creer_et_utiliser_un_agencement_de_clavier_personnalise" class="wikilink1" title="tutoriel:creer_et_utiliser_un_agencement_de_clavier_personnalise">Créer et utiliser un agencement de clavier personnalisé</a> et <a href="exemple_de_creation_d_un_agencement_clavier_personnalise" class="wikilink1" title="tutoriel:exemple_de_creation_d_un_agencement_clavier_personnalise">Exemple de création d&#039;un agencement de clavier personnalisé</a> décrivent, dans les grandes lignes pour la première et, très en détails pour la seconde, la démarche d&#039;écriture d&#039;un agencement personnalisé.
</p>

</div>
<div class='secedit editbutton_section editbutton_17'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Démarche d'écriture de son agencement personnalisé] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="30406-30891" /><input type="submit" value="Modifier" class="button" title="Démarche d'écriture de son agencement personnalisé" /></div></form></div>
<h2 class="sectionedit18" id="references_bibliographiques">Références bibliographiques</h2>
<div class="level2">

<p>
Les bases théoriques de cette page sont accessibles sur le site de <a href="http://pascal.tsu.ru/en/xkb/" class="urlextern" title="http://pascal.tsu.ru/en/xkb/"  rel="nofollow"> Ivan Pascal</a>, qui traite d&#039;une manière exhaustive tout ce qui n&#039;a pu être qu&#039;effleuré ici. Ce texte, bien écrit, requiert néanmoins une attention soutenue, en particulier, à qui n&#039;est pas un programmeur. 
</p>
<hr />

<p>
<em>Contributeurs: <a href="http://doc.ubuntu-fr.org/utilisateurs/jaaf64" class="wikilink1" title="utilisateurs:jaaf64">jaaf64</a> </em>
</p>
<hr />

<p>
<strong>Notes</strong>
</p>

</div>
<div class='secedit editbutton_section editbutton_18'><form class="button btn_secedit" method="post" action="comprendre_la_configuration_du_clavier"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1426171679" /><input type="hidden" name="summary" value="[Références bibliographiques] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="30892-" /><input type="submit" value="Modifier" class="button" title="Références bibliographiques" /></div></form></div><div class="footnotes">
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
 <em>keysymbol</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
 <em>keysymbols</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__3" id="fn__3" class="fn_bot">3)</a></sup> 
 <em>keycodes</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__4" id="fn__4" class="fn_bot">4)</a></sup> 
<em> keysymbols</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__5" id="fn__5" class="fn_bot">5)</a></sup> 
<em>keyboard layout</em></div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__6" id="fn__6" class="fn_bot">6)</a></sup> 
sur la rangée de chiffres au dessus des lettres sur un clavier <a href="http://bepo.fr/wiki/TypeMatrix" class="urlextern" title="http://bepo.fr/wiki/TypeMatrix"  rel="nofollow">Typematrix</a>.</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__7" id="fn__7" class="fn_bot">7)</a></sup> 
Du moins pour ce qui est des caractères imprimables, c&#039;est à dire en excluant les lignes qui ne comprennent que des caractères de contrôle.</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__8" id="fn__8" class="fn_bot">8)</a></sup> 
  <em>keycodes</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__9" id="fn__9" class="fn_bot">9)</a></sup> 
C&#039;est à dire ici sans combinaison avec d&#039;autres table par inclusion par exemple.</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__10" id="fn__10" class="fn_bot">10)</a></sup> 
keymap en anglais.</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__11" id="fn__11" class="fn_bot">11)</a></sup> 
compte tenu de la note ci-dessus</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__12" id="fn__12" class="fn_bot">12)</a></sup> 
 <em>modifier keys</em> </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__13" id="fn__13" class="fn_bot">13)</a></sup> 
 Au démarrage du système il s&#039;agit de ⇧+ Ver Maj. Si vous souhaitez changer cette combinaison, reportez-vous à la section <strong>Passer rapidement d&#039;un agencement à l&#039;autre</strong> de la page « <a href="http://doc.ubuntu-fr.org/tutoriel/configurer_le_clavier#passer_rapidement_d_un_agencement_a_l_autre" class="wikilink1" title="tutoriel:configurer_le_clavier">Configurer le clavier</a> ». </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__14" id="fn__14" class="fn_bot">14)</a></sup> 
touche majuscule de gauche</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__15" id="fn__15" class="fn_bot">15)</a></sup> 
touche majuscule de droite</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__16" id="fn__16" class="fn_bot">16)</a></sup> 
 Voir en bas de page</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__17" id="fn__17" class="fn_bot">17)</a></sup> 
1 niveau </div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__18" id="fn__18" class="fn_bot">18)</a></sup> 
2 niveaux</div>
<div class="fn"><sup><a href="comprendre_la_configuration_du_clavier#fnt__19" id="fn__19" class="fn_bot">19)</a></sup> 
 littéralement : pavé de touches, encore appelé «pavé numérique»</div>
</div>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/e/ec716bd9fd7eaa88f1bd72f468a02869.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="../index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=edit&amp;rev=0"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/tutoriel/comprendre_la_configuration_du_clavier?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="../wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="../documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
