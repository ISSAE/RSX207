<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>utilisateurs:amj:brouillons:debootstrap - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2013-07-26T22:52:46+0200"/>
<meta name="keywords" content="brouillon"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="../../../index.html"/>
<link rel="contents" href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="http://doc.ubuntu-fr.org/feed.php?mode=list&amp;ns=utilisateurs:amj:brouillons"/>
<link rel="alternate" type="text/html" title="HTML brut" href="http://doc.ubuntu-fr.org/_export/xhtml/utilisateurs/amj/brouillons/debootstrap"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="http://doc.ubuntu-fr.org/_export/raw/utilisateurs/amj/brouillons/debootstrap"/>
<link rel="canonical" href="debootstrap"/>
<link rel="stylesheet" type="text/css" href="../../../lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='utilisateurs:amj:brouillons';var JSINFO = {"id":"utilisateurs:amj:brouillons:debootstrap","namespace":"utilisateurs:amj:brouillons"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="debootstrap#main" tabindex="1">Contenu</a> | <a href="debootstrap#qsearch__in" tabindex="2">Rechercher</a> | <a href="debootstrap#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="../../../index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="debootstrap" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="debootstrap" >utilisateurs:amj:brouillons:debootstrap</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table des matières</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="debootstrap#introduction">Introduction</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#but">But</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#installation_des_programmes_requis">Installation des programmes requis</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#formatage_et_montage_des_disques">Formatage et montage des disques</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#utilisation_de_debootstrap">utilisation de debootstrap</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#montages_en_vue_d_un_chroot">Montages en vue d&#039;un chroot</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#chroot">Chroot</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#dans_le_chroot">Dans le chroot</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="debootstrap#montage_dans_le_chroot">montage dans le chroot</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="debootstrap#parametrage_de_apt">Paramétrage de apt</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="debootstrap#installation_des_locales">Installation des locales</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="debootstrap#parametrage_de_hostname_et_fstab">Paramétrage de hostname et fstab</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="debootstrap#copie_des_fichier_necessaires">Copie des fichier nécessaires</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="debootstrap#installer_le_kernel_et_grub">Installer le kernel et grub</a></div></li>
<li class="level1"><div class="li"><a href="debootstrap#mot_de_passe">mot de passe</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="installer_ubuntu_via_un_terminal_grace_a_debootstrap_et_a_chroot">Installer ubuntu via un terminal grâce à debootstrap et à chroot</h1>
<div class="level1">
<div class="tags"><span>
	<a href="../../../brouillon" class="wikilink1" title="brouillon" rel="tag">BROUILLON</a>
</span></div>

</div>

<h2 class="sectionedit2" id="introduction">Introduction</h2>
<div class="level2">

<p>
Debootstrap est un outil performant qui sert à installer les composants essentiels du système linux. Il est notamment utilisé dans les netinstall de debian.
Chroot est un programme permettant de changer la racine du système, c&#039;est à dire utiliser un deuxième système linux en même temps que le premier avec un seul kernel.
</p>

</div>

<h2 class="sectionedit3" id="but">But</h2>
<div class="level2">

<p>
Ce tutoriel a plusieurs utilisations possibles :
</p>
<ul>
<li class="level1"><div class="li"> Installer un ubuntu complet à partir de n&#039;importe quel Linux sans avoir besoin de media externe.</div>
</li>
<li class="level1"><div class="li"> Comprendre comment Linux est installé.</div>
</li>
<li class="level1"><div class="li"> Créer un environnement de test sur une machine → passer l’installation du kernel</div>
</li>
</ul>

</div>

<h2 class="sectionedit4" id="installation_des_programmes_requis">Installation des programmes requis</h2>
<div class="level2">

<p>
(cette partie doit être adaptée à votre distribution Linux)
</p>

<p>
<a href="../../../tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Installez le paquet</a> <strong><a href="apt://debootstrap" class="interwiki iw_apt" title="apt://debootstrap">debootstrap</a></strong>
</p>

<p>
<p><div class="notetip">Si vous voulez installer une version d&#039;ubuntu ultérieure à celle pouvant être installée avec votre version de debootstrap, il est alors nécessaire d&#039;installer la dernière version de debootstrap, <img src="../../../lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> instable <img src="../../../lib/images/smileys/icon_exclaim.gif" class="icon" alt=":!:" /> disponible ici <a href="http://pkgs.org/search/?keyword=debootstrap" class="urlextern" title="http://pkgs.org/search/?keyword=debootstrap"  rel="nofollow">http://pkgs.org/search/?keyword=debootstrap</a> 
</div></p>
</p>

</div>

<h2 class="sectionedit5" id="formatage_et_montage_des_disques">Formatage et montage des disques</h2>
<div class="level2">

<p>
Pour un disque dur vide, créez une partition de ± 10Go par exemple puis la swap, ici 1Go (2 fois plus que la RAM).
</p>
<pre class="code">sudo fdisk /dev/sda
Command (m for help): p
.
.
.
Command (m for help): n
Command action
  e   extended
  p   primary partition (1-4)
p
Partition number (1-4): 1
First cylinder (1-3876, default 1): (Appuyez sur Entrée)
Using default value 1
Last cylinder or +size or +sizeM or +sizeK (1-3876, default 3876): +10000</pre>

<p>
ensuite tapez &quot;a&quot; puis &quot;1&quot; pour la rendre bootable
</p>

<p>
Ensuite créez la partition pour le swap :
</p>
<pre class="code">Command (m for help): n
Command action
  e   extended
  p   primary partition (1-4)
p
Partition number (1-4): 2
First cylinder (1-3876, default 1): (Appuyez sur Entrée)
Using default value 1
Last cylinder or +size or +sizeM or +sizeK (1-3876, default 3876): +1024M</pre>

<p>
Enfin, tapez &quot;w&quot; pour terminer le partitionnement.
<p><div class="noteimportant">Attention, toutes les données du disque vont être supprimées.
</div></p>
</p>

<p>
Formatez la première partition en ext3 :
</p>
<pre class="code"> mke2fs -j /dev/sda1 </pre>

<p>
Formatez la deuxième partition en swap :
</p>
<pre class="code"> mkswap /dev/sda2 </pre>

<p>
Activez le swap :
</p>
<pre class="code"> swapon /dev/sda2 </pre>

<p>
Montez le sda1 sur le dossier install (à créer) qui servira de point de montage :
</p>
<pre class="code">mkdir /media/install
mount /dev/sda1 /media/install</pre>

</div>

<h2 class="sectionedit6" id="utilisation_de_debootstrap">utilisation de debootstrap</h2>
<div class="level2">

<p>
L&#039;installation est ici faite pour ubuntu precise 12.04 32bit.
</p>
<pre class="code">sudo debootstrap --include ubuntu-minimal --arch i386 precise /media/install http://archive.ubuntu.com/ubuntu</pre>

</div>

<h2 class="sectionedit7" id="montages_en_vue_d_un_chroot">Montages en vue d&#039;un chroot</h2>
<div class="level2">

<p>
Montages spéciaux pour accéder aux médias et autres périphériques.
</p>
<pre class="code">sudo mount --bind /dev /media/install/dev
sudo mount --bind /dev/pts /media/install/dev/pts
sudo mount --bind /sys /media/install/sys
sudo mount -t proc /proc /media/install/proc</pre>

</div>

<h2 class="sectionedit8" id="chroot">Chroot</h2>
<div class="level2">
<pre class="code">sudo chroot /media/install /bin/bash</pre>

</div>

<h2 class="sectionedit9" id="dans_le_chroot">Dans le chroot</h2>
<div class="level2">

</div>

<h3 class="sectionedit10" id="montage_dans_le_chroot">montage dans le chroot</h3>
<div class="level3">
<pre class="code">mount -a</pre>

</div>

<h2 class="sectionedit11" id="parametrage_de_apt">Paramétrage de apt</h2>
<div class="level2">

<p>
<a href="http://doc.ubuntu-fr.org/tutoriel/comment_modifier_sources_maj#modifier_le_fichier_des_sources" class="wikilink1" title="tutoriel:comment_modifier_sources_maj">Modifiez les sources</a> et ajoutez les dépôts universe et multiverse.
<p><div class="noteimportant">Attention, il faut modifier les sources du chroot et non celles de la machine hôte.
</div></p>
</p>
<pre class="code">apt-get update</pre>

</div>

<h3 class="sectionedit12" id="installation_des_locales">Installation des locales</h3>
<div class="level3">

<p>
Configuration du clavier.
</p>
<pre class="code">apt-get install console-data
dpkg-reconfigure console-data
dpkg-reconfigure keyboard-configuration</pre>

<p>
Installation des locales françaises et reconfiguration de celles-ci.
</p>
<pre class="code">/usr/share/locales/install-language-pack fr_FR</pre>
<pre class="code">dpkg-reconfigure locales</pre>

<p>
Configuration du lieu.
</p>
<pre class="code">dpkg-reconfigure tzdata</pre>

<p>
Configuration de l&#039;heure.
</p>
<pre class="code">hwclock --systohc --utc</pre>

<p>
Il faut mettre l&#039;heure en non utc :
</p>
<pre class="code">apt-get install nano</pre>
<pre class="code">nano /etc/default/rcS</pre>

<p>
Et mettre UTC=no
</p>

<p>
On sort du chroot :
</p>
<pre class="code">exit</pre>

</div>

<h2 class="sectionedit13" id="parametrage_de_hostname_et_fstab">Paramétrage de hostname et fstab</h2>
<div class="level2">

</div>

<h3 class="sectionedit14" id="copie_des_fichier_necessaires">Copie des fichier nécessaires</h3>
<div class="level3">

<p>
Copie des fichiers de configuration.
</p>
<pre class="code">sudo cp /etc/hosts /etc/hostname /etc/resolv.conf  /media/install/etc/hostname
sudo cp /etc/network/interfaces /media/install/etc/network
sudo cp /etc/fstab /media/install/etc</pre>
<pre class="code">sudo chroot  /media/install/ /bin/bash</pre>

<p>
Il faut trouver les UID de chaque partition afin de les mettre dans le fstab (le fstab se chargeant avant que les noms des disques et partitions (sda1, etc.) ne soient attribués, il faut lui donner le nom unique de la partition) :
</p>
<pre class="code">blkid</pre>
<pre class="code">nano /etc/fstab</pre>

<p>
voici un exemple ( à ne pas reprendre tel quel mais à adapter selon votre configuration) :
</p>
<pre class="code">proc                                      /proc           proc        defaults          0 0
UUID=34bf3784-2c97-48e3-92ce-025e3cd6344c /               ext4        errors=remount-ro 0 1
UUID=57a6f7ec-8de6-4f47-a244-f171c6a41ab3 /home           ext4        defaults          0 2
UUID=cfe0a0d6-3280-4104-878d-efede6cce024 none            swap        sw                0 0
/dev/cdrom                                 /cdrom   udf,iso9660 user,noauto       0 0
/dev/fd0                                  /media/floppy0  auto        rw,user,noauto    0 0</pre>

<p>
Ensuite, créez les points de montage :
</p>
<pre class="code">mkdir /cdrom /media/floppy0</pre>

</div>

<h2 class="sectionedit15" id="installer_le_kernel_et_grub">Installer le kernel et grub</h2>
<div class="level2">

<p>
Tout d’abord, nous installons le kernel.
<p><div class="noteimportant">Ici, le kernel installé est de type pae, pour les plus vielles machines installez un kernel non pae
</div></p>
</p>
<pre class="code">apt-get install linux-image-generic-pae</pre>

<p>
Ensuite, installation de grub : (grub s&#039;est probablement déjà installé avec le kernel)
</p>
<pre class="code">sudo apt-get install grub-pc
update-grub</pre>
<pre class="code">exit</pre>

<p>
Installation des backports :
</p>
<pre class="code">sudo cp /etc/kernel-img.conf /media/install/etc/kernel-img.conf
sudo chroot  /media/install/ /bin/bash
apt-get install linux-backports-modules-cw-3.3-precise-generic-pae</pre>

</div>

<h2 class="sectionedit16" id="mot_de_passe">mot de passe</h2>
<div class="level2">

<p>
Afin que tout le monde n&#039;ait pas accès aux droits root, il faut mettre un mot de passe.
</p>
<pre class="code">passwd</pre>

<p>
Voilà, ubuntu est installé.
</p>

<p>
Regardez aussi
<a href="../../../tasksel" class="wikilink1" title="tasksel">tasksel</a>
</p>

<p>
Sources externes :
</p>

<p>
<a href="http://www.isalo.org/wiki.debian-fr/index.php?title=Installation_squeeze_chroot_debootstrap" class="urlextern" title="http://www.isalo.org/wiki.debian-fr/index.php?title=Installation_squeeze_chroot_debootstrap"  rel="nofollow">http://www.isalo.org/wiki.debian-fr/index.php?title=Installation_squeeze_chroot_debootstrap</a>
</p>

<p>
<a href="http://www.gentoo.org/doc/fr/handbook/handbook-x86.xml" class="urlextern" title="http://www.gentoo.org/doc/fr/handbook/handbook-x86.xml"  rel="nofollow">http://www.gentoo.org/doc/fr/handbook/handbook-x86.xml</a>
</p>
<hr />

<p>
<em>Contributeur principal : <a href="http://doc.ubuntu-fr.org/utilisateurs/amj" class="wikilink1" title="utilisateurs:amj">amj</a>

- Mes remerciements à Shanx, S.O.D. et Arya
</p>

</div>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/1/1ee8aa38b48a7149bb026bba4a778d81.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="../../../index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=edit&amp;rev=0"  class="action source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]">Afficher le texte source</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/amj/brouillons/debootstrap?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="../../../wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="../../../documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
