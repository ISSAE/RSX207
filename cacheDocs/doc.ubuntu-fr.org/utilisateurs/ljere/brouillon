<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>utilisateurs:ljere:brouillon - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2009-12-23T00:16:00+0100"/>
<meta name="keywords" content="hardy,jaunty,reseau,brouillon"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="../../index.html"/>
<link rel="contents" href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="http://doc.ubuntu-fr.org/feed.php?mode=list&amp;ns=utilisateurs:ljere"/>
<link rel="alternate" type="text/html" title="HTML brut" href="http://doc.ubuntu-fr.org/_export/xhtml/utilisateurs/ljere/brouillon"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="http://doc.ubuntu-fr.org/_export/raw/utilisateurs/ljere/brouillon"/>
<link rel="canonical" href="brouillon"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='utilisateurs:ljere';var JSINFO = {"id":"utilisateurs:ljere:brouillon","namespace":"utilisateurs:ljere"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="brouillon#main" tabindex="1">Contenu</a> | <a href="brouillon#qsearch__in" tabindex="2">Rechercher</a> | <a href="brouillon#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="../../index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="brouillon" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="brouillon" >utilisateurs:ljere:brouillon</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table des matières</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="brouillon#introduction">Introduction</a></div></li>
<li class="level1"><div class="li"><a href="brouillon#partage_simple">Partage simple</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="brouillon#cote_serveur">Côté serveur</a></div></li>
<li class="level2"><div class="li"><a href="brouillon#cote_client">Côté client</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="brouillon#partage_en_ligne_de_commande">Partage en ligne de commande</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="brouillon#cote_serveur1">Côté serveur</a></div></li>
<li class="level2"><div class="li"><a href="brouillon#cote_client1">Côté client</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="brouillon#partage_en_utilisant_webmin">Partage en utilisant webmin</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="brouillon#cote_serveur2">Côté serveur</a></div></li>
<li class="level2"><div class="li"><a href="brouillon#cote_client2">Côté client</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="brouillon#autofs">Autofs</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="brouillon#objectifs">Objectifs</a></div></li>
<li class="level2"><div class="li"><a href="brouillon#installation1">Installation</a></div></li>
<li class="level2"><div class="li"><a href="brouillon#configuration1">Configuration</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="brouillon#serveur_en_dhcp">Serveur en DHCP</a></div></li>
<li class="level1"><div class="li"><a href="brouillon#configuration_du_pare-feu">Configuration du Pare-feu</a></div></li>
<li class="level1"><div class="li"><a href="brouillon#configuration_d_un_client_windows">Configuration d&#039;un client Windows</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="page_brouillon">Page Brouillon</h1>
<div class="level1">

<p>
<p><div class="noteclassic">Cette page est issue d&#039;une <a href="../../nfs?rev=1258038788" class="urlextern" title="http://doc.ubuntu-fr.org/nfs?rev=1258038788"  rel="nofollow">ancienne révision de la page NFS</a>
</div></p>
</p>
<hr />
<div class="tags"><span>
	<a href="../../hardy" class="wikilink1" title="hardy" rel="tag">Hardy</a>,
	<a href="../../jaunty" class="wikilink1" title="jaunty" rel="tag">Jaunty</a>,
	<a href="../../reseau" class="wikilink1" title="reseau" rel="tag">réseau</a>,
	<a href="../../brouillon" class="wikilink1" title="brouillon" rel="tag">brouillon</a>
</span></div>
<hr />
<blockquote><div class="no">
à revoir (versions oboslètes + mise en forme)</div></blockquote>

</div>

<h1 class="sectionedit2" id="nfsnetwork_file_system_-_le_partage_reseau_sous_linux">NFS : Network File System - le partage réseau sous Linux</h1>
<div class="level1">

<p>
Nouvelle page ici: <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/disque_reseau" class="wikilink2" title="utilisateurs:ljere:disque_reseau" rel="nofollow">disque_reseau</a>
</p>

<p>
Mise en oeuvre d&#039;un cas concrèt de <a href="http://doc.ubuntu-fr.org/partage_familial" class="wikilink2" title="partage_familial" rel="nofollow">partage familial</a> entre trois ordinateurs
</p>

</div>

<h2 class="sectionedit3" id="introduction">Introduction</h2>
<div class="level2">

<p>
<abbr title="Network File System">NFS</abbr> est l&#039;abréviation de <strong>Network File System</strong>, c&#039;est-à-dire  un <a href="../../systeme_de_fichiers" class="wikilink1" title="systeme_de_fichiers">système de fichiers</a> utilisable sur un réseau.
</p>

<p>
<abbr title="Network File System">NFS</abbr> est utilisé pour partager des données entre systèmes UNIX. Pour le partage avec d&#039;autres systèmes, se référer à la page traitant des <a href="../../partage" class="wikilink1" title="partage">partages de dossiers, de connexion et d&#039;imprimante</a>.
</p>

<p>
Cette documentation fait la distinction entre :
</p>
<ul>
<li class="level1"><div class="li"> Le <strong>partage simple</strong>, c&#039;est a dire le partage des données sur un réseau local en utilisant autant que possible le mode graphique de Ubuntu.</div>
</li>
<li class="level1"><div class="li"> Le <strong>partage en ligne de commande</strong>, centré sur la part technique, par exemple pour monter un serveur de fichier destiné à fournir des données pour un réseau d&#039;entreprise.</div>
</li>
<li class="level1"><div class="li"> Et le <strong>partage en utilisant webmin</strong> qui propose une méthode utilisable à distance.</div>
</li>
</ul>

<p>
Pour ces opérations, il vous faudra connaître l&#039;adresse IP des postes respectifs. On peut la trouver sous Système → Administration → Réseau → Propriétés ou en ligne de commande en tapant ifconfig. 
</p>

</div>

<h2 class="sectionedit4" id="partage_simple">Partage simple</h2>
<div class="level2">

<p>
Le partage en utilisant l&#039;interface graphique fournie avec Ubuntu est divisé en deux partie :
* <strong>coté serveur</strong> ce qu&#039;il faut faire sous ubuntu pour partager des données selon le protocole <abbr title="Network File System">NFS</abbr>.
* <strong>Côté client</strong> ce qu&#039;il faut faire pour accéder a des données partagés en <abbr title="Network File System">NFS</abbr> avec ubuntu.
</p>

</div>

<h3 class="sectionedit5" id="cote_serveur">Côté serveur</h3>
<div class="level3">

</div>

<h4 id="option_de_partage_du_dossier">Option de partage du dossier</h4>
<div class="level4">

<p>
<p><div class="notewarning"><strong></strong>
sur Ubuntu 9.04 ce partage via le dossier ne concerne que samba avec nautilus-share. Paragraphe à déplacer dans &quot;partage par Samba&quot;

</div></p>
À partir de la version Hardy d&#039;Ubuntu, un clic droit sur le dossier permet d&#039;accéder à un menu <strong>Options de partage</strong>.
</p>

<p>
Dans ce menu il suffit de cocher <strong>Partager ce dossier</strong> pour activer le partage. 
</p>

<p>
Ce système de partage se base sur les nom et mot de passe des utilisateurs locaux, donc
</p>
<ul>
<li class="level1"><div class="li"> le nom et mot de passe de l&#039;utilisateur créateur du partage permettent un accès complet</div>
</li>
<li class="level1"><div class="li"> le nom des autres utilisateurs donne un accès restreint, en lecture seule ou avec l&#039;écriture si on sélectionne la case correspondante</div>
</li>
<li class="level1"><div class="li"> pour les autres on choisit ou non d&#039;activer <code>l&#039;accès d&#039;évaluation</code>.</div>
</li>
</ul>

</div>

<h4 id="dossier_partage">Dossier partagé</h4>
<div class="level4">

<p>
Avant Hardy la procédure graphique passe par le menu dédié <strong>Dossiers partagés</strong> qui correspond à la commande <code>shares-admin</code>. 
</p>

<p>
On doit y renseigner le fichier à partager, le protocole à utiliser, et les droits d&#039;accès qu&#039;on lui accorde : 
</p>
<ul>
<li class="level1"><div class="li"> Ouvrir <strong>Système → Administration → Dossiers partagés</strong> ou dans <strong>Réglage du système → Partage</strong>. (Ce menu nécessite un mot de passe car il s&#039;agit d&#039;une tache d&#039;administration.)</div>
</li>
</ul>

<p>
<p><div class="noteimportant">À partir de Hardy Heron, Ubuntu 8.04 :
L&#039;interface graphique ne se trouve plus par défaut dans le menu Système → Administration, mais reste accessible soit par ALT+F2 soit par un terminal, en saisissant la commande <code>shares-admin</code>. Sinon utilisez webmin (cf &quot;Partage en utilisant webmin&quot;).
</div></p>
</p>

<p>
<p><div class="noteclassic"> Si vous ouvrez le gestionnaire de partage pour la première fois (ou si vous n&#039;avez pas installé le serveur <abbr title="Network File System">NFS</abbr> manuellement), Ubuntu vous indique qu&#039;il est nécessaire d&#039;installer les paquets de serveur pour continuer. Si les paquets ne sont pas installés, faites-le en cochant les cases appropriées et cliquez sur <strong>Appliquer</strong>. Pour le faire manuellement : <a href="../../tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installez les paquets</a> <strong>nfs-common,nfs-kernel-server</strong> <a href="apt://nfs-common" class="urlextern" title="apt://nfs-common"  rel="nofollow">apt://nfs-common</a> <a href="apt://nfs-kernel-server" class="urlextern" title="apt://nfs-kernel-server"  rel="nofollow">apt://nfs-kernel-server</a>
</div></p>
</p>

<p>
Dans le gestionnaire de partage se trouvent 3 boutons à droite pour gérer les partages : <strong>Ajouter</strong> qui permet de créer un nouveau partage ; <strong>Propriétés</strong> qui permet de modifier les paramètres du partage sélectionné ; et <strong>Supprimer</strong> qui permet de supprimer le partage sélectionné.
</p>
<ul>
<li class="level1"><div class="li"> Cliquer sur <strong>Ajouter</strong> pour ajouter un partage et choisir le dossier a partager</div>
</li>
</ul>

<p>
<p><div class="notewarning"><strong></strong>
Comme dans toute syntaxe *nix, certains caractères dans les noms de fichiers sont interdits, ce sont par exemple le /, les parenthèses (), l&#039;espace ou *. Vous ne devez donc pas utiliser d&#039;espaces dans le nom de vos dossiers (/home/moi/Mon Dossier) mais plutôt /home/moi/MonDossier
</div></p>
</p>
<ul>
<li class="level1"><div class="li"> Cliquer sur <strong><abbr title="Network File System">NFS</abbr></strong> (pour sélectionner un mode de partage).</div>
</li>
</ul>

<p>
Le partage <strong><abbr title="Network File System">NFS</abbr></strong> est sécurisé par les autorisations d&#039;accès que l&#039;on accorde. Par défaut il n&#039;y en a pas, il faut donc les ajouter.
</p>

<p>
C&#039;est l&#039;encart en bas de la fenêtre qui répertorie les hôtes autorisés à accéder à ce dossier.
</p>
<ul>
<li class="level1"><div class="li"> Cliquez sur <strong>Ajouter hôte</strong> et ajouter les autorisations que vous souhaitez lui accorder.</div>
</li>
</ul>

<p>
Dans la nouvelle fenêtre qui vient de s&#039;ouvrir, vous pouvez choisir d&#039;autoriser une adresse IP (Par exemple l&#039;adresse IP <code>192.168.0.100</code>) où tout le réseau local en utilisant le bouton &quot;Saisissez le nom du réseau&quot; (l&#039;adresse la plus courante pour ce faire et 192.168.0.0 avec le masque de sous réseau 255.255.255.0)
</p>

<p>
Après avoir validé trois fois, (pour enregistrer cet hôte, pour sauvegarder les paramètres de partage, et pour activer les dossiers partagés) les dossiers sélectionnés sont partagés avec les permissions que vous leur avez octroyées.
</p>

<p>
Dans certain cas il peut être nécessaire de redémarrer l&#039;ordinateur pour que le partage soit actif.
</p>

</div>

<h4 id="cas_particulier_et_probleme">Cas particulier et problème</h4>
<div class="level4">

<p>
* Si vous avez mis en place un pare-feu, il est important qu&#039;il soit configuré pour laisser passer les communication <abbr title="Network File System">NFS</abbr>. Voir plus bas la section &quot;Configuration du Pare-feu&quot; pour plus de détails.
</p>

<p>
* Si le serveur répond : <strong>permission denied</strong> , il est possible qu&#039;il faille 
<a href="../../tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditer le fichier</a> <strong>/etc/exports</strong> sur le pc serveur, 
</p>
<pre class="file">/home/ols/Shared_Linux  192.168.0.100(rw)</pre>

<p>
en :
</p>
<pre class="file">/home/ols/Shared_Linux  192.168.0.100/255.255.255.0(rw)</pre>

<p>
et ensuite redémarrer le service <abbr title="Network File System">NFS</abbr> :
</p>
<pre class="code">sudo /etc/init.d/nfs-kernel-server restart</pre>

</div>

<h3 class="sectionedit6" id="cote_client">Côté client</h3>
<div class="level3">

<p>
Pour se connecter à un partage <abbr title="Network File System">NFS</abbr> :
</p>
<ul>
<li class="level1"><div class="li"> Le poste client doit avoir le paquet <strong>nfs-common</strong> (<a href="apt://nfs-common" class="media" title="apt://nfs-common"  rel="nofollow"><img src="http://doc.ubuntu-fr.org/_media/utilisateurs/ljere/apt.png" class="media" alt="" /></a>) pour pouvoir accéder au dossier partagé. </div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Et il faut définir un point de montage pour qu&#039;il puisse le présenter a l&#039;utilisateur.</div>
</li>
</ul>

<p>
<p><div class="notewarning">A Savoir, il n&#039;est actuellement pas possible de partager des ressources sur une partition NTFS via <abbr title="Network File System">NFS</abbr>… (sauf si le serveur comportant ce NTFS est windows)
</div></p>
</p>

<p>
Voici un méthode pour créer un point de montage :
</p>
<ul>
<li class="level1"><div class="li"> Ouvrez un <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/terminal" class="wikilink2" title="utilisateurs:ljere:terminal" rel="nofollow">terminal</a></div>
</li>
<li class="level1"><div class="li"> Créez un dossier où le dossier partagé va être monté (dans mon cas) :</div>
</li>
</ul>
<pre class="code">sudo mkdir /media/nfs</pre>

<p>
<p><div class="notetip">N&#039;hésitez pas à donner un nom plus parlant, surtout si vous avez plusieurs partages <abbr title="Network File System">NFS</abbr>.
</p>

<p>
Mais n&#039;oubliez surtout pas de changer aussi la suite en conséquence !
</div></p>
</p>
<ul>
<li class="level1"><div class="li"> <a href="../../tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">Ouvrez le fichier</a> <strong>/etc/fstab</strong></div>
</li>
<li class="level1"><div class="li"> Ajoutez une ligne comme celle-ci à la fin du fichier (dans mon cas) :</div>
</li>
</ul>
<pre class="code">192.168.0.101:/home/ols/Shared_Linux	/media/nfs	nfs	user,noauto	0	0</pre>

<p>
Pour connaître l&#039;adresse IP du serveur, vous pouvez scruter les ordinateurs du réseau :
</p>
<pre class="code"> arp -a</pre>

<p>
<p><div class="notehelp"><em><em class="u">Explications:</em></em> Les deux premiers champs sont à adapter en fonction de vos réglages. La première partie (<code>192.168.0.101:/…./Shared_Linux</code>) indique l&#039;adresse IP du serveur suivie du dossier partagé. La seconde partie (<code>/media/nfs</code>) indique le point de montage que vous venez de créer plus haut.
</p>

<p>
la suite: est commune à toutes les configurations.
</p>

<p>
Vous pouvez tout de même enlever <code>noauto</code> dans la partie <code>user</code> pour que le dossier partagé soit monté automatiquement au démarrage.
</div></p>
</p>
<ul>
<li class="level1"><div class="li"> Sauvegardez le fichier.</div>
</li>
<li class="level1"><div class="li"> Allez maintenant dans le poste de travail (si vous n&#039;avez pas enlevé <code>,noauto</code>), dans le menu <strong>Raccourcis ⇒ Poste de travail</strong>. </div>
</li>
<li class="level1"><div class="li"> Vous y trouverez une icône <code>nfs</code> (ou autre suivant le point de montage que vous avez défini). Double-cliquez sur cet icône pour accéder au répertoire partagé sur l&#039;autre machine.</div>
</li>
<li class="level1"><div class="li"> Si le répertoire partagé n&#039;apparaît pas, lancer la commande suivante dans un <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/terminal" class="wikilink2" title="utilisateurs:ljere:terminal" rel="nofollow">terminal</a>:</div>
</li>
</ul>
<pre class="code">sudo mount -a</pre>

</div>

<h2 class="sectionedit7" id="partage_en_ligne_de_commande">Partage en ligne de commande</h2>
<div class="level2">

<p>
Le partage de dossier sur un serveur de fichier avec <abbr title="Network File System">NFS</abbr>, tel que décrit ici, se fait en utilisant la ligne de commande et en se préoccupant des problèmes de droit d&#039;accès.
</p>

</div>

<h3 class="sectionedit8" id="cote_serveur1">Côté serveur</h3>
<div class="level3">

</div>

<h4 id="installation">Installation</h4>
<div class="level4">

<p>
Avant toutes choses, il est nécessaire d&#039;<a href="../../tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer le paquet</a> <strong>nfs-kernel-server</strong>:
</p>
<pre class="code">sudo apt-get install nfs-kernel-server</pre>

</div>

<h4 id="configuration">Configuration</h4>
<div class="level4">

<p>
Ensuite, nous allons définir les dossiers à partager. Toutes les informations concernant le partage de dossier pour <abbr title="Network File System">NFS</abbr> se trouvent dans le fichier <strong>/etc/exports</strong>.
</p>

<p>
<a href="../../tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">Éditez le fichier</a> <strong>/etc/exports</strong>
</p>

<p>
Dans ce fichier, chaque ligne est définie comme ceci :
</p>
<pre class="code"> &lt;dossier partagé&gt; &lt;hôte&gt;(&lt;options&gt;) &lt;hôte2&gt;(&lt;options&gt;)...</pre>

<p>
Les informations se trouvant sur une ligne sont les suivantes :
</p>
<ul>
<li class="level1"><div class="li"> <strong>&lt;dossier partagé&gt;</strong> : chemin menant au dossier partagé.</div>
</li>
<li class="level1"><div class="li"> <strong>&lt;hôte&gt;</strong> : indique quel est l&#039;hôte qui peut accéder à ce partage, l&#039;hôte peut être définit de plusieurs manières :</div>
<ul>
<li class="level2"><div class="li"> une IP : on indique simplement l&#039;adresse IP de la machine pouvant accéder à ce partage.</div>
</li>
<li class="level2"><div class="li"> un nom d&#039;hôte : on indique le nom complet de l&#039;hôte (pour peu qu&#039;il soit connu du système au travers d&#039;un <abbr title="Domain Name System">DNS</abbr> ou du fichier <code>hosts</code>).</div>
</li>
<li class="level2"><div class="li"> un nom de groupe réseau NIS (NIS netgroup) qui s&#039;indique sous la forme <code>@&lt;netgroup&gt;</code>.</div>
</li>
<li class="level2"><div class="li"> un domaine avec un joker qui indique les machines d&#039;un domaine ou sous-domaine; par exemple : <code>*.ubuntu-fr.org</code>.</div>
</li>
<li class="level2"><div class="li"> un intervalle d&#039;IP avec le masque de sous-réseau; par exemple : <code>192.168.0.0/24</code> ou <code>192.168.0.*</code></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <strong><code>&lt;options&gt;</code></strong> : indique les options de partage; nous n&#039;allons pas parcourir toutes les options ensemble mais uniquement les plus importantes.</div>
<ul>
<li class="level2"><div class="li"> <strong>rw</strong> : permet la lecture et l&#039;écriture sur un partage pour l&#039;hôte défini (par défaut, les partages sont en mode <code>ro</code>; c&#039;est-à-dire en lecture seule).</div>
</li>
<li class="level2"><div class="li"> <strong>async</strong> : permet au serveur <abbr title="Network File System">NFS</abbr> de violer le protocole <abbr title="Network File System">NFS</abbr> et de répondre au requête avant que les changements effectués par la requête aient été appliqués sur l&#039;unité de stockage. Cette option améliore les performances mais a un coût au niveau de l&#039;intégrité des données (données corrompues ou perdues) en cas de redémarrage non-propre (par exemple en cas de crash système).</div>
</li>
<li class="level2"><div class="li"> <strong>sync</strong> : est le contraire de <code>async</code>. Le serveur <abbr title="Network File System">NFS</abbr> respecte le protocole <abbr title="Network File System">NFS</abbr>.</div>
</li>
<li class="level2"><div class="li"> <strong>root_squash</strong> : force le <em>mapping</em> de l&#039;utilisateur <code>root</code> vers l&#039;utilisateur anonyme (option par défaut).</div>
</li>
<li class="level2"><div class="li"> <strong>no_root_squash</strong> : n&#039;effectue pas de <em>mapping</em> pour l&#039;utilisateur <code>root</code>.</div>
</li>
<li class="level2"><div class="li"> <strong>all_squash</strong> : force le <em>mapping</em> de tous les utilisateurs vers l&#039;utilisateur anonyme.</div>
</li>
<li class="level2"><div class="li"> <strong>anonuid</strong> : indique au serveur <abbr title="Network File System">NFS</abbr> l&#039;UID de l&#039;utilisateur anonyme (considéré comme tel dans les précédentes options de <em>mapping</em>).</div>
</li>
<li class="level2"><div class="li"> <strong>anongid</strong> : indique au serveur <abbr title="Network File System">NFS</abbr> le GID de l&#039;utilisateur anonyme (considéré comme tel dans les précédentes options de <em>mapping</em>).</div>
</li>
</ul>
</li>
</ul>

<p>
Voyons quelques exemples…
</p>

<p>
Nous souhaitons exporter un répertoire <code>/srv/archive</code> pour le réseau local (<code>192.168.0.0/24</code>) en lecture seule, en optimisant les performances (sur un répertoire en lecture seule, on peut se le permettre). Nous indiquons la ligne suivante dans le fichier <code>/etc/exports</code> :
</p>
<pre class="code">/srv/archive 192.168.0.0/24(ro,async)</pre>

<p>
Nous souhaitons exporter un répertoire <code>/srv/temp_add</code> pour un hôte particulier (<code>lab05.ubuntu-fr.org</code>) en lecture/écriture et tous les utilisateurs sont considérés comme l&#039;utilisateur <code>nfsshare</code> (UID : <code>5000</code>, GID : <code>5000</code>). L&#039;hôte <code>lab02.ubuntu-fr.org</code> peut également y accéder mais seulement en lecture seule. Nous indiquons la ligne suivante dans le fichier <code>/etc/exports</code> :
</p>
<pre class="code">/srv/temp_add lab05.ubuntu-fr.org(rw,all_squash,anonuid=5000,anongid=5000,sync) lab02.ubuntu-fr.org(ro,sync)</pre>

<p>
Vous obtiendrez tous les détails concernant les options <abbr title="Network File System">NFS</abbr> dans les manpages (<code>man exports</code>).
</p>

<p>
Remarquez que, si vous n&#039;utilisez pas <code>all_squash</code>, l&#039;UID de l&#039;utilisateur de la machine cliente sera utilisé sur la machine serveur. Ce qui signifie que, soit vous avez des fichiers <code>/etc/passwd</code> et <code>/etc/group</code> identiques (ce qui est encore possible dans un petit parc informatique), soit vous utilisez un serveur d&#039;identité comme NIS afin d&#039;avoir les mêmes UID/GID partout.
</p>

</div>

<h4 id="mise_en_route">Mise en route</h4>
<div class="level4">

<p>
Ouvrez un <strong><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/terminal" class="wikilink2" title="utilisateurs:ljere:terminal" rel="nofollow">terminal</a></strong>,
</p>

<p>
Il ne vous reste plus qu&#039;à démarrer votre nouveau serveur de fichier avec la commande :
</p>
<pre class="code">sudo /etc/init.d/nfs-kernel-server start</pre>

<p>
Lorsque vous modifiez le fichier de configuration, n&#039;oubliez pas d&#039;entrer la commande suivante pour le recharger :
</p>
<pre class="code">sudo /etc/init.d/nfs-kernel-server reload</pre>

<p>
Pour redémarrer le serveur <abbr title="Network File System">NFS</abbr> complètement, vous devez utiliser cette commande:
</p>
<pre class="code">sudo /etc/init.d/nfs-kernel-server restart</pre>

</div>

<h4 id="considerations_securitaires">Considérations sécuritaires</h4>
<div class="level4">

<p>
<abbr title="Network File System">NFS</abbr> n&#039;est pas réputé pour être totalement sécurisé. Il est conseillé d&#039;éviter de partager des informations avec <abbr title="Network File System">NFS</abbr> au travers de l&#039;Internet. Pour sécuriser les accès, vous avez le choix entre plusieurs possibilités :
</p>
<ul>
<li class="level1"><div class="li"> Accès uniquement sur le réseau local</div>
<ul>
<li class="level4"><div class="li"> Une première méthode consiste à modifier vos fichier <code>/etc/hosts.deny</code> et <code>/etc/hosts.allow</code>. Cette méthode simple est expliquée dans les manpages (<code>man hosts_access</code>).</div>
</li>
<li class="level4"><div class="li"> Une seconde méthode (ma favorite) consiste à configurer un firewall avec <code>iptables</code> pour éviter les accès non-autorisés. Je préfère cette solution car elle permet de traiter tous les services et accès (y compris <code>ping</code>, suivi de connexions, etc.). Les ports utilisés par <abbr title="Network File System">NFS</abbr> sont le <code>111</code> et le <code>2049</code> (en <code>udp</code> et <code>tcp</code>). </div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Accès externes</div>
<ul>
<li class="level4"><div class="li"> Le mieux est d&#039;utiliser un tunnel <abbr title="Virtual Private Network">VPN</abbr>, crypté et sécurisé, qui fera de votre machine distante une machine de votre réseau local.</div>
</li>
</ul>
</li>
</ul>

</div>

<h3 class="sectionedit9" id="cote_client1">Côté client</h3>
<div class="level3">

<p>
Il faut commencer par <a href="../../tutoriel/comment_installer_un_paquet" class="wikilink1" title="tutoriel:comment_installer_un_paquet">installer le paquet</a> <strong>nfs-common</strong> :
</p>
<pre class="code">sudo apt-get install nfs-common</pre>

<p>
Pour les connexions clientes sur des machines de bureau, vous pouvez utiliser la méthode décrite dans la section précédente.
</p>

<p>
Si vous devez effectuer des liens <abbr title="Network File System">NFS</abbr> entre différents serveurs, voici quelques précisions concernant les montages <abbr title="Network File System">NFS</abbr>.
</p>

<p>
Pour monter un partage <abbr title="Network File System">NFS</abbr>, vous avez besoin d&#039;un répertoire vide qui servira de point de montage. En général (et de préférence), les points de montage se trouvent dans <code>/media</code>, mais ces points de montage peuvent se trouver n&#039;importe où dans votre arborescence root (<code>/</code>).
</p>

<p>
Pour monter un système de fichier <abbr title="Network File System">NFS</abbr> manuellement, vous utiliserez la commande suivante :
</p>
<pre class="code">sudo mount -t nfs &lt;ip_serveur&gt;:&lt;rep_serveur&gt; &lt;point_montage_local&gt;</pre>

<p>
Ce qui donne par exemple :
</p>
<pre class="code">sudo mount -t nfs 192.168.0.40:/home/brol /media/nfs</pre>

<p>
Certaines options peuvent être passées à la commande <code>mount</code> lors du montage. Les options les plus intéressantes sont les suivantes :
</p>
<ul>
<li class="level1"><div class="li"> <code>ro</code> : monte le système de fichier en lecture seule.</div>
</li>
<li class="level1"><div class="li"> <code>rw</code> : monte le système de fichier en lecture/écriture.</div>
</li>
<li class="level1"><div class="li"> <code>hard</code> : si le serveur n&#039;est pas accessible, le noyau place les processus en attente de la ressource en attente.</div>
</li>
<li class="level1"><div class="li"> <code>soft</code> : si le serveur est inaccessible, on attend le timeout avant de générer une erreur de lecture/écriture aux processus impactés.</div>
</li>
<li class="level1"><div class="li"> <code>timeo=XXX</code> : indique le timeout (en mode <code>soft</code>) en secondes (maximum = <code>60sec</code>).</div>
</li>
</ul>

<p>
Ces options se passent via l&#039;argument <code>-o</code> de la commande <code>mount</code>; par exemple :
</p>
<pre class="code">sudo mount -t nfs -o ro,soft,timeo=10 192.168.0.40:/home/brol /media/nfs</pre>

<p>
Pour démonter le système de fichier, vous pouvez utilisez la commande suivante :
</p>
<pre class="code">sudo umount &lt;point_montage_local&gt;</pre>

<p>
Pour monter le serveur de fichier au démarrage de la machine, vous pouvez ajouter une ligne ressemblant à celle-ci dans le fichier <code>/etc/fstab</code> :
</p>
<pre class="code">&lt;ip_serveur&gt;:&lt;rep_serveur&gt; &lt;point_montage_local&gt; nfs &lt;options&gt; 0 0</pre>

<p>
Par exemple :
</p>
<pre class="code">192.168.0.40:/home/brol	/media/nfs	nfs	ro	0	0</pre>

</div>

<h4 id="erreurs">Erreurs</h4>
<div class="level4">

<p>
Le message classique en cas d&#039;erreur au moment du mount du coté client est 
</p>
<pre class="code">mount RPC : le programme n&#039;est pas enregistré</pre>

<p>
Cela ne signifie pas qu&#039;il y a une erreur du coté client.
Cela peut-être dû (coté serveur) à une mauvaise définition du client autorisé à se connecter comme défini dans le fichier /etc/exports. Vérifier que l&#039;hôte-client est correctement identifié.
En cas de doute remplacer le nom d&#039;un client par son Ip.<br/>

Cela peut-être (toujours du coté serveur) dû à une restriction sur les hôtes-clients dans /etc/hosts.deny (qui indique quel programme doit refuser quel hote) qui n&#039;est pas contrebalancée par une permission dans /etc/hosts.allow (qui indique quel client à néanmoins le droit d&#039;outrepasser les interdictions du hosts.deny)<br/>

Pour plus de lisibilité utiliser de manière préférentielle les Ip de vos clients. Soit une par une (petit nombre) ou à l&#039;aide du couple Adresse/Masque (grand nombre)
</p>

<p>
Un exemple de configuration des fichiers hosts.allow et hosts.deny est donnée ici :
</p>
<pre class="code">SUR LE SERVEUR SEULEMENT
il faut ajouter les lignes suivantes (minimum vital):

Fichier hosts.deny
#Interdire tout le monde sur les services portmap, nfsd et mountd
portmap:ALL
nfsd:ALL
mountd:ALL

Fichier hosts.allow
#Accepter néanmoins les &lt;machine-liste&gt; sur les services portmap, nfsd et mountd
#Exemple de &lt;machine&gt; 192.168.0.50 , une seule machine.
#Autre exemple 192.168.0.0/255.255.255.0 , toutes les machines de 192.168.0.1 à 192.168.0.254
portmap:&lt;machine_liste&gt;
nfsd:&lt;machine_liste&gt;
mountd:&lt;machine_liste&gt;</pre>

<p>
Ensuite il ne reste plus qu&#039;à recharger les configs pour le démon nfs :
</p>
<pre class="code">sudo /etc/init.d/nfs-kernel-server reload</pre>
<pre class="code">Autre erreur : Accés refusé.</pre>

<p>
Vérifiez que tous les services nécessaires sont démarrés (coté serveur) grâce à la commande
</p>
<pre class="code">rpcinfo -p</pre>

<p>
Vous devez obtenir une liste qui comprend au moins un exemplaire de chacun de ces services :
</p>
<pre class="code">tcp    111  portmapper
udp    942  status
udp    752  mountd
udp   2049  nfs
udp  32799  nlockmgr</pre>

<p>
Si ce n&#039;est pas le cas, relancer le script de démarrage (start) de nfs comme expliqué plus haut.<br/>

Pour plus d&#039;informations concernant les options de montage, vous pouvez consulter les manpages de <abbr title="Network File System">NFS</abbr> (<code>man nfs</code>).
</p>

</div>

<h2 class="sectionedit10" id="partage_en_utilisant_webmin">Partage en utilisant webmin</h2>
<div class="level2">

<p>
- Simple, marche sur toutes les distributions et administrable à distance -
</p>

</div>

<h3 class="sectionedit11" id="cote_serveur2">Côté serveur</h3>
<div class="level3">

<p>
Installez <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/webmin" class="wikilink2" title="utilisateurs:ljere:webmin" rel="nofollow">webmin</a> (téléchargez le paquet debian sur <a href="http://www.webmin.com" class="urlextern" title="http://www.webmin.com"  rel="nofollow">http://www.webmin.com</a>) et les paquets <strong><a href="apt://nfs-common" class="urlextern" title="apt://nfs-common"  rel="nofollow">nfs-common</a> <a href="apt://nfs-kernel-server" class="urlextern" title="apt://nfs-kernel-server"  rel="nofollow">nfs-kernel-server</a></strong>
</p>
<ul>
<li class="level1"><div class="li"> Connectez vous sur <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/webmin" class="wikilink2" title="utilisateurs:ljere:webmin" rel="nofollow">webmin</a> (ex : <a href="https://127.0.0.1:10000" class="urlextern" title="https://127.0.0.1:10000"  rel="nofollow">https://127.0.0.1:10000</a> ).</div>
</li>
<li class="level1"><div class="li"> Allez dans &quot;Un-used Modules&quot;, &quot;<abbr title="Network File System">NFS</abbr> Exports&quot; et &quot;Add a new export&quot;.</div>
</li>
<li class="level1"><div class="li"> Pour la version 1.430 de webmin (Août 2008), il faut aller dans &quot;Networking&quot; au lieu de &quot;Un-used Modules&quot;.</div>
</li>
<li class="level1"><div class="li"> Renseignez &quot;Directory to export&quot;, si besoin cocher &quot;Read-only?&quot; &quot;No&quot;.</div>
</li>
<li class="level1"><div class="li"> Cliquer sur &quot;Save&quot; puis &quot;Apply changes&quot;</div>
</li>
</ul>

</div>

<h3 class="sectionedit12" id="cote_client2">Côté client</h3>
<div class="level3">

<p>
Installez<strong> <a href="apt://nfs-common" class="urlextern" title="apt://nfs-common"  rel="nofollow">nfs-common</a></strong>, et voir la partie &quot;Partage Simple&quot; → &quot;Côté client&quot; ou, mieux, &quot;Autofs&quot; (ci-après).
</p>

<p>
Attention cependant, par défaut Webmin monte le partage sur le serveur dans <em>/export</em>.
</p>

<p>
Ainsi le partage de <em>/home/dossier_mis_en_partage</em> sera accessible par le client en tant que <em>/export/dossier_mis_en_partage</em>. Ignorer ceci entraîne la réponse suivante à un <em>mount</em>:
</p>
<pre class="code">nath@nath-minix:~$ sudo mount -t nfs 192.168.0.1:/home/Multimedia /media/nfs
[sudo] password for nath: 
mount.nfs: access denied by server while mounting (null)
nath@nath-minix:~$ </pre>

</div>

<h2 class="sectionedit13" id="autofs">Autofs</h2>
<div class="level2">

</div>

<h3 class="sectionedit14" id="objectifs">Objectifs</h3>
<div class="level3">

<p>
Le montage manuel ou par fstab a plusieurs inconvénients.
Le principal, c&#039;est qu&#039;il n&#039;est pas toujours possible de rendre le montage automatique. Pourtant, si vous ne spécifiez pas &quot;noauto&quot; dans les options de montage dans /etc/fstab, il est sensé être automatique. Mais si lors du montage vous n&#039;êtes pas encore connecté (en wifi par exemple), et bien le montage ne se fait pas, et il faut effectuer le montage manuellement. Et dans tous les cas, le démontage aussi.
Un autre inconvénient, moins important, est que même si vous n&#039;utilisez pas les dossiers montés, ils restent montés et consomment des ressources.
</p>

<p>
<strong>autofs</strong> permet de résoudre ces 2 problèmes.
</p>

</div>

<h3 class="sectionedit15" id="installation1">Installation</h3>
<div class="level3">

<p>
Installez le paquet <strong>autofs</strong> <a href="apt://autofs" class="media" title="apt://autofs"  rel="nofollow"><img src="http://doc.ubuntu-fr.org/_media/utilisateurs/ljere/apt.png" class="media" alt="" /></a>
</p>

</div>

<h3 class="sectionedit16" id="configuration1">Configuration</h3>
<div class="level3">

<p>
Tout d&#039;abord, supprimez (ou commentez) dans <em>/etc/fstab</em> les montages que vous voulez gérer par <strong>autofs</strong> (si vous en aviez écrit auparavant).
</p>

<p>
Ensuite, éditez <em>/etc/auto.master</em>, pour y ajouter la ligne :
</p>
<pre class="code">/net    /etc/auto.nfs --ghost,--timeout=30</pre>

<p>
<p><div class="noteclassic">Quelques explications : le fichier auto.master peut contenir plusieurs lignes. Il est utile pour réaliser des montages automatiques sur des systèmes de fichier différents, par exemple nfs et sshfs.
</p>

<p>
<em>/net</em> est le répertoire où les montages seront effectués. Il me semble qu&#039;il faut utiliser un répertoire dédié aux montages autofs, n&#039;utilisez pas <em>/home</em> par exemple. Si le répertoire n&#039;existe pas, autofs le créera.
</div></p>
</p>

<p>
L&#039;option ghost permet de toujours afficher les dossiers, mêmes lorsqu&#039;ils ne sont pas montés. 30 correspond au temps pour démonter automatiquement : ne mettez pas une valeur trop importante, parce que si l&#039;ordinateur distant est éteint le démontage plante ; il faut donc attendre au moins 30 sec entre le dernier accès au partage nfs et l&#039;extinction de l&#039;ordinateur distant.
</p>

<p>
Créez alors un fichier <em>/etc/auto.nfs</em> :
</p>
<pre class="code">mondossier    -fstype=nfs,rw,intr    192.168.0.1:/home/user/share</pre>

<p>
Le montage se fera alors dans <em>/net/mondossier</em>, et pointera vers la machine <em>192.168.0.1</em> sur le répertoire <em>/home/user/share</em>.
Vous pouvez dans ce même fichier écrire plusieurs lignes pour chacun de vos points de montages.
<p><div class="noteclassic">NB : le début du chemin (ici <em>/net</em>) est donné dans auto.master, il ne doit pas être répété dans auto.nfs, qui ne contient que un répertoire relatif (ici &#039;<em>mondossier</em>/&#039;
</div></p>
</p>

<p>
Il ne reste plus qu&#039;à lancer le serveur :
</p>
<pre class="code">sudo /etc/init.d/autofs start</pre>

<p>
et à double-cliquer sur /net/mondossier dans le navigateur pour les monter automatiquement.
</p>

<p>
Si vous faites un changement dans auto.master ou auto.fs :
</p>
<pre class="code">sudo /etc/init.d/autofs reload</pre>

</div>

<h2 class="sectionedit17" id="serveur_en_dhcp">Serveur en DHCP</h2>
<div class="level2">

<p>
Dans ce cas, l&#039;adresse IP du serveur peut être modifiée…
</p>

<p>
Il faut configurer le routeur qui assigne les adresses IP aux ordinateurs qui s&#039;y connectent en lui donnant un bail <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> permanent à l&#039;ordinateur qui sert de serveur <abbr title="Network File System">NFS</abbr>.
</p>

<p>
Votre routeur vous demandera l&#039;adresse <abbr title="Medium Access Control">MAC</abbr> du serveur <abbr title="Network File System">NFS</abbr> : vous pouvez la trouver en exécutant cette commande sur le serveur :
</p>
<pre class="code"> ifconfig</pre>

<p>
Relevez l&#039;adresse inscrite après &quot;HWaddr&quot;, c&#039;est l&#039;adresse <abbr title="Medium Access Control">MAC</abbr> de la carte réseau du serveur.
Une fois votre routeur configuré, relancez le serveur (ou débranchez / rebranchez le cable réseau).
</p>

<p>
Remarque : la freebox permet de le faire dans l&#039;interface de gestion → routeur
</p>

</div>

<h2 class="sectionedit18" id="configuration_du_pare-feu">Configuration du Pare-feu</h2>
<div class="level2">

<p>
Pour permettre aux clients de se connecter sur votre serveur, il va falloir ouvrir les ports nécessaires. <abbr title="Network File System">NFS</abbr> utilise le port 2049 (tcp, udp), portmap le port 111 (tcp, udp) et mount… Un port aléatoire, ce qui est extrêmement gênant. Il faut donc dans un premier temps fixer le port pour mount. Ceci se fait en <a href="../../tutoriel/comment_editer_un_fichier" class="wikilink1" title="tutoriel:comment_editer_un_fichier">éditant le fichier</a> <em>/etc/default/nfs-kernel-server</em> :
</p>
<pre class="code">sudo nano /etc/default/nfs-kernel-server</pre>

<p>
Ce fichier devrait ressembler à ceci :
</p>
<pre class="code"># Number of servers to start up
RPCNFSDCOUNT=8

# Runtime priority of server (see nice(1))
RPCNFSDPRIORITY=0

# Options for rpc.mountd.
# If you have a port-based firewall, you might want to set up
# a fixed port here using the --port option. For more information, 
# see rpc.mountd(8) or http://wiki.debian.org/?SecuringNFS
RPCMOUNTDOPTS=

# Do you want to start the svcgssd daemon? It is only required for Kerberos
# exports. Valid alternatives are &quot;yes&quot; and &quot;no&quot;; the default is &quot;no&quot;.
NEED_SVCGSSD=

# Options for rpc.svcgssd.
RPCSVCGSSDOPTS=</pre>

<p>
Modifiez les options de RPCMOUNTDOPTS en spécifiant un port, par exemple le port 4000 :
</p>
<pre class="code"> RPCMOUNTDOPTS=&quot;-p 4000&quot;</pre>

<p>
Les 6 ports à ouvrir sont donc 111, 2049 et 4000 (tcp et udp). Ouvrez Firestarter et <a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/firestarter#onglet_politique" class="wikilink2" title="utilisateurs:ljere:firestarter" rel="nofollow">configurez</a> les connexions entrantes de l&#039;onglet Politique. A ce stade on pourrait autoriser pour chaque port tout le monde par simplicité, mais il est possible d&#039;être plus fin en autorisant seulement les hôtes nécessaires. On peut spécifier au choix une seule adresse IP (ou un nom d&#039;hôte) ou une plage d&#039;adresses. Ceci est particulièrement intéressant en cas d&#039;adresses IP locales attribuées par <abbr title="Dynamic Host Configuration Protocol">DHCP</abbr> (et donc dynamiques). Par exemple, si vos adresses sont de type 192.168.1.???, on mettra :
</p>
<pre class="code">192.168.1.0/255.255.255.0</pre>

<p>
Les adresses IP allant de 192.168.1.0 à 192.168.1.255 seront autorisées.
</p>

</div>

<h2 class="sectionedit19" id="configuration_d_un_client_windows">Configuration d&#039;un client Windows</h2>
<div class="level2">

<p>
Imaginons le cas où vous disposez d&#039;un réseau de pc en grande partie <abbr title="GNU&#039;s Not Unix">GNU</abbr>/Linux, et que vous voulez donner accès à des fichiers partagés via <abbr title="Network File System">NFS</abbr> à un pauvre petit ordi que vous auriez laissé tourner sous Windows ? Pas possible ? Si !
</p>

<p>
Pour cela, il va falloir suivre scrupuleusement l&#039;astuce, en effet, même si microsoft fournit un outil permettant d&#039;accéder ou de partager en <abbr title="Network File System">NFS</abbr>, cet outil est capricieux.
</p>

</div>

<h4 id="pre-requis">Pré-requis</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Un PC sous Windows (2000 jusqu&#039;à Vista)</div>
</li>
<li class="level1"><div class="li"> Un réseau local sur lequel existent des partages <abbr title="Network File System">NFS</abbr></div>
</li>
<li class="level1"><div class="li"> Et le Windows Services for Unix</div>
</li>
</ul>

</div>

<h4 id="obtention_de_windows_services_for_unix">Obtention de Windows Services for Unix</h4>
<div class="level4">

<p>
Cela se fait directement sur le site de Microsoft : <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=896c9688-601b-44f1-81a4-02878ff11778&amp;DisplayLang=en" class="urlextern" title="http://www.microsoft.com/downloads/details.aspx?FamilyID=896c9688-601b-44f1-81a4-02878ff11778&amp;DisplayLang=en"  rel="nofollow">suivez le guide.</a>
Il ne faut pas avoir peur, le SFU fait 217 Mo, c&#039;est parfaitement normal.
<p><div class="notewarning">Pour Windows Vista, les Windows Services For Unix sont normalement intégrés, il faut les installer via le panneau de configuration → ajout/suppression de programmes → composants Windows.
</div></p>
</p>

<p>
Ceci fait, exécutez SFUxxxx_LN.exe (où xxxx représente sa version 3.5SEL à l&#039;heure où j&#039;écris ; et LN la langue choisie, pour notre cas EN fait l&#039;affaire (jap ne vous intéressera pas je pense… ).
L&#039;exécutable est une archive auto-extractible, qui va donc vous demander où se décompresser, un emplacement facile d&#039;accès comme le bureau sera le bienvenu.
<p><div class="notetip">Lors de l&#039;extraction, SFU ne crée pas de sous dossier pour s&#039;y décompresser, pensez donc à le décompresser dans un sous-dossier du bureau.
</div></p>
</p>

<p>
Une fois décompressé, lancez le setup.exe comme pour toute installation sur windows. Faites Next, et acceptez le EULA (CLUF en français). Choisissez custom, et gardez pour essentiels <abbr title="Network File System">NFS</abbr> (et toutes ses sous fonctionnalités) et Authentification Tools for <abbr title="Network File System">NFS</abbr> (idem). Le reste est à installer à votre guise.
</p>

<p>
Pour la suite de l&#039;installation, faites next sans vous soucier de quoi que ce soit !
</p>

<p>
<p><div class="noteimportant"> Pour Windows XP Home Édition, l&#039;installation nécessite de corriger l&#039;installeur en hexadécimal. Faites une sauvegarde du fichier SfuSetup.msi, puis ouvrez-le avec un <a href="http://fr.wikipedia.org/wiki/%C3%89diteur_hexad%C3%A9cimal" class="urlextern" title="http://fr.wikipedia.org/wiki/%C3%89diteur_hexad%C3%A9cimal"  rel="nofollow">éditeur hexadécimal</a>. Cherchez la chaîne : &quot;NOT (VersionNT = 501 AND MsiNTSuitePersonal)&quot; et remplacez 501 par 510.
</div></p>
</p>

</div>

<h4 id="configuration_de_windows_services_for_unix">Configuration de Windows Services for Unix</h4>
<div class="level4">

<p>
Maintenant que c&#039;est installé, il faut le configurer. Rien de bien compliqué, quand on sait ce qu&#039;il faut faire.
</p>

<p>
Munissez-vous d&#039;une copie des fichiers /etc/group et /etc/passwd d&#039;un de vos postes <abbr title="GNU&#039;s Not Unix">GNU</abbr>/linux, et transférez-les vers le disque dur de votre poste windows, peu importe l&#039;emplacement, tant que vous puissiez les retrouver.
</p>

<p>
Pour l&#039;exemple, nous les copions dans le répertoire d&#039;installation de SFU, (par défaut : C:\SFU\ ).
</p>

<p>
Ceci fait, direction menu démarrer, programmes (ou tous les programmes selon la version), puis Windows Services for Unix et enfin Services for Unix Administration.
</p>

<p>
Le programme se lance. Une fenêtre scindée en 2 parties apparaît.
(Nous ferons référence ainsi à la partie gauche quand nous dirons Gauche, et la partie droite quand nous dirons Droite).
</p>

<p>
A gauche, cliquez sur Services for Unix (Local), puis à droite sur &quot;Settings&quot;. Dans l&#039;invité de texte vérifiez que soit écrit localhost, puis cliquez sur Apply (en haut).
</p>

<p>
A gauche, cliquez sur User Name Mapping. A droite, préférez &quot;Use Password and Group files&quot;, et renseignez les champs path pour les fichiers password et group.
</p>

<p>
Dans l&#039;exemple, il s&#039;agit des fichiers passwrd et group copiés sur le disque, donc nous renseignons ainsi : c:\SFU\passwd et c:\SFU\group .
</p>

<p>
Ceci fait, cliquez Apply puis Reload, et à droite toujours, cliquez sur Maps.
</p>

<p>
Le but est de faire correspondre un utilisateur windows à un utilisateur linux, avec plus ou moins de droits d&#039;accès. Évitez de faire correspondre les comptes administrateurs de windows ou de linux avec d&#039;autre comptes, ceci pour des raisons de sécurité, bien évidemment.
</p>

<p>
Cliquez sur Show User Maps. Puis successivement &quot;list Windows User&quot; et &quot;list Unix Users&quot;. Si tout se passe bien, vous avez normalement les 2 listes, une correspondant à windows, l&#039;autre à <abbr title="GNU&#039;s Not Unix">GNU</abbr>/linux.
</p>

<p>
Choisissez votre nom d&#039;utilisateur windows, et l&#039;équivalent qui correspond le mieux pour linux (le compte d&#039;un autre utilisateur par exemple), puis cliquez sur Add. Vous avez &quot;mappé&quot; un utilisateur et vous pouvez le vérifier dans Mapped Users juste en dessous.
Chaque fois que vous ajoutez des utilisateurs, cliquez Apply.
</p>

<p>
Vous pouvez faire de même pour les Group (en cliquant sur show Group Maps), et une fois finis, n&#039;oubliez pas : Apply.
</p>

<p>
Maintenant que c&#039;est fait, vous pouvez parcourir votre réseau local à la recherche de points de montage <abbr title="Network File System">NFS</abbr>.
</p>

</div>

<h4 id="utilisation_de_windows_services_for_unix">Utilisation de Windows Services for Unix</h4>
<div class="level4">

<p>
Les points de montage <abbr title="Network File System">NFS</abbr> sont reconnus pour des dossiers sur le réseaux, ils peuvent donc être associés à un lecteur réseau de la même manière que n&#039;importe quel partage windows.
</p>

<p>
Pour les trouver, allez dans Favoris réseau → tout le réseau → <abbr title="Network File System">NFS</abbr> Network → Default <abbr title="Réseau Local">LAN</abbr>.
</p>

<p>
Vous trouverez ici les IP des postes linux connectés, mais aussi les noms de machines des postes Windows utilisant le service <abbr title="Network File System">NFS</abbr>.
</p>

<p>
Et maintenant, à vous de vous servir.
</p>

<p>
—-
</p>

<p>
<em>Contributeurs : <a href="../ostaquet" class="wikilink2" title="utilisateurs:ostaquet" rel="nofollow">ostaquet</a>, <a href="../fabien26" class="wikilink1" title="utilisateurs:fabien26">Fabien26</a>, <a href="http://doc.ubuntu-fr.org/utilisateurs/darkhylian" class="wikilink1" title="utilisateurs:darkhylian">DarkHylian</a></em><del>Texte barré</del>
</p>

</div>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/0/05bf12fcbc0393329492706b5f3c28a5.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="../../index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=edit&amp;rev=0"  class="action source" accesskey="v" rel="nofollow" title="Afficher le texte source [V]">Afficher le texte source</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/utilisateurs/ljere/brouillon?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="../../wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="../../documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
