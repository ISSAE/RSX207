<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>postfix_systeme_satellite - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="index.html"/>
<link rel="contents" href="postfix_systeme_satellite?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="feed.php?mode=list&amp;ns="/>
<link rel="alternate" type="text/html" title="HTML brut" href="_export/xhtml/postfix_systeme_satellite"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="_export/raw/postfix_systeme_satellite"/>
<link rel="stylesheet" type="text/css" href="lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"id":"postfix_systeme_satellite","namespace":""};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="postfix_systeme_satellite?do=edit#main" tabindex="1">Contenu</a> | <a href="postfix_systeme_satellite?do=edit#qsearch__in" tabindex="2">Rechercher</a> | <a href="postfix_systeme_satellite?do=edit#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="postfix_systeme_satellite?do=edit" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="postfix_systeme_satellite" >postfix_systeme_satellite</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                
<p>
<strong>Quelques recommandations avant de créer ou de modifier cette page :</strong>
</p>
<ol>
<li class="level1"><div class="li"> Lisez le <a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">guide du contributeur</a> et la <a href="wiki/ligne_editoriale" class="wikilink1" title="wiki:ligne_editoriale">ligne éditoriale</a>.</div>
</li>
<li class="level1"><div class="li"> Découvrez la <a href="http://doc.ubuntu-fr.org/wiki/syntaxe" class="wikilink1" title="wiki:syntaxe">syntaxe</a> et entraînez-vous dans le <a href="playground/playground" class="wikilink1" title="playground:playground">bac à sable</a>.</div>
</li>
<li class="level1"><div class="li"> Utilisez les modèles (<a href="wiki/modeles/application" class="wikilink1" title="wiki:modeles:application">application</a>, <a href="wiki/modeles/materiel" class="wikilink1" title="wiki:modeles:materiel">matériel</a>, <a href="wiki/modeles/portable" class="wikilink1" title="wiki:modeles:portable">ordinateur portable</a>, <a href="wiki/modeles/tutoriel" class="wikilink1" title="wiki:modeles:tutoriel">tutoriel</a>, <a href="wiki/modeles/utilisateur" class="wikilink1" title="wiki:modeles:utilisateur">utilisateur</a>, <a href="wiki/modeles/portail" class="wikilink1" title="wiki:modeles:portail">portail</a>) et les <a href="wiki/mini-tutoriels" class="wikilink1" title="wiki:mini-tutoriels">mini-tutoriels</a>.</div>
</li>
<li class="level1"><div class="li"> Rapportez toutes créations ou modifications importantes sur <a href="wiki/liste_discussion#coordination_de_la_documentation" class="wikilink1" title="wiki:liste_discussion">la liste de discussion</a>.</div>
</li>
</ol>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/f/fcdb5fe1d67011f56447459483d05597.xhtml used -->
<script type="text/javascript">/*<![CDATA[*/
textChanged = false/*!]]>*/</script>
    <div class="editBox" role="application">

    <div class="toolbar group">
        <div id="draft__status"></div>
        <div id="tool__bar"><a href="http://doc.ubuntu-fr.org/lib/exe/mediamanager.php?ns="
            target="_blank">Sélection de fichiers</a></div>
    </div>
    <form id="dw__editform" method="post" action="postfix_systeme_satellite?do=edit" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="3bbdeeb4168d06af7a8bbdbdb8925be6" /><input type="hidden" name="id" value="postfix_systeme_satellite" /><input type="hidden" name="rev" value="0" /><input type="hidden" name="date" value="1413478490" /><input type="hidden" name="prefix" value="." /><input type="hidden" name="suffix" value="" /><input type="hidden" name="changecheck" value="fb12064e1a6a671bab24d08887600d81" /><input type="hidden" name="target" value="section" /><textarea name="wikitext" id="wiki__text" dir="auto" class="edit" cols="80" rows="10" tabindex="1">
{{tag&gt;Dapper Hardy lucid precise }}

----
====== Système Satellite pour Postfix ======

===== Description =====

Un système satellite pour Postfix signifie simplement que les mails du système seront envoyés automatiquement à un serveur SMTP.
Ceci vous permettra d'utiliser la commande mail (du package mailx) directement pour envoyer des emails.

Il pourra par la suite être utilisé pour envoyer des emails automatiquement comme par exemple des fichiers de logs grâce à cron.

===== Prérequis =====

  *  disposer d'un [[:sudo|accès privilégié]] sur la machine.

===== Installation =====

Commençons par [[:tutoriel:comment_installer_un_paquet|installer le paquet]] **[[apt://postfix|postfix]]**.

Un assistant va alors se lancer, et vous allez devoir répondre à quelques questions.

Si l'assistant ne se lance pas ou si Postfix est déjà installé sur votre système, faites un

  sudo dpkg-reconfigure postfix


===== Configuration de Postfix =====

Voici comment configurer postfix grâce à assistant:

Lorsque l'assistant se lance, un premier panneau vous explique chaque configuration possible.
Donc faisons OK.

  - La première question correspond justement au type d'installation de Postfix que vous souhaitez effectuer, ici Système Satellite. 
  - La question suivante permet de choisir le nom suivant le symbole @ pour les expéditeurs de vos courriels. Choisissez donc ici le nom de votre machine par exemple (qualifié, c'est-à-dire machine.nomdomaine.org par exemple). Si vous désirez recevoir des email de @chezguillaume.fr, entrez chezguillaume.fr
  - Ensuite, cette question est le point clé de l'assistant, elle permet de saisir le SMTP de votre FAI. Donc, mettez l'adresse du serveur smtp. Si vous devez préciser un port différent du port 25, ajouter : puis le numéro du port. Par exemple, si je dois utiliser le port 1234 je doit mettre **smtp.serveur.org:1234**
  - Le courrier de root doit être envoyé en alias sur un autre utilisateur, saisissez donc ce nom d'utilisateur à la question suivante (au quotidien, lorsque l'utilisateur root du système enverra un mail, il sera transféré sous le nom de l'utilisateur choisi ici). Donc mettez votre compte pour que les emails de root soit directement renvoyés vers votre boite mail, ou expédié par votre boite mail.
  - Ensuite, choisissez les noms d'hôtes qui seront acceptés lorsqu'un utilisateur local souhaitera envoyer un courrier (le nom de votre machine devrait suffire ici).
  - Répondez Oui à la question &quot;Forcer des mises à jour synchronisées de la file d'attente des courriels ?&quot;
  - Il est fortement recommander de n'accepter les envois de courrier que sur la boucle locale, à savoir &quot;127.0.0.0/8&quot; pour la question suivante.
  - La taille maximale des boites aux lettres peut être mise à 0, si vous êtes sûr des utilisateurs de votre machine.
  - Le caractère &quot;+&quot; est très bien pour signifier une adresse locale, laissez donc ce champ à la question suivante.
  - Enfin, tous les protocoles Internet méritent d'être activés, choisissez donc &quot;tous&quot; à la question suivante.

Le serveur Postfix va alors redémarrer, et l'envoi de mail est désormais fonctionnel.

===== Authentification =====

Si le serveur SMTP que vous allez utiliser possède un jeu de login et mot de passe, il faut le préciser dans le fichier de configuration de postfix :

==== Modifier le fichier « main.cf » ====

Il faut donc [[:tutoriel:comment_editer_un_fichier|éditer le fichier]] **/etc/postfix/main.cf** :
&lt;code&gt;sudo vim /etc/postfix/main.cf&lt;/code&gt;

et ajouter les lignes suivante à la fin :

&lt;file&gt;
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl/sasl_passwd
smtp_sasl_security_options = noanonymous
&lt;/file&gt;

Vous pouvez également activer le chiffrement de la connexion grâce à TLS/SSL en ajoutant les lignes suivantes (notez qu'il est recommandé de l'activer si le serveur SMTP auquel vous vous connectez le supporte) :

&lt;file&gt;
smtp_use_tls = yes
smtp_enforce_tls = yes
smtp_tls_CAfile = /etc/ssl/certs/ca-certificates.crt
&lt;/file&gt;

Vérifiez également le port de connexion à votre serveur SMTP (celui-ci étant parfois différent quand on utilise une connexion sécurisée) en éditant la ligne suivante :

&lt;file&gt;
relayhost = smtp.serveur.org:1234
&lt;/file&gt;

Puis sauvegardez le fichier.

Si vous n'arrivez pas à envoyer de message avec cette configuration vous pouvez désactiver smtp_enforce_tls mais sachez que Postfix ne vérifiera pas le certificat qui lui est présenté par votre serveur SMTP. Il se contentera de l'accepter pour chiffrer la connexion et éviter ainsi de transmettre vos identifiant et mot de passe en clair mais ne vérifiera pas qu'il dialogue avec le bon serveur et non avec un serveur pirate. Ne désactivez donc cette option que si votre serveur SMTP présente un certificat qui pose problème.

Il faut ensuite s'assurer que la base des certificats est à jour en exécutant les commandes suivantes :

&lt;code&gt;
sudo update-ca-certificates
sudo c_rehash /etc/ssl/certs/
&lt;/code&gt;

==== Créer le fichier « sasl_passwd » ====

Maintenant, il ne reste plus qu'à [[:tutoriel:comment_editer_un_fichier|créer le fichier]] **/etc/postfix/sasl/sasl_passwd** qui contiendra les informations de connexion, et seul root pourra le lire et y écrire :

&lt;file&gt;
smtp.serveur.org:1234 nom_utilisateur:mot_de_passe
&lt;/file&gt;

Le « nom_utilisateur » peut aussi être une adresse de courriel.

Puis exécutez la commande suivante:
&lt;code&gt;
sudo postmap /etc/postfix/sasl/sasl_passwd
&lt;/code&gt;

Il ne reste plus qu'à redémarrer le serveur Postfix pour qu'il prenne les nouveaux paramètres :

  sudo /etc/init.d/postfix restart
===== Tester l'envoi d'email =====

Pour tester que tout s'est bien passé, [[:tutoriel:comment_installer_un_paquet|installez]] le paquet **[[apt://mailx|mailx]]**. ((bsd-mailx sur [[Karmic]] et versions supérieures d'Ubuntu))

Puis dans un terminal :

  echo &quot;test&quot; | mail -s &quot;Sujet Test&quot; votreadresse@mail

Vous devriez recevoir votre email sans problème. Attention cependant, si vous n'avez pas choisi de nom qualifié pour votre serveur, les mails risquent très fortement (voire toujours) d'être interceptés par le SMTP de votre FAI. Pour cela, vous pouvez utiliser une autre petite technique, la translation d'adresse de courriel (cf. infra).

===== Translation de courriel =====

Pour cela, [[:tutoriel:comment_editer_un_fichier|éditez le fichier]] **/etc/postfix/main.cf**.

Ajoutez-y :

&lt;file&gt;
smtp_generic_maps = hash:/etc/postfix/generic
&lt;/file&gt;

[[:tutoriel:comment_editer_un_fichier|Créer maintenant le fichier]] **/etc/postfix/generic** et placez-y :

&lt;file&gt;
nom-utilisateur adresse-mel@valide
&lt;/file&gt;

Enfin, exécutez les commandes suivantes :

  sudo postmap /etc/postfix/generic
  sudo service postfix restart


===== Liens et références =====

  * **''(en)''** [[http://www.postfix.org/|Le site officiel de Postfix]]
  * **''(fr)''** [[http://x.guimard.free.fr/postfix/|Documentation en français de Postfix]]
  * **''(fr)''** [[wpfr&gt;Postfix|Article encyclopédique (Wikipédia)]]

----

//Contributeur principal : [[:utilisateurs:Zedtux]].//</textarea>
<div id="wiki__editbar" class="editBar">
<div id="size__ctl">
</div>
<div class="editButtons">
<div id="plugin__captcha_wrapper"><input type="hidden" name="b5d56cdeec27fce70359b5dad63a3c75" value="F7aylCAsU0wLBQZkOJbsR00EK7MJJ/ZqjjfK2upJi3s=" /><label for="plugin__captcha">Merci de recopier le code ci-contre pour prouver que vous êtes humain :</label> <span id="plugin__captcha_code">YD A V L</span> <input type="text" size="5" name="6452ae60b047ec27748263b906b458a4" class="edit" /> <label class="no">Merci de laisser ce champ vide : <input type="text" name="3fa1cb83ef4f22db949b15545f1b2603" /></label></div><input name="do[save]" type="submit" value="Enregistrer" class="button" id="edbtn__save" accesskey="s" tabindex="4" title="Enregistrer [S]" />
<input name="do[preview]" type="submit" value="Aperçu" class="button" id="edbtn__preview" accesskey="p" tabindex="5" title="Aperçu [P]" />
<input name="do[draftdel]" type="submit" value="Annuler" class="button" tabindex="6" />
</div>
<div class="summary">
<label class="nowrap" for="edit__summary"><span>Résumé</span> <input type="text" id="edit__summary" name="summary" class="edit" size="50" tabindex="2" /></label>
</div>
</div>
<div class="license">
Note : En modifiant cette page, vous acceptez que le contenu soit placé sous les termes de la licence suivante : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" class="urlextern">CC Paternité-Partage des Conditions Initiales à l'Identique 3.0 Unported</a></div>
</div></form>
</div>
<script type="text/javascript">
   var saveBtn = document.getElementById('edbtn__save');
   saveBtn.disabled = true;
   saveBtn.style.color = 'gray';
   saveBtn.style.backgroundColor = '#EEEEEE';
   saveBtn.value = 'Enregistrer (Click \'Aperçu\' first)';
</script>
        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="postfix_systeme_satellite?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/postfix_systeme_satellite?do="  class="action show" accesskey="v" rel="nofollow" title="Afficher la page [V]">Afficher la page</a></li>
                  <li><a href="postfix_systeme_satellite?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="postfix_systeme_satellite?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="postfix_systeme_satellite?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
