<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>libata - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2012-02-02T13:15:47+0100"/>
<meta name="keywords" content="brouillon,kernel"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="index.html"/>
<link rel="contents" href="http://doc.ubuntu-fr.org/libata?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="http://doc.ubuntu-fr.org/libata?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="http://doc.ubuntu-fr.org/_export/xhtml/libata"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="http://doc.ubuntu-fr.org/_export/raw/libata"/>
<link rel="canonical" href="libata"/>
<link rel="stylesheet" type="text/css" href="lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"id":"libata","namespace":""};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="libata#main" tabindex="1">Contenu</a> | <a href="libata#qsearch__in" tabindex="2">Rechercher</a> | <a href="libata#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="libata" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="libata" >libata</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <div class="notetag">Cette page est en cours de rédaction.<br />
<a href="wiki/participer_wiki">Apportez votre aide…</a>
</div>
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table des matières</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="libata#diagnostic">Diagnostic</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="libata#faux_probleme">Faux problème</a></div></li>
<li class="level2"><div class="li"><a href="libata#vrai_probleme">Vrai problème</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="libata#solutions">Solutions</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="libata#dans_le_bios">Dans le BIOS</a></div></li>
<li class="level2"><div class="li"><a href="libata#dans_grub">Dans Grub</a></div></li>
<li class="level2"><div class="li"><a href="libata#desactiver_libata">Désactiver libATA</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="libata#liens">Liens</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->
<div class="tags"><span>
	<a href="brouillon" class="wikilink1" title="brouillon" rel="tag">brouillon</a>,
	<a href="kernel" class="wikilink1" title="kernel" rel="tag">kernel</a>
</span></div>
<hr />

<h1 class="sectionedit1" id="libata">libATA</h1>
<div class="level1">

<p>
La libATA est une bibliothèque pour le <a href="kernel" class="wikilink1" title="kernel">noyau</a> <a href="http://doc.ubuntu-fr.org/linux" class="wikilink1" title="linux">linux</a> introduite lors de la version 2.6.18. Elle est censée permettre de gérer tous les transferts <a href="http://fr.wikipedia.org/wiki/Advanced_Technology_Attachment" class="urlextern" title="http://fr.wikipedia.org/wiki/Advanced_Technology_Attachment"  rel="nofollow">ATA</a> et <a href="http://fr.wikipedia.org/wiki/ATAPI" class="urlextern" title="http://fr.wikipedia.org/wiki/ATAPI"  rel="nofollow">ATAPI</a> <em>via</em> le sous-système <a href="http://fr.wikipedia.org/wiki/SCSI" class="urlextern" title="http://fr.wikipedia.org/wiki/SCSI"  rel="nofollow">SCSI</a>.
</p>

<p>
C&#039;est « grâce » à elle que vos partitions apparaissent sous la forme <strong>/dev/sdX</strong> au lieu de <strong>/dev/hdX</strong> depuis qu&#039;Ubuntu a fait le choix d&#039;utiliser les modules liés à cette bibliothèque par défaut. C&#039;est aussi à cause d&#039;elle que vous rencontrez peut-être des performances catastrophiques, des problèmes de prise en charge du <a href="http://fr.wikipedia.org/wiki/Accès_direct_à_la_mémoire" class="urlextern" title="http://fr.wikipedia.org/wiki/Accès_direct_à_la_mémoire"  rel="nofollow">DMA</a>, ou autre option traditionnellement activée par <a href="hdparm" class="wikilink1" title="hdparm">hdparm</a>.
</p>

<p>
Cette page a pour but de recenser quelques solutions face aux problèmes que peuvent engendrer l&#039;utilisation de cette bibliothèque.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[libATA] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="33-1004" /><input type="submit" value="Modifier" class="button" title="libATA" /></div></form></div>
<h2 class="sectionedit2" id="diagnostic">Diagnostic</h2>
<div class="level2">

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Diagnostic] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="1005-1028" /><input type="submit" value="Modifier" class="button" title="Diagnostic" /></div></form></div>
<h3 class="sectionedit3" id="faux_probleme">Faux problème</h3>
<div class="level3">

<p>
Vous avez décidé d&#039;activer le DMA et la prise en charge de l&#039;I/O 32bits (ou tout autre option) sur votre disque dur (ou votre graveur DVD), en utilisant la commande <a href="hdparm" class="wikilink1" title="hdparm">hdparm</a>. Et là, c&#039;est le drame :
</p>
<pre class="code">sudo hdparm -d1 -c1 /dev/sda</pre>
<pre class="file">/dev/sda:
setting 32-bit IO_support flag to 1
HDIO_SET_32BIT failed: Invalid argument
IO_support = 0 (default) (16-bit)
HDIO_GET_DMA failed: Inappropriate ioctl for device</pre>

<p>
Pas d&#039;inquiétude : la libATA active par défaut le DMA sur tous les périphériques compatibles. La prise en charge de l&#039;I/O 32bits n&#039;est pour l&#039;instant disponible que sur un nombre limité de périphériques, et ce n&#039;est pas la priorité des développeurs de la libATA, car les situations où le besoin s&#039;en fait sentir sont relativement rares. Lorsque c&#039;est possible, cette option est également activée par défaut.
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Faux problème] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="1029-1910" /><input type="submit" value="Modifier" class="button" title="Faux problème" /></div></form></div>
<h3 class="sectionedit4" id="vrai_probleme">Vrai problème</h3>
<div class="level3">

<p>
Si votre disque est lent, si la lecture d&#039;un DVD est saccadée, s&#039;il vous faut plusieurs heures pour graver quelques centaines de Mo, alors vous avez peut-être réellement un problème avec la libATA. Commencez par effectuer le test suivant sur le périphérique problématique (dans cet exemple, /dev/sda) :
</p>
<pre class="code">sudo hdparm -T /dev/sda</pre>

<p>
Si le résultat est de plusieurs centaines de Mo par seconde, votre problème est ailleurs. En revanche, si le résultat donne quelques Mo voire des centaines de ko par seconde, alors votre problème vient vraisemblablement de la libATA : votre matériel n&#039;est pas (encore) correctement pris en charge. C&#039;est en particulier vrai pour les cartes mères Intel fonctionnant en mode « combiné ».
</p>

</div>
<div class='secedit editbutton_section editbutton_4'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Vrai problème] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="1911-2680" /><input type="submit" value="Modifier" class="button" title="Vrai problème" /></div></form></div>
<h2 class="sectionedit5" id="solutions">Solutions</h2>
<div class="level2">

<p>
Il existe plusieurs solutions préconisées. Elles sont présentées ici par ordre (supposé) de préférence de la part des développeurs de la libATA. Si l&#039;une d&#039;elle ne fonctionne pas, passez à la suivante.
</p>

<p>
Elles sont surtout valables pour les cartes mères Intel proposant le mode « combiné », qui permet aux modes <a href="http://fr.wikipedia.org/wiki/PATA_(informatique)" class="urlextern" title="http://fr.wikipedia.org/wiki/PATA_(informatique)"  rel="nofollow">PATA</a> (comprendre <a href="http://fr.wikipedia.org/wiki/Integrated_drive_electronics" class="urlextern" title="http://fr.wikipedia.org/wiki/Integrated_drive_electronics"  rel="nofollow">IDE</a>) et <a href="http://fr.wikipedia.org/wiki/SATA" class="urlextern" title="http://fr.wikipedia.org/wiki/SATA"  rel="nofollow">SATA</a> de fonctionner comme une seule fonction <a href="http://fr.wikipedia.org/wiki/Peripheral_Component_Interconnect" class="urlextern" title="http://fr.wikipedia.org/wiki/Peripheral_Component_Interconnect"  rel="nofollow">PCI</a>, mais entre en conflit avec la libATA, les pilotes <abbr title="Integrated Drive Electronics">IDE</abbr> et la libATA essayant de gérer le même matériel. Le principe est donc de n&#039;utiliser soit QUE la libATA, soit QUE les pilotes <abbr title="Integrated Drive Electronics">IDE</abbr>.
</p>

<p>
<p><div class="noteimportant">Si vous choisissez une solution qui utilise les pilotes <abbr title="Integrated Drive Electronics">IDE</abbr>, vos disques vont redevenir du type /dev/hdX. N&#039;oubliez pas de modifier les fichiers /etc/fstab en conséquence ! Le label de la <a href="http://doc.ubuntu-fr.org/swap" class="wikilink1" title="swap">swap</a> va également changer.
</div></p>
</p>

</div>
<div class='secedit editbutton_section editbutton_5'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Solutions] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="2681-3756" /><input type="submit" value="Modifier" class="button" title="Solutions" /></div></form></div>
<h3 class="sectionedit6" id="dans_le_bios">Dans le BIOS</h3>
<div class="level3">

<p>
Modifiez dans votre <abbr title="Basic Input-Output System">BIOS</abbr> l&#039;option <strong>mode <abbr title="Integrated Drive Electronics">IDE</abbr></strong> de <strong>legacy</strong> ou <strong>combined</strong> en <strong>AHCI</strong>, <strong>RAID</strong> ou <strong>native</strong>.
</p>

</div>
<div class='secedit editbutton_section editbutton_6'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Dans le BIOS] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="3757-3895" /><input type="submit" value="Modifier" class="button" title="Dans le BIOS" /></div></form></div>
<h3 class="sectionedit7" id="dans_grub">Dans Grub</h3>
<div class="level3">

<p>
Essayez de démarrer <a href="grub" class="wikilink1" title="grub">Grub</a> en ajoutant à la ligne <strong>kernel</strong> le paramètre <strong>combined_mode=libata</strong> ou le paramètre <strong>combined_mode=ide</strong>, afin de permettre à l&#039;un ou l&#039;autre des pilotes libata/ide de prendre en charge tous les ports <abbr title="Integrated Drive Electronics">IDE</abbr>.
</p>

</div>
<div class='secedit editbutton_section editbutton_7'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Dans Grub] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="3896-4163" /><input type="submit" value="Modifier" class="button" title="Dans Grub" /></div></form></div>
<h3 class="sectionedit8" id="desactiver_libata">Désactiver libATA</h3>
<div class="level3">

</div>

<h4 id="par_les_modules">Par les modules</h4>
<div class="level4">

<p>
Désactiver les modules liés à la libATA. Dans le fichier <strong>/etc/modprobe.d/blacklist</strong>, ajouter les lines suivantes (toutes ne sont pas forcément nécessaires, vous pouvez faire des tests si vous le souhaitez) :
</p>
<pre class="file">blacklist pata_atiixp
blacklist pata_acpi
blacklist sg
blacklist sr_mod
blacklist sd_mod</pre>

</div>

<h4 id="par_le_noyau">Par le noyau</h4>
<div class="level4">

<p>
Vous pouvez également <a href="kernel" class="wikilink1" title="kernel">recompiler le noyau</a> en désactivant complètement la libATA (CONFIG_ATA) et en activant CONFIG_BLK_DEV_<abbr title="Integrated Drive Electronics">IDE</abbr>_<abbr title="Serial Advanced Technology Attachment">SATA</abbr>.
</p>

</div>

<h4 id="alternative_par_le_noyau">Alternative par le noyau</h4>
<div class="level4">

<p>
Alternativement, vous pouvez désactiver complètement CONFIG_<abbr title="Integrated Drive Electronics">IDE</abbr>, et autoriser la libATA à diriger tous vos ports <abbr title="Integrated Drive Electronics">IDE</abbr> et <abbr title="Serial Advanced Technology Attachment">SATA</abbr>.
</p>

</div>
<div class='secedit editbutton_section editbutton_8'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Désactiver libATA] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="4164-4876" /><input type="submit" value="Modifier" class="button" title="Désactiver libATA" /></div></form></div>
<h2 class="sectionedit9" id="liens">Liens</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> (en) <a href="http://linux-ata.org/faq.html" class="urlextern" title="http://linux-ata.org/faq.html"  rel="nofollow">Site officiel</a></div>
</li>
<li class="level1"><div class="li"> (en) <a href="http://ata.wiki.kernel.org" class="urlextern" title="http://ata.wiki.kernel.org"  rel="nofollow">Wiki libATA</a></div>
</li>
</ul>

</div>
<div class='secedit editbutton_section editbutton_9'><form class="button btn_secedit" method="post" action="libata"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1328184947" /><input type="hidden" name="summary" value="[Liens] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="4877-" /><input type="submit" value="Modifier" class="button" title="Liens" /></div></form></div>
<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/4/4f2cc9b60b0229b2287044ec46143c36.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="http://doc.ubuntu-fr.org/libata?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/libata?do=edit&amp;rev=0"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/libata?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="http://doc.ubuntu-fr.org/libata?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/libata?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
