<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>
    <meta http-equiv="Content-Language" content="fr"/>
    <title>time_capsule - Documentation Ubuntu Francophone</title>
    <meta name="Description" content="Documentation francophone pour la distribution Ubuntu" lang="fr" />
    <meta name="language" content="fr-FR" />

    <!--[if IE 8]>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <![endif]-->
        <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2014-11-16T19:53:46+0100"/>
<meta name="keywords" content="materiel,apple,brouillon"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.php" title="Documentation Ubuntu Francophone"/>
<link rel="start" href="index.html"/>
<link rel="contents" href="http://doc.ubuntu-fr.org/time_capsule?do=index" title="Plan du site"/>
<link rel="alternate" type="application/rss+xml" title="Derniers changements" href="feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Namespace actuel" href="feed.php?mode=list&amp;ns="/>
<link rel="edit" title="Modifier cette page" href="http://doc.ubuntu-fr.org/time_capsule?do=edit"/>
<link rel="alternate" type="text/html" title="HTML brut" href="http://doc.ubuntu-fr.org/_export/xhtml/time_capsule"/>
<link rel="alternate" type="text/plain" title="Wiki balise" href="http://doc.ubuntu-fr.org/_export/raw/time_capsule"/>
<link rel="canonical" href="time_capsule"/>
<link rel="stylesheet" type="text/css" href="lib/exe/css.php?t=ubuntu-2010&amp;tseed=4af22dedc19f28c99fa67afabbb173df"/>
<script type="text/javascript">/*<![CDATA[*/var NS='';var JSINFO = {"id":"time_capsule","namespace":""};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="lib/exe/js.php?tseed=4af22dedc19f28c99fa67afabbb173df"></script>
    <link rel="shortcut icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/icone.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="http://www-static.ubuntu-fr.org/theme2010/images/commun/ubuntu/touch-ico.png" />

    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc.css" />
    <link rel="stylesheet" media="screen" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-ubuntu.css" />
    <link rel="stylesheet" media="print" type="text/css" title="Design Ubuntu-fr" href="http://www-static.ubuntu-fr.org/theme2010/css/doc-print.css" />

    <script type="text/javascript">
      var menu_hidden;
      var static_url = "UFR_STATIC";
    </script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/menu.js" type="text/javascript"></script>
    <script src="http://www-static.ubuntu-fr.org/theme2010/js/common.js" type="text/javascript"></script>
  </head>
  <body>

    <div id="accessibar">
      <a href="time_capsule#main" tabindex="1">Contenu</a> | <a href="time_capsule#qsearch__in" tabindex="2">Rechercher</a> | <a href="time_capsule#navigation" tabindex="3">Menus</a>
    </div>

    <div id="page">

      <div id="header">

        <div id="logo">
          <h1>Ubuntu-fr</h1>
          <a href="index.html" title="Accueil de la documentation">Communauté francophone d'utilisateurs d'Ubuntu</a>
        </div>

        <form action="http://ubuntu-fr.org/recherche" accept-charset="utf-8" id="search" onsubmit="if (document.getElementById('qsearch__in').value == 'Recherche rapide....') {document.getElementById('qsearch__in').value = '';}">
          <fieldset>
            <label for="qsearch__in">Recherche : </label><input type="text" value="Recherche rapide...." id="qsearch__in" accesskey="f" name="sk_q" alt="[F]" size="34" tabindex="4" />
            <label for="tsearch_field">Chercher dans : </label><select name="sk_engine" tabindex="5" id="tsearch_field" title="Chercher dans">
              <option value="all">Site</option>
              <option selected="selected" value="doc">Documentation</option>
              <option value="forum">Forum</option>
              <option value="planet">Planet</option>
            </select>
            <input type="submit" value="ok" class="button" alt="Lancer la recherche" tabindex="5" />
          </fieldset>
        </form>
        <!--[if lte IE 7]><div class="clear"></div><![endif]-->

        <form action="time_capsule" accept-charset="utf-8" id="login_top" method="post">
          <fieldset>
            <label for="u_field">Identifiant : </label><input type="text" value="Identifiant" name="u" id="u_field" size="9" /><label for="p_field">Mot de passe : </label><input type="password" value="Mot de passe" name="p" id="p_field" size="9" alt="Mot de passe" /><input type="submit" value="connexion" id="connect" /> / <a href="http://forum.ubuntu-fr.org/register.php">inscription</a>
          </fieldset>
        </form>
 

      </div>

      <div id="navbar">
          <h2 id="pagetitle"><a href="time_capsule" >time_capsule</a></h2>
      </div>

      
      <div id="main" class="dokuwiki">

        <div id="hidemenu" title="Masquer le menu"></div>

        <div id="pagerror"></div>
                <div class="notetag">Cette page est en cours de rédaction.<br />
<a href="wiki/participer_wiki">Apportez votre aide…</a>
</div>
<div class="tags"><span>
	<a href="materiel" class="wikilink1" title="materiel" rel="tag">matériel</a>,
	<a href="http://doc.ubuntu-fr.org/apple" class="wikilink1" title="apple" rel="tag">apple</a>,
	<a href="brouillon" class="wikilink1" title="brouillon" rel="tag">BROUILLON</a>
</span></div>

<h1 class="sectionedit1" id="time_capsule">Time Capsule</h1>
<div class="level1">

<p>
<a href="http://en.wikipedia.org/wiki/Time_Capsule" class="interwiki iw_wp" title="http://en.wikipedia.org/wiki/Time_Capsule">Time Capsule</a> est un périphérique de stockage en réseau NAS sans fil accompagné d&#039;un routeur conçu et commercialisé par Apple Inc. L&#039;une des fonctions clés de Time Capsule est la possibilité de faire des sauvegardes automatiques à distance à l’aide de Time Machine. Mais la sauvegarde peut aussi se faire depuis un autre système d&#039;exploitation tel que Microsoft Windows ou Linux.
</p>

</div>
<div class='secedit editbutton_section editbutton_1'><form class="button btn_secedit" method="post" action="time_capsule"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1416164026" /><input type="hidden" name="summary" value="[Time Capsule] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="36-480" /><input type="submit" value="Modifier" class="button" title="Time Capsule" /></div></form></div>
<h2 class="sectionedit2" id="acces_manuel_au_disque_aux_disques_de_la_time_capsule">Accès manuel au disque (aux disques) de la time capsule</h2>
<div class="level2">

<p>
Pour accéder manuellement au disque (aux disques) de la time capsule depuis ubuntu, il est nécessaire de monter le (les) disque(s) en question :
</p>

<p>
&lt;TC_IP&gt; désigne l&#039;adresse IP de la time capsule
</p>

<p>
&lt;TC_DISK&gt; désigne le(s) nom(s) du (des) disque(s) dur(s) time capsule
</p>

<p>
&lt;TC_PASSWORD&gt; désigne le mot de passe de la time capsule
</p>
<pre class="code">sudo mkdir /mnt/&lt;TC_DISK&gt;
sudo mount.cifs //&lt;TC_IP&gt;/&lt;TC_DISK&gt; /mnt/&lt;TC_DISK&gt; -o pass=&lt;TC_PASSWORD&gt;, file_mode=0777,dir_mode=0777</pre>

<p>
la commande précédente peut ne plus être à jour à cause de l&#039;implémentation d&#039;une sécurité en plus de apple:
</p>
<pre class="code"># mount -t cifs //server_ip/Data /mnt/Data -o user=user,passwd=user_pwd,sec=ntlm</pre>

<p>
spécifiez à la place de Data dans //server_ip/Data le nom de l&#039;utilisateur sinon vous tomberez sur la partition de root. 
Le Data peut être remplacé par le nom du compte utilisateur si vous avez configuré votre TC en utilisant des comptes utilisateurs comme moyen de s&#039;authentifier. 
Explication ici: <a href="http://timesinker.blogspot.be/2014/06/mounting-osx-time-capsule-in-linux.html" class="urlextern" title="http://timesinker.blogspot.be/2014/06/mounting-osx-time-capsule-in-linux.html"  rel="nofollow">http://timesinker.blogspot.be/2014/06/mounting-osx-time-capsule-in-linux.html</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_2'><form class="button btn_secedit" method="post" action="time_capsule"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1416164026" /><input type="hidden" name="summary" value="[Accès manuel au disque (aux disques) de la time capsule] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="481-1632" /><input type="submit" value="Modifier" class="button" title="Accès manuel au disque (aux disques) de la time capsule" /></div></form></div>
<h2 class="sectionedit3" id="automatisation">Automatisation</h2>
<div class="level2">

<p>
Sous ubuntu <a href="precise" class="wikilink1" title="precise"> 12.04 (Precise Pangolin)</a>, il est possible d&#039;automatiser cette opération à l&#039;aide d&#039;un script shell à placer dans &quot;/etc/NetworkManager/dispatcher.d/&quot; sans oublier d&#039; accorder les droits d’exécution à ce fichier (sudo chmod +x 99tc.sh).
Ce script a été inspiré de <sup><a href="time_capsule#fn__1" id="fnt__1" class="fn_top">1)</a></sup>, <sup><a href="time_capsule#fn__2" id="fnt__2" class="fn_top">2)</a></sup> et <sup><a href="time_capsule#fn__3" id="fnt__3" class="fn_top">3)</a></sup>.
</p>
<pre class="code">
#!/bin/sh
# /etc/NetworkManager/dispatcher.d/99tc.sh
# Remplacer TIMECAPSULE_LOGIN, TIMECAPSULE_PASSWORD, TIMECAPSULE_IP, MOUNT_POINT par vos propres valeurs,
# Le script est à adapté en fonction du nombre de disques durs connectés à la time capsule
# (ici deux disques : TIME_CAPSULE_VOLUME_1 et TIME_CAPSULE_VOLUME_2)

IF=$1
STATUS=$2

# Partie à compléter

HOME_NETWORK=&quot;&lt;Mon réseau Wifi&gt;&quot;

TIMECAPSULE_LOGIN=&quot;&lt;login&gt;&quot;
TIMECAPSULE_PASSWORD=&quot;&lt;password&gt;&quot;
TIMECAPSULE_IP=&quot;&lt;adresse IP de la time capsule&gt;&quot;

MOUNT_POINT=&quot;/mnt/&quot; 

TIMECAPSULE_VOLUME_1=&quot;&lt;nom disque 1 time capsule&gt;&quot;
TIMECAPSULE_VOLUME_2=&quot;&lt;nom disque 2 time capsule&gt;&quot;

# Fin de la partie à compléter


MOUNT_POINT_VOLUME_1=$MOUNT_POINT$TIMECAPSULE_VOLUME_1
MOUNT_POINT_VOLUME_2=$MOUNT_POINT$TIMECAPSULE_VOLUME_2

IS_MOUNTED_VOL_1=`mount 2&gt; /dev/null | grep &quot;$MOUNT_POINT_VOLUME_1&quot; | cut -d&#039; &#039; -f3`
IS_MOUNTED_VOL_2=`mount 2&gt; /dev/null | grep &quot;$MOUNT_POINT_VOLUME_2&quot; | cut -d&#039; &#039; -f3`

TIMECAPSULE_PATH_VOL_1=&quot;//$TIMECAPSULE_IP/$TIMECAPSULE_VOLUME_1&quot;
TIMECAPSULE_PATH_VOL_2=&quot;//$TIMECAPSULE_IP/$TIMECAPSULE_VOLUME_2&quot;

CHECK_DISK_VOL_1=`smbclient --user=$TIMECAPSULE_LOGIN%$TIMECAPSULE_PASSWORD -L $TIMECAPSULE_IP 2&gt;&amp;1 | grep -m1 -i $TIMECAPSULE_VOLUME_1`
CHECK_DISK_VOL_2=`smbclient --user=$TIMECAPSULE_LOGIN%$TIMECAPSULE_PASSWORD -L $TIMECAPSULE_IP 2&gt;&amp;1 | grep -m1 -i $TIMECAPSULE_VOLUME_2`

if [ ! -e $MOUNT_POINT_VOLUME_1 ]; then
	logger &quot;Create directory $MOUNT_POINT_VOLUME_1&quot;
	mkdir $MOUNT_POINT_VOLUME_1
fi

if [ ! -e $MOUNT_POINT_VOLUME_2 ]; then
	logger &quot;Create directory $MOUNT_POINT_VOLUME_2&quot;
	mkdir $MOUNT_POINT_VOLUME_2
fi


if [ &quot;${IF}&quot; = &quot;wlan0&quot; ] &amp;&amp; [ &quot;${STATUS}&quot; = &quot;up&quot; ]; then

	ESSID=`/sbin/iwgetid --raw`
	
	case &quot;$ESSID&quot; in 
	$HOME_NETWORK)
	
	logger &quot;Home wlan0 up (${ESSID})&quot;

		if [ &quot;$CHECK_DISK_VOL_1&quot; ] &amp;&amp; [ ! &quot;$IS_MOUNTED_VOL_1&quot; ] ;then
			logger &quot;mounting time capsule volume 1 (${TIMECAPSULE_VOLUME_1})&quot;
			mount.cifs -v $TIMECAPSULE_PATH_VOL_1 $MOUNT_POINT_VOLUME_1 -o pass=$TIMECAPSULE_PASSWORD,file_mode=0777,dir_mode=0777
		fi

		if [ &quot;$CHECK_DISK_VOL_2&quot; ] &amp;&amp; [ ! &quot;$IS_MOUNTED_VOL_2&quot; ] ;then
			logger &quot;mounting time capsule volume 2 (${TIMECAPSULE_VOLUME_2})&quot;
			mount.cifs -v $TIMECAPSULE_PATH_VOL_2 $MOUNT_POINT_VOLUME_2 -o pass=$TIMECAPSULE_PASSWORD,file_mode=0777,dir_mode=0777
		fi
	# Automatisation pour d&#039;autres réseaux Wifi
	esac

elif [ &quot;${IF}&quot; = &quot;wlan0&quot; ] &amp;&amp; [ &quot;${STATUS}&quot; = &quot;down&quot; ]; then
	
	if [ &quot;$IS_MOUNTED_VOL_1&quot; ] ;then
		logger &quot;unmounting time capsule volume 1 (${TIMECAPSULE_VOLUME_1})&quot;
		umount -f $MOUNT_POINT_VOLUME_1
	fi
	
	if [ &quot;$IS_MOUNTED_VOL_2&quot; ] ;then
		logger &quot;unmounting time capsule volume 2 (${TIMECAPSULE_VOLUME_2})&quot;
		umount -f $MOUNT_POINT_VOLUME_2
	fi

fi

</pre>

<p>
Lorsque le réseau wifi est déconnecté, le démontage du (des) disque(s) est très lent (environ 5 minutes), je n&#039;en connais pas la raison.
N&#039;hésitez pas à apporter votre contribution.
</p>

<p>
<em>Contributeurs principaux : <a href="http://doc.ubuntu-fr.org/utilisateurs/electrobank" class="wikilink2" title="utilisateurs:electrobank" rel="nofollow">electrobank</a>
</p>

</div>
<div class='secedit editbutton_section editbutton_3'><form class="button btn_secedit" method="post" action="time_capsule"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="1416164026" /><input type="hidden" name="summary" value="[Automatisation] " /><input type="hidden" name="target" value="section" /><input type="hidden" name="range" value="1633-" /><input type="submit" value="Modifier" class="button" title="Automatisation" /></div></form></div><div class="footnotes">
<div class="fn"><sup><a href="time_capsule#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
<a href="https://bbs.archlinux.org/viewtopic.php?pid=931303" class="urlextern" title="https://bbs.archlinux.org/viewtopic.php?pid=931303"  rel="nofollow">Forum ArchLinux sur &quot;networkmanager dispatcher: adding NFS-shares?&quot; </a></div>
<div class="fn"><sup><a href="time_capsule#fnt__2" id="fn__2" class="fn_bot">2)</a></sup> 
<a href="http://blog.rom1v.com/2011/07/authentification-automatique-a-un-reseau-wifi-avec-networkmanager" class="urlextern" title="http://blog.rom1v.com/2011/07/authentification-automatique-a-un-reseau-wifi-avec-networkmanager"  rel="nofollow">Authentification automatique à un réseau Wifi avec Network Manager</a></div>
<div class="fn"><sup><a href="time_capsule#fnt__3" id="fn__3" class="fn_bot">3)</a></sup> 
<a href="http://task3.cc/418/how-to-automatically-mount-and-umount-apple-time-capsule-on-linux" class="urlextern" title="http://task3.cc/418/how-to-automatically-mount-and-umount-apple-time-capsule-on-linux"  rel="nofollow">Automatically mount and umount apple time capsule</a></div>
</div>

<!-- cachefile /srv/www/doc.ubuntu-fr.org/htdocs/data/cache/9/97fc908f9330a7f16a648caca57e9318.xhtml used -->

        <br style="clear:both;" />
        <div id="pageinfo">
            <!--  |  | -->
            <!-- ?tpl_pageinfo()? -->
            <br />
            Le contenu de ce wiki est sous licence : <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.fr" rel="license" target="_blank">CC BY-SA v3.0</a>
        </div> 
      </div>

      
      <div id="navigation">

        <ul>
          <li class="menu"><a href="http://www.ubuntu-fr.org" class="title" id="menu-accueil"><span>Accueil</span></a></li>
          <li class="menu" id="active">
            <a href="index.html"  class="title" id="menu-doc"><span>Documentation</span></a>
            <ul>
              <li id="navWiki" class="cat">
                <h2>Actions</h2>
                <ul>
                  <li><a href="http://doc.ubuntu-fr.org/time_capsule?do=index"  class="action index" accesskey="x" rel="nofollow" title="Plan du site [X]">Plan du site</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/time_capsule?do=edit&amp;rev=0"  class="action edit" accesskey="e" rel="nofollow" title="Modifier cette page [E]">Modifier cette page</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/time_capsule?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Anciennes révisions [O]">Anciennes révisions</a></li>
                  <li></li>
                  <li><a href="http://doc.ubuntu-fr.org/time_capsule?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Derniers changements [R]">Derniers changements</a></li>
                  <li><a href="http://doc.ubuntu-fr.org/time_capsule?do=backlink"  class="action backlink" rel="nofollow" title="Liens vers cette page">Liens vers cette page</a></li>
                  <li></li>
                  <li></li>
                  <li></li>
                </ul>
              </li>
              <li id="navDivers" class="cat">
                <h2>Divers</h2>
                <ul>
                  <li><bdi><a href="wiki/participer_wiki" class="wikilink1" title="wiki:participer_wiki">Participer à la documentation</a></bdi></li>
                  <li><bdi><a href="documentation_hors_ligne" class="wikilink1" title="documentation_hors_ligne">Documentation hors ligne</a></bdi></li>
                  <li><a href="http://www.ubuntu-fr.org/telechargement" title="T&eacute;l&eacute;charger Ubuntu">T&eacute;l&eacute;charger Ubuntu</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="menu"><a href="http://forum.ubuntu-fr.org"  class="title" id="menu-forum"><span>Forum</span></a></li>
          <li class="menu"><a href="http://planet.ubuntu-fr.org"  class="title" id="menu-planet"><span>Planet</span></a></li>
        </ul>

      </div>
      <div id="references-ufr">
        <ul id="legal-ufr">
          <li><a href="http://www.ubuntu-fr.org/contacts">Contact</a></li>
        </ul>

        <ul id="sponsors-ufr">
          <li><a href="http://www.dokuwiki.org/dokuwiki" id="dokuwiki">Propulsé par Dokuwiki</a></li>
        </ul>
      </div>

    </div>
    <!-- $Id$ -->

    <!-- Piwik Image Tracker -->
    <!-- img src="http://piwik.infra.ubuntu-fr.org/piwik.php?idsite=2&amp;rec=1" style="border:0" alt="" /-->
    <!-- End Piwik -->

  </body>
</html>
